!function(i,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("@angular/common"),require("@angular/core"),require("@angular/forms"),require("@angular/cdk/drag-drop"),require("@angular/material/autocomplete"),require("@angular/material/button"),require("@angular/material/card"),require("@angular/material/checkbox"),require("@angular/material/chips"),require("@angular/material/dialog"),require("@angular/material/form-field"),require("@angular/material/icon"),require("@angular/material/input"),require("@angular/material/list"),require("@angular/material/menu"),require("@angular/material/select"),require("@angular/material/sidenav"),require("@angular/material/slider"),require("@angular/material/table"),require("@angular/material/toolbar"),require("@angular/material/tooltip"),require("@ngx-translate/core"),require("@ajf/material/monaco-editor"),require("@ajf/material/node-icon"),require("rxjs/operators"),require("@ajf/core/forms"),require("tslib"),require("@angular/cdk/collections"),require("rxjs"),require("@ajf/core/models"),require("@ajf/core/utils"),require("@angular/cdk/keycodes")):"function"==typeof define&&define.amd?define("@ajf/material/form-builder",["exports","@angular/common","@angular/core","@angular/forms","@angular/cdk/drag-drop","@angular/material/autocomplete","@angular/material/button","@angular/material/card","@angular/material/checkbox","@angular/material/chips","@angular/material/dialog","@angular/material/form-field","@angular/material/icon","@angular/material/input","@angular/material/list","@angular/material/menu","@angular/material/select","@angular/material/sidenav","@angular/material/slider","@angular/material/table","@angular/material/toolbar","@angular/material/tooltip","@ngx-translate/core","@ajf/material/monaco-editor","@ajf/material/node-icon","rxjs/operators","@ajf/core/forms","tslib","@angular/cdk/collections","rxjs","@ajf/core/models","@ajf/core/utils","@angular/cdk/keycodes"],e):e(((i=i||self).ajf=i.ajf||{},i.ajf.material=i.ajf.material||{},i.ajf.material.formBuilder={}),i.ng.common,i.ng.core,i.ng.forms,i.ng.cdk.dragDrop,i.ng.material.autocomplete,i.ng.material.button,i.ng.material.card,i.ng.material.checkbox,i.ng.material.chips,i.ng.material.dialog,i.ng.material.formField,i.ng.material.icon,i.ng.material.input,i.ng.material.list,i.ng.material.menu,i.ng.material.select,i.ng.material.sidenav,i.ng.material.slider,i.ng.material.table,i.ng.material.toolbar,i.ng.material.tooltip,i.ngxTranslate.core,i.ng.material.monacoEditor,i.ng.material.nodeIcon,i.rxjs.operators,i.ng.core.forms,i.tslib,i.ng.cdk.collections,i.rxjs,i.ng.core.models,i.ng.core.utils,i.ng.cdk.keycodes)}(this,(function(i,e,t,n,o,r,a,s,l,d,c,u,p,f,m,h,g,b,_,v,y,C,S,j,E,D,F,x,O,w,N,T,V){"use strict";
/**
     * @license
     * Copyright (C) 2018 Gnucoop soc. coop.
     *
     * This file is part of the Advanced JSON forms (ajf).
     *
     * Advanced JSON forms (ajf) is free software: you can redistribute it and/or
     * modify it under the terms of the GNU Affero General Public License as
     * published by the Free Software Foundation, either version 3 of the License,
     * or (at your option) any later version.
     *
     * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,
     * but WITHOUT ANY WARRANTY; without even the implied warranty of
     * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero
     * General Public License for more details.
     *
     * You should have received a copy of the GNU Affero General Public License
     * along with Advanced JSON forms (ajf).
     * If not, see http://www.gnu.org/licenses/.
     *
     */var M=function(){function i(i,e){this._el=i,this._renderer=e,this._offset=0,this._height=0}return Object.defineProperty(i.prototype,"offset",{set:function(i){this._offset=i,this._updateOffset()},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"color",{set:function(i){this._color=i,this._updateColor()},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"height",{set:function(i){this._height=i,this._updateHeight()},enumerable:!0,configurable:!0}),i.prototype._updateHeight=function(){var i=Math.max(0,this._height-25)+"px";this._renderer.setStyle(this._el.nativeElement,"height",i)},i.prototype._updateOffset=function(){var i=4*this._offset+"px";this._renderer.setStyle(this._el.nativeElement,"margin-top",i),this._renderer.setStyle(this._el.nativeElement,"margin-left",i)},i.prototype._updateColor=function(){this._renderer.setStyle(this._el.nativeElement,"border-color",this._color)},i.decorators=[{type:t.Component,args:[{selector:"ajf-fb-branch-line",template:"",encapsulation:t.ViewEncapsulation.None,changeDetection:t.ChangeDetectionStrategy.OnPush,styles:["ajf-fb-branch-line{display:block;position:absolute;top:25px;left:25px;width:25px;border-top:2px solid;border-left:2px solid;border-top-left-radius:6px}\n"]}]}],i.ctorParameters=function(){return[{type:t.ElementRef},{type:t.Renderer2}]},i.propDecorators={offset:[{type:t.Input}],color:[{type:t.Input}],height:[{type:t.Input}]},i}(),P=function(i){function e(){var e=i.call(this)||this;return e._choices=new w.BehaviorSubject([]),e._choicesObs=e._choices.asObservable(),e}return x.__extends(e,i),e.prototype.connect=function(){return this._choicesObs},e.prototype.disconnect=function(){},e.prototype.updateChoices=function(i){this._choices.next(i)},e}(O.DataSource),I=function(){function i(){this._displayedColumns=["label","value","delete"],this.editing={},this._choices=new P,this._choicesArr=[]}return Object.defineProperty(i.prototype,"displayedColumns",{get:function(){return this._displayedColumns},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"choicesOrigin",{get:function(){return this._choicesOrigin},set:function(i){this._choicesOrigin=i,this.name=i.name,this.label=i.label,this.canEditChoices=F.isChoicesFixedOrigin(i),this._choicesArr=i.choices,this._choices.updateChoices(this._choicesArr)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"choices",{get:function(){return this._choices},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"choicesArr",{get:function(){return this._choicesArr},enumerable:!0,configurable:!0}),i.prototype.updateValue=function(i,e,t,n){this.editing[n+"-"+e]=!1,this._choicesArr[n][e]=i.target.value,this._choices.updateChoices(this._choicesArr)},i.prototype.deleteRow=function(i){this._choicesArr.splice(i,1),this._choices.updateChoices(this._choicesArr)},i.prototype.addRow=function(){this._choicesArr.push({label:"",value:""}),this._choices.updateChoices(this._choicesArr)},i.decorators=[{type:t.Component,args:[{selector:"ajf-fb-choices-origin-editor",template:'<div>\n  <mat-form-field>\n    <input matInput [(ngModel)]="name"\n        [placeholder]="\'Name\' | translate">\n  </mat-form-field>\n  <mat-form-field>\n    <input matInput [(ngModel)]="label"\n        [placeholder]="\'Label\' | translate">\n  </mat-form-field>\n  <ng-template [ngIf]="canEditChoices">\n    <button (click)="addRow()" mat-button>\n      <mat-icon>add</mat-icon>\n      <span translate>Add value</span>\n    </button>\n    <mat-table [dataSource]="choices">\n      <ng-container matColumnDef="label">\n        <mat-header-cell *matHeaderCellDef translate>Label</mat-header-cell>\n        <mat-cell *matCellDef="let row; let idx = index">\n          <input matInput [(ngModel)]="row.label" type="text">\n        </mat-cell>\n      </ng-container>\n      <ng-container matColumnDef="value">\n        <mat-header-cell *matHeaderCellDef translate>Value</mat-header-cell>\n        <mat-cell *matCellDef="let row; let idx = index">\n          <input matInput [(ngModel)]="row.value" type="text">\n        </mat-cell>\n      </ng-container>\n      <ng-container matColumnDef="delete">\n        <mat-header-cell *matHeaderCellDef translate>Delete</mat-header-cell>\n        <mat-cell *matCellDef="let row; let idx = index">\n            <mat-icon (click)="deleteRow(idx)">delete</mat-icon>\n        </mat-cell>\n      </ng-container>\n\n      <mat-header-row *matHeaderRowDef="displayedColumns"></mat-header-row>\n      <mat-row *matRowDef="let row; columns: displayedColumns;"></mat-row>\n    </mat-table>\n  </ng-template>\n</div>\n',encapsulation:t.ViewEncapsulation.None,changeDetection:t.ChangeDetectionStrategy.OnPush,styles:["ajf-fb-choices-origin-editor mat-form-field+mat-form-field{margin-left:1em}ajf-fb-choices-origin-editor mat-table{max-height:300px}ajf-fb-choices-origin-editor mat-table mat-icon{cursor:pointer}\n"]}]}],i.propDecorators={choicesOrigin:[{type:t.Input}]},i}();
/**
     * @license
     * Copyright (C) 2018 Gnucoop soc. coop.
     *
     * This file is part of the Advanced JSON forms (ajf).
     *
     * Advanced JSON forms (ajf) is free software: you can redistribute it and/or
     * modify it under the terms of the GNU Affero General Public License as
     * published by the Free Software Foundation, either version 3 of the License,
     * or (at your option) any later version.
     *
     * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,
     * but WITHOUT ANY WARRANTY; without even the implied warranty of
     * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero
     * General Public License for more details.
     *
     * You should have received a copy of the GNU Affero General Public License
     * along with Advanced JSON forms (ajf).
     * If not, see http://www.gnu.org/licenses/.
     *
     */
/**
     * @license
     * Copyright (C) 2018 Gnucoop soc. coop.
     *
     * This file is part of the Advanced JSON forms (ajf).
     *
     * Advanced JSON forms (ajf) is free software: you can redistribute it and/or
     * modify it under the terms of the GNU Affero General Public License as
     * published by the Free Software Foundation, either version 3 of the License,
     * or (at your option) any later version.
     *
     * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,
     * but WITHOUT ANY WARRANTY; without even the implied warranty of
     * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero
     * General Public License for more details.
     *
     * You should have received a copy of the GNU Affero General Public License
     * along with Advanced JSON forms (ajf).
     * If not, see http://www.gnu.org/licenses/.
     *
     */
function R(i,e){if(i.nodes.indexOf(e)>-1)return i;for(var t=i.nodes.filter((function(i){return F.isContainerNode(i)})),n=t.length,o=0;o<n;o++){var r=R(t[o],e);if(null!=r)return r}return null}function k(i,e,t){void 0===t&&(t=!1);var n=i.filter((function(i){return i.parent===e.id})).sort((function(i,e){return i.parentNode-e.parentNode})).map((function(e){var t=k(i,e);return 0===t.length&&t.push({parent:e,parentNode:0}),{node:e,children:t,content:A(0,e)}}));if(!t)for(var o=e.conditionalBranches.length,r=n.length;r<o;r++)n.push({parent:e,parentNode:r});return n}function A(i,e){return F.isContainerNode(e)?k(e.nodes,e,!0):[]}function B(i){var e=[];return i.forEach((function(i){F.isContainerNode(i)&&(e=e.concat(B(i.nodes))),e.push(i)})),e}function L(i,e,t){return void 0===t&&(t=null),i.filter(null!=t?function(i){return i.parent===e.id&&i.parentNode===t}:function(i){return i.parent===e.id})}function W(i,e,t){void 0===t&&(t=null);for(var n=B(i),o=[],r=L(n,e,t),a=r.length,s=0;s<a;s++)o=o.concat(L(n,r[s]));return function i(e,t){for(var n=e.length,o=0;o<n;o++){var r=e[o];F.isContainerNode(r)&&(r.nodes=i(r.nodes,t))}return e.filter((function(i){return-1===t.indexOf(i.id)}))}(i,(o=o.concat(r)).map((function(i){return i.id})))}var Y=0,U=function(){function i(){this._availableNodeTypes=[{label:"Slide",icon:{fontSet:"ajf-icon",fontIcon:"field-slide"},nodeType:{node:F.AjfNodeType.AjfSlide},isSlide:!0},{label:"Repeating slide",icon:{fontSet:"ajf-icon",fontIcon:"field-repeatingslide"},nodeType:{node:F.AjfNodeType.AjfRepeatingSlide},isSlide:!0},{label:"String",icon:{fontSet:"ajf-icon",fontIcon:"field-string"},nodeType:{node:F.AjfNodeType.AjfField,field:F.AjfFieldType.String}},{label:"Text",icon:{fontSet:"ajf-icon",fontIcon:"field-text"},nodeType:{node:F.AjfNodeType.AjfField,field:F.AjfFieldType.Text}},{label:"Number",icon:{fontSet:"ajf-icon",fontIcon:"field-number"},nodeType:{node:F.AjfNodeType.AjfField,field:F.AjfFieldType.Number}},{label:"Boolean",icon:{fontSet:"ajf-icon",fontIcon:"field-boolean"},nodeType:{node:F.AjfNodeType.AjfField,field:F.AjfFieldType.Boolean}},{label:"Single choice",icon:{fontSet:"ajf-icon",fontIcon:"field-singlechoice"},nodeType:{node:F.AjfNodeType.AjfField,field:F.AjfFieldType.SingleChoice}},{label:"Multiple choice",icon:{fontSet:"ajf-icon",fontIcon:"field-multiplechoice"},nodeType:{node:F.AjfNodeType.AjfField,field:F.AjfFieldType.MultipleChoice}},{label:"Formula",icon:{fontSet:"ajf-icon",fontIcon:"field-formula"},nodeType:{node:F.AjfNodeType.AjfField,field:F.AjfFieldType.Formula}},{label:"Date",icon:{fontSet:"ajf-icon",fontIcon:"field-date"},nodeType:{node:F.AjfNodeType.AjfField,field:F.AjfFieldType.Date}},{label:"Date input",icon:{fontSet:"ajf-icon",fontIcon:"field-dateinput"},nodeType:{node:F.AjfNodeType.AjfField,field:F.AjfFieldType.DateInput}},{label:"Time",icon:{fontSet:"ajf-icon",fontIcon:"field-time"},nodeType:{node:F.AjfNodeType.AjfField,field:F.AjfFieldType.Time}},{label:"Table",icon:{fontSet:"ajf-icon",fontIcon:"field-table"},nodeType:{node:F.AjfNodeType.AjfField,field:F.AjfFieldType.Table}}],this._form=new w.BehaviorSubject(null),this._formObs=this._form.asObservable(),this._editedNodeEntry=new w.BehaviorSubject(null),this._editedNodeEntryObs=this._editedNodeEntry.asObservable(),this._editedCondition=new w.BehaviorSubject(null),this._editedConditionObs=this._editedCondition.asObservable(),this._editedChoicesOrigin=new w.BehaviorSubject(null),this._editedChoicesOriginObs=this._editedChoicesOrigin.asObservable(),this._beforeNodesUpdate=new t.EventEmitter,this._beforeNodesUpdateObs=this._beforeNodesUpdate.asObservable(),this._afterNodeUpdate=new t.EventEmitter,this._afterNodeUpdateObs=this._afterNodeUpdate.asObservable(),this._nodesUpdates=new w.Subject,this._attachmentsOriginsUpdates=new w.Subject,this._choicesOriginsUpdates=new w.Subject,this._stringIdentifierUpdates=new w.Subject,this._saveNodeEntryEvent=new t.EventEmitter,this._deleteNodeEntryEvent=new t.EventEmitter,this._initChoicesOriginsStreams(),this._initAttachmentsOriginsStreams(),this._initStringIdentifierStreams(),this._initNodesStreams(),this._initFormStreams(),this._initSaveNode(),this._initDeleteNode()}return Object.defineProperty(i.prototype,"availableNodeTypes",{get:function(){return this._availableNodeTypes},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"form",{get:function(){return this._formObs},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"attachmentsOrigins",{get:function(){return this._attachmentsOrigins},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"choicesOrigins",{get:function(){return this._choicesOrigins},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"stringIdentifier",{get:function(){return this._stringIdentifier},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"nodes",{get:function(){return this._nodes},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"flatNodes",{get:function(){return this._flatNodes},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"flatFields",{get:function(){return this._flatFields},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"nodeEntriesTree",{get:function(){return this._nodeEntriesTree},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"editedNodeEntry",{get:function(){return this._editedNodeEntryObs},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"editedCondition",{get:function(){return this._editedConditionObs},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"editedChoicesOrigin",{get:function(){return this._editedChoicesOriginObs},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"beforeNodesUpdate",{get:function(){return this._beforeNodesUpdateObs},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"afterNodeUpdate",{get:function(){return this._afterNodeUpdateObs},enumerable:!0,configurable:!0}),i.prototype.setForm=function(i){i!==this._form.getValue()&&this._form.next(i)},i.prototype.editNodeEntry=function(i){this._editedNodeEntry.next(i)},i.prototype.editCondition=function(i){this._editedCondition.next(i)},i.prototype.saveCurrentCondition=function(i){var e=this._editedCondition.getValue();null!=e&&(e.condition=i,this._editedCondition.next(null))},i.prototype.cancelConditionEdit=function(){this._editedChoicesOrigin.next(null)},i.prototype.insertNode=function(i,e,t,n){var o;void 0===n&&(n=!1);var r=++Y,a=null!=i.nodeType.field;o=a?F.createField({id:r,nodeType:F.AjfNodeType.AjfField,fieldType:i.nodeType.field,parent:e.id,parentNode:t,name:""}):F.createContainerNode({id:r,nodeType:i.nodeType.node,parent:null!=e?e.id:0,parentNode:t,name:"",nodes:[]}),this._beforeNodesUpdate.emit(),this._nodesUpdates.next((function(i){if(0===o.parent)return[o];var t=F.isContainerNode(e)&&n?e:R({nodes:i},e);if(null!=t)if(a)t.nodes.push(o);else{var r=t.nodes===i,s=t.nodes.slice(0);s.push(o),t.nodes=s,r&&(i=s)}return i}))},i.prototype.saveNodeEntry=function(i){this._saveNodeEntryEvent.emit(i)},i.prototype.cancelNodeEntryEdit=function(){this._editedNodeEntry.next(null)},i.prototype.deleteNodeEntry=function(i){this._deleteNodeEntryEvent.next(i)},i.prototype.getCurrentForm=function(){return w.combineLatest([this.form,this.nodes,this.attachmentsOrigins,this.choicesOrigins,this.stringIdentifier]).pipe(D.filter((function(i){return null!=x.__read(i,1)[0]})),D.map((function(i){var e=x.__read(i,5),t=e[0],n=e[1],o=e[2],r=e[4];return F.createForm({choicesOrigins:e[3].slice(0),attachmentsOrigins:o.slice(0),stringIdentifier:(r||[]).slice(0),nodes:n.slice(0),supplementaryInformations:t.supplementaryInformations})})))},i.prototype.editChoicesOrigin=function(i){this._editedChoicesOrigin.next(i)},i.prototype.createChoicesOrigin=function(){this._editedChoicesOrigin.next(F.createChoicesFixedOrigin({name:""}))},i.prototype.cancelChoicesOriginEdit=function(){this._editedChoicesOrigin.next(null)},i.prototype.saveChoicesOrigin=function(i){var e=this._editedChoicesOrigin.getValue();null!=e&&(e.label=i.label,e.name=i.name,F.isChoicesFixedOrigin(e)&&(e.choices=i.choices),this._choicesOriginsUpdates.next((function(i){var t=i.indexOf(e);return t>-1?x.__spread(i.slice(0,t),[e],i.slice(t+1)):x.__spread(i,[e])}))),this._editedChoicesOrigin.next(null)},i.prototype.saveStringIdentifier=function(i){this._stringIdentifierUpdates.next((function(){return x.__spread(i)}))},i.prototype._findMaxNodeId=function(i,e){var t=this;void 0===e&&(e=0);var n=0;return i.forEach((function(i){n=Math.max(n,i.id),F.isContainerNode(i)&&(n=Math.max(n,t._findMaxNodeId(i.nodes)))})),n},i.prototype._initFormStreams=function(){var i=this;this._form.subscribe((function(e){Y=0,null!=e&&null!=e.nodes&&e.nodes.length>0&&(Y=i._findMaxNodeId(e.nodes)),i._nodesUpdates.next((function(i){return null!=e&&null!=e.nodes?e.nodes.slice(0):[]})),i._attachmentsOriginsUpdates.next((function(i){return null!=e&&null!=e.attachmentsOrigins?e.attachmentsOrigins.slice(0):[]})),i._choicesOriginsUpdates.next((function(i){return null!=e&&null!=e.choicesOrigins?e.choicesOrigins.slice(0):[]})),i._stringIdentifierUpdates.next((function(i){return null!=e&&null!=e.stringIdentifier?e.stringIdentifier.slice(0):[]}))}))},i.prototype._initChoicesOriginsStreams=function(){this._choicesOrigins=this._choicesOriginsUpdates.pipe(D.scan((function(i,e){return e(i)}),[]),D.publishReplay(1),D.refCount())},i.prototype._initAttachmentsOriginsStreams=function(){this._attachmentsOrigins=this._attachmentsOriginsUpdates.pipe(D.scan((function(i,e){return e(i)}),[]),D.publishReplay(1),D.refCount())},i.prototype._initStringIdentifierStreams=function(){this._stringIdentifier=this._stringIdentifierUpdates.pipe(D.scan((function(i,e){return e(i)}),[]),D.publishReplay(1),D.refCount())},i.prototype._initNodesStreams=function(){this._nodes=this._nodesUpdates.pipe(D.scan((function(i,e){return e(i)}),[]),D.publishReplay(1),D.refCount()),this._flatNodes=this._nodes.pipe(D.map((function(i){return B(i)})),D.publishReplay(1),D.refCount()),this._flatFields=this._flatNodes.pipe(D.map((function(i){return i.filter((function(i){return!F.isContainerNode(i)}))})),D.publishReplay(1),D.refCount()),this._nodeEntriesTree=this._nodes.pipe(D.map((function(i){return function e(i){var e=i.filter((function(i){return null==i.parent||0===i.parent}));if(1===e.length){var t=e[0];if(F.isSlidesNode(t)){var n=[];return n.push({node:t,container:null,children:k(i,t),content:A(0,t)}),n}}else if(0===e.length)return[null];throw new Error("Invalid form definition")}(i)})),D.publishReplay(1),D.refCount())},i.prototype._initSaveNode=function(){var i=this;this._saveNodeEntryEvent.pipe(D.withLatestFrom(this.editedNodeEntry,this.choicesOrigins,this.attachmentsOrigins),D.filter((function(i){return null!=x.__read(i,2)[1]})),D.map((function(e){var t=x.__read(e,2),n=t[0],o=t[1];i._beforeNodesUpdate.emit();var r=(o=o).node,a=T.deepCopy(r);a.id=o.node.id,a.name=n.name,a.label=n.label,a.visibility=null!=n.visibility?N.createCondition({condition:n.visibility}):null;var s=a.conditionalBranches.length;a.conditionalBranches=null!=n.conditionalBranches?n.conditionalBranches.map((function(i){return N.createCondition({condition:i})})):[N.alwaysCondition()];var l=a.conditionalBranches.length;if(F.isRepeatingContainerNode(a)){var d=a;d.formulaReps=null!=n.formulaReps?N.createFormula({formula:n.formulaReps}):void 0,d.minReps=n.minReps,d.maxReps=n.maxReps}if(F.isField(a)){var c=a;c.description=n.description,c.defaultValue=n.defaultValue,c.formula=null!=n.formula?N.createFormula({formula:n.formula}):void 0;var u=n.value,p=n.notEmpty,f=n.validationConditions,m=parseInt(n.minValue,10),h=parseInt(n.maxValue,10),g=parseInt(n.minDigits,10),b=parseInt(n.maxDigits,10);if(isNaN(m)&&(m=null),isNaN(h)&&(h=null),isNaN(g)&&(g=null),isNaN(b)&&(b=null),null!=u||null!=p||null!=f&&f.length>0||null!=m||null!=h||null!=g||null!=b){var _=c.validation||F.createValidationGroup({});_.forceValue=u,_.notEmpty=p?F.notEmptyValidation():void 0,_.minValue=null!=m?F.minValidation(m):void 0,_.maxValue=null!=h?F.maxValidation(h):void 0,_.minDigits=null!=g?F.minDigitsValidation(g):void 0,_.maxDigits=null!=b?F.maxDigitsValidation(b):void 0,_.conditions=(f||[]).map((function(i){return F.createValidation({condition:i.condition,errorMessage:i.errorMessage})})),c.validation=_}else c.validation=void 0;var v=n.notEmptyWarning,y=n.warningConditions;if(null!=v||null!=y&&y.length>0){var C=c.warning||F.createWarningGroup({});C.notEmpty=v?F.notEmptyWarning():void 0,C.conditions=(y||[]).map((function(i){return F.createWarning({condition:i.condition,warningMessage:i.warningMessage})})),c.warning=C}else c.warning=void 0;if(c.nextSlideCondition=null!=n.nextSlideCondition?N.createCondition({condition:n.nextSlideCondition}):void 0,c.size=n.size,c.defaultValue=n.defaultValue,F.isFieldWithChoices(c)){var S=c;S.choicesOriginRef=n.choicesOriginRef,S.forceExpanded=n.forceExpanded,S.forceNarrow=n.forceNarrow,S.triggerConditions=(n.triggerConditions||[]).map((function(i){return N.createCondition({condition:i})}))}}return i._editedNodeEntry.next(null),function(i){var e=R({nodes:i},r);if(null!=e){var t=e.nodes===i,n=e.nodes.indexOf(r),o=e.nodes.slice(0,n);if(o.push(a),o=o.concat(e.nodes.slice(n+1)),e.nodes=o,i=t?o:i.slice(0),l<s)for(var d=l;d<s;d++)i=W(i,a,d)}return i}}))).subscribe(this._nodesUpdates)},i.prototype._initDeleteNode=function(){var i=this;this._deleteNodeEntryEvent.pipe(D.map((function(e){return i._beforeNodesUpdate.emit(),function(i){var t=e.node,n=R({nodes:i},t);if(null!=n){var o=n.nodes===i,r=n.nodes.indexOf(t),a=n.nodes.slice(0,r);a=a.concat(n.nodes.slice(r+1)),n.nodes=a,i=W(i=o?a:i.slice(0),t)}return i}}))).subscribe(this._nodesUpdates)},i.decorators=[{type:t.Injectable}],i.ctorParameters=function(){return[]},i}(),q=function(){function i(i){this._service=i,this._choicesOrigin=this._service.editedChoicesOrigin.pipe(D.filter((function(i){return null!=i})),D.map((function(i){return i})))}return Object.defineProperty(i.prototype,"choicesOrigin",{get:function(){return this._choicesOrigin},enumerable:!0,configurable:!0}),i.prototype.saveChoicesOrigin=function(){this._service.saveChoicesOrigin({label:this.editor.label,name:this.editor.name,choices:this.editor.choicesArr})},i.prototype.cancelChoicesOriginEdit=function(){this._service.cancelChoicesOriginEdit()},i.decorators=[{type:t.Component,args:[{selector:"ajf-fb-choices-origin-editor-dialog",template:'<h3 matDialogTitle translate>Edit choices origin</h3>\n<mat-dialog-content>\n  <ajf-fb-choices-origin-editor\n      *ngIf="choicesOrigin|async as co"\n      [choicesOrigin]="co!"></ajf-fb-choices-origin-editor>\n</mat-dialog-content>\n<mat-dialog-actions>\n  <button mat-button translate (click)="saveChoicesOrigin()">Save</button>\n  <button mat-button translate (click)="cancelChoicesOriginEdit()">Close</button>\n</mat-dialog-actions>\n',encapsulation:t.ViewEncapsulation.None,changeDetection:t.ChangeDetectionStrategy.OnPush,styles:["\n"]}]}],i.ctorParameters=function(){return[{type:U}]},i.propDecorators={editor:[{type:t.ViewChild,args:[I,{static:!1}]}]},i}(),z=function(){function i(i){}return Object.defineProperty(i.prototype,"fields",{get:function(){return this._fields},set:function(i){this._fields=i,this._updateVariables()},enumerable:!0,configurable:!0}),i.prototype.insertVariable=function(i){if(null!=this.monacoEditor&&null!=this.monacoEditor.editor){var e=this.monacoEditor.editor,t=e.getValue().split("\n"),n=e.getPosition(),o=n.lineNumber-1,r=t[o],a=n.column-1;r=r.substring(0,a)+i+r.substring(a),t[o]=r,n.column+=i.length,this.monacoEditor.value=t.join("\n"),e.setPosition(n),e.focus(),this.editedValue=e.getValue()}},i.prototype.onEditorInit=function(){monaco.languages.typescript.javascriptDefaults.setDiagnosticsOptions({noSemanticValidation:!1,noSyntaxValidation:!1}),monaco.languages.typescript.javascriptDefaults.setCompilerOptions({target:monaco.languages.typescript.ScriptTarget.ES2015,allowNonTsExtensions:!0,allowJs:!0,module:monaco.languages.typescript.ModuleKind.None});try{monaco.languages.typescript.javascriptDefaults.addExtraLib("","condition-editor-variables.d.ts")}catch(i){monaco.languages.typescript.javascriptDefaults._extraLibs["condition-editor-variables.d.ts"]=""}try{monaco.languages.typescript.javascriptDefaults.addExtraLib("","condition-editor-functions.d.ts")}catch(i){monaco.languages.typescript.javascriptDefaults._extraLibs["condition-editor-functions.d.ts"]=""}this._updateVariables(),this._updateFunctions()},i.prototype._updateVariables=function(){var i=this;if(null!=this._fields)try{monaco.languages.typescript.javascriptDefaults._extraLibs["condition-editor-variables.d.ts"]=this._fields.map((function(e){return"declare const "+e.name+": "+i._fieldVarType(e.fieldType)+";"})).join("\n")}catch(i){}},i.prototype._updateFunctions=function(){try{monaco.languages.typescript.javascriptDefaults._extraLibs["condition-editor-functions.d.ts"]=N.AjfExpressionUtils.UTIL_FUNCTIONS}catch(i){}},i.prototype._fieldVarType=function(i){switch(i){case F.AjfFieldType.Boolean:return"boolean";case F.AjfFieldType.Date:case F.AjfFieldType.DateInput:case F.AjfFieldType.Time:return"Date";case F.AjfFieldType.Empty:return"void";case F.AjfFieldType.Formula:return"number";case F.AjfFieldType.MultipleChoice:case F.AjfFieldType.SingleChoice:return"any";case F.AjfFieldType.Number:return"number";case F.AjfFieldType.Table:return"Array";case F.AjfFieldType.String:case F.AjfFieldType.Text:return"string"}return null},i.decorators=[{type:t.Component,args:[{selector:"ajf-condition-editor",template:'<div class="ajf-editor">\n  <ajf-monaco-editor\n      (init)="onEditorInit()"\n      (valueChange)="editedValue = $event"\n      [value]="condition" language="javascript"></ajf-monaco-editor>\n</div>\n<div class="ajf-editor-panel">\n  <ng-container *ngIf="fields as curFields">\n    <mat-nav-list dense *ngIf="curFields!.length > 0">\n      <a mat-list-item\n          (click)="insertVariable(field.name)"\n          [matTooltip]="field.label"\n          *ngFor="let field of curFields!">\n        <ajf-node-icon [node]="field"></ajf-node-icon>\n        {{ field.name }}\n      </a>\n    </mat-nav-list>\n  </ng-container>\n</div>\n',changeDetection:t.ChangeDetectionStrategy.OnPush,encapsulation:t.ViewEncapsulation.None,styles:["ajf-condition-editor{display:flex;flex-direction:row;align-items:stretch;max-height:512px}ajf-condition-editor .ajf-editor{flex:.75 0 auto;display:flex;flex-direction:row;align-items:stretch}ajf-condition-editor .ajf-editor monaco-editor{flex:1 0 auto;min-width:512px;min-height:256px}ajf-condition-editor .ajf-editor-panel{flex:.25 0 auto;overflow-y:auto}ajf-condition-editor ajf-monaco-editor{min-width:400px}\n"]}]}],i.ctorParameters=function(){return[{type:F.AjfValidationService}]},i.propDecorators={monacoEditor:[{type:t.ViewChild,args:[j.AjfMonacoEditor,{static:!0}]}],fields:[{type:t.Input}],condition:[{type:t.Input}]},i}(),H=function(){function i(i,e){this.dialogRef=e,this._fields=i.flatFields.pipe(D.map((function(i){return i.sort((function(i,e){return i.name.localeCompare(e.name)}))})))}return Object.defineProperty(i.prototype,"fields",{get:function(){return this._fields},enumerable:!0,configurable:!0}),i.prototype.saveCondition=function(){null!=this.editor&&this.dialogRef.close(this.editor.editedValue)},i.decorators=[{type:t.Component,args:[{selector:"ajf-condition-editor-dialog",template:'<h3 matDialogTitle translate>Edit condition</h3>\n<mat-dialog-content>\n  <ajf-condition-editor\n      *ngIf="fields|async as curFields"\n      [fields]="curFields!"\n      [condition]="condition"></ajf-condition-editor>\n</mat-dialog-content>\n<mat-dialog-actions>\n  <button mat-button translate (click)="saveCondition()">Save</button>\n  <button mat-button translate matDialogClose>Close</button>\n</mat-dialog-actions>\n',encapsulation:t.ViewEncapsulation.None,changeDetection:t.ChangeDetectionStrategy.OnPush,styles:["ajf-condition-editor-dialog mat-dialog-content{overflow:visible}\n"]}]}],i.ctorParameters=function(){return[{type:U},{type:c.MatDialogRef}]},i.propDecorators={editor:[{type:t.ViewChild,args:[z,{static:!1}]}]},i}(),$=function(){function i(i,e){var t=this;this._service=i,this._cdr=e,this.dataSource=new v.MatTableDataSource,this.displayedColumns=["label","value","delete"],this.separatorKeysCodes=[V.ENTER,V.COMMA],this._stringIdentifierSub=w.Subscription.EMPTY,this._stringIdentifierSub=i.stringIdentifier.subscribe((function(i){t.dataSource.data=x.__spread(i)})),this.fields$=i.flatFields.pipe(D.map((function(i){return i.sort((function(i,e){return i.name.localeCompare(e.name)})).map((function(i){return i.name})).filter((function(i){return i.length>0}))})),D.shareReplay(1))}return i.prototype.addRow=function(){this.dataSource.data=x.__spread(this.dataSource.data,[{label:"",value:[]}])},i.prototype.deleteRow=function(i){this.dataSource.data=x.__spread(this.dataSource.data.slice(0,i),this.dataSource.data.slice(i+1))},i.prototype.addValue=function(i,e,t){0!==e.value.length&&(i.value=x.__spread(i.value,[e.value]),t.value="",this._cdr.markForCheck())},i.prototype.removeValue=function(i,e){var t=i.value.indexOf(e);t>-1&&(i.value=x.__spread(i.value.slice(0,t),i.value.slice(t+1)),this._cdr.markForCheck())},i.prototype.ngOnDestroy=function(){this._stringIdentifierSub.unsubscribe()},i.prototype.saveStringIdentifier=function(){this._service.saveStringIdentifier(this.dataSource.data)},i.prototype.selected=function(i,e){i.value=x.__spread(i.value,[e.option.value]),this._cdr.markForCheck()},i.decorators=[{type:t.Component,args:[{selector:"ajf-fb-string-identifier-dialog",template:'<h3 matDialogTitle translate>Edit identifier</h3>\n<mat-dialog-content>\n  <button (click)="addRow()" mat-button>\n    <mat-icon>add</mat-icon>\n    <span translate>Add value</span>\n  </button>\n  <mat-table [dataSource]="dataSource">\n    <ng-container matColumnDef="label">\n      <mat-header-cell *matHeaderCellDef translate>Label</mat-header-cell>\n      <mat-cell *matCellDef="let row; let idx = index">\n        <mat-form-field>\n          <input matInput [placeholder]="\'Label\'|translate" autofocus [(ngModel)]="row.label">\n        </mat-form-field>\n      </mat-cell>\n    </ng-container>\n    <ng-container matColumnDef="value">\n      <mat-header-cell *matHeaderCellDef translate>Value</mat-header-cell>\n      <mat-cell *matCellDef="let row; let idx = index">\n        <mat-form-field>\n          <mat-chip-list #chipList>\n            <mat-chip\n                *ngFor="let field of row.value"\n                (removed)="removeValue(row, field)"\n            >\n              {{ field }}\n              <mat-icon matChipRemove>cancel</mat-icon>\n            </mat-chip>\n          </mat-chip-list>\n          <input\n              #valueInput\n              [ngModel]="row.value"\n              [matAutocomplete]="valueAc"\n              [matChipInputFor]="chipList"\n              [matChipInputSeparatorKeyCodes]="separatorKeysCodes"\n              [matChipInputAddOnBlur]="true"\n              (matChipInputTokenEnd)="addValue(row, $event, valueInput)"\n              [placeholder]="\'Value\'|translate">\n          <mat-autocomplete #valueAc="matAutocomplete"\n              (optionSelected)="selected(row, $event)">\n            <mat-option *ngFor="let field of fields$ | async" [value]="field">{{field}}</mat-option>\n          </mat-autocomplete>\n        </mat-form-field>\n      </mat-cell>\n    </ng-container>\n    <ng-container matColumnDef="delete">\n      <mat-header-cell *matHeaderCellDef translate>Delete</mat-header-cell>\n      <mat-cell *matCellDef="let row; let idx = index">\n          <mat-icon (click)="deleteRow(idx)">delete</mat-icon>\n      </mat-cell>\n    </ng-container>\n\n    <mat-header-row *matHeaderRowDef="displayedColumns"></mat-header-row>\n    <mat-row *matRowDef="let row; columns: displayedColumns;"></mat-row>\n  </mat-table>\n</mat-dialog-content>\n<mat-dialog-actions>\n  <button mat-button translate matDialogClose (click)="saveStringIdentifier()">Save</button>\n</mat-dialog-actions>\n',changeDetection:t.ChangeDetectionStrategy.OnPush,encapsulation:t.ViewEncapsulation.None,styles:["\n"]}]}],i.ctorParameters=function(){return[{type:U},{type:t.ChangeDetectorRef}]},i}(),J=function(){function i(i,e){var n=this;this._service=i,this._dialog=e,this._vc=new t.EventEmitter,this._init=!1,this._editConditionSub=w.Subscription.EMPTY,this._beforeNodesUpdateSub=w.Subscription.EMPTY,this._editChoicesOriginSub=w.Subscription.EMPTY,this._stringIdentifierSub=w.Subscription.EMPTY,this._nodeTypes=i.availableNodeTypes,this._nodeEntriesTree=i.nodeEntriesTree,this._choicesOrigins=i.choicesOrigins,this._editConditionSub=this._service.editedCondition.subscribe((function(i){null!=n._editConditionDialog&&(n._editConditionDialog.close(),n._editConditionDialog=null),null!=i&&(n._editConditionDialog=n._dialog.open(H,{disableClose:!0}))})),this._editChoicesOriginSub=this._service.editedChoicesOrigin.subscribe((function(i){null!=n._editChoicesOriginDialog&&(n._editChoicesOriginDialog.close(),n._editChoicesOriginDialog=null),null!=i&&(n._editChoicesOriginDialog=n._dialog.open(q,{disableClose:!0}))})),this._beforeNodesUpdateSub=this._service.beforeNodesUpdate.subscribe((function(){null!=n.designerCont&&(n._lastScrollTop=n.designerCont.nativeElement.scrollTop)})),this.nodeEntriesTree.pipe(D.sample(this._vc)).subscribe((function(){null!=n.designerCont&&(n.designerCont.nativeElement.scrollTop=n._lastScrollTop)})),this._stringIdentifierSub=this._service.stringIdentifier.subscribe((function(){}))}return Object.defineProperty(i.prototype,"form",{get:function(){return this._form},set:function(i){this._form!==i&&(this._form=i,this._init&&this._setCurrentForm())},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"nodeTypes",{get:function(){return this._nodeTypes},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"nodeEntriesTree",{get:function(){return this._nodeEntriesTree},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"choicesOrigins",{get:function(){return this._choicesOrigins},enumerable:!0,configurable:!0}),i.prototype.ngAfterViewChecked=function(){this._vc.emit()},i.prototype.ngAfterContentInit=function(){this._setCurrentForm(),this._init=!0},i.prototype.ngOnDestroy=function(){this._editConditionSub.unsubscribe(),this._beforeNodesUpdateSub.unsubscribe(),this._editChoicesOriginSub.unsubscribe(),this._stringIdentifierSub.unsubscribe(),this._service.setForm(null)},i.prototype.createChoicesOrigin=function(){this._service.createChoicesOrigin()},i.prototype.disableDropPredicate=function(){return!1},i.prototype.editChoicesOrigin=function(i){this._service.editChoicesOrigin(i)},i.prototype.editStringIdentifier=function(){null!=this._stringIdentifierDialog&&(this._stringIdentifierDialog.close(),this._stringIdentifierDialog=null),this._stringIdentifierDialog=this._dialog.open($,{disableClose:!0,width:"60%",height:"60%"})},i.prototype._setCurrentForm=function(){this._service.setForm(this._form)},i.decorators=[{type:t.Component,args:[{selector:"ajf-form-builder",template:'<mat-toolbar>\n  <button mat-icon-button (click)="leftSidenav.toggle()">\n    <mat-icon>add_box</mat-icon>\n  </button>\n  <button mat-button [matMenuTriggerFor]="choicesMenu" translate>Choices</button>\n  <button mat-button (click)="editStringIdentifier()" translate>Identifier</button>\n  <mat-menu #choicesMenu>\n    <button (click)="createChoicesOrigin()" mat-menu-item translate>New..</button>\n    <ng-container *ngIf="choicesOrigins|async as cos">\n      <button *ngFor="let choicesOrigin of cos"\n          (click)="editChoicesOrigin(choicesOrigin)" mat-menu-item>\n        {{ choicesOrigin.label || choicesOrigin.name }}\n      </button>\n    </ng-container>\n  </mat-menu>\n  <span class="ajf-spacer"></span>\n  <button mat-icon-button (click)="rightSidenav.toggle()">\n    <mat-icon>settings</mat-icon>\n  </button>\n</mat-toolbar>\n<mat-drawer-container cdkDropListGroup>\n  <mat-drawer #leftSidenav position="start" mode="over">\n    <div #sourceDropList cdkDropList\n        [cdkDropListEnterPredicate]="disableDropPredicate"\n        [cdkDropListData]="nodeTypes">\n      <ajf-fb-node-type-entry *ngFor="let nodeType of nodeTypes"\n          cdkDrag\n          [cdkDragData]="nodeType"\n          (cdkDragStarted)="leftSidenav.close()"\n          [nodeType]="nodeType"></ajf-fb-node-type-entry>\n    </div>\n  </mat-drawer>\n  <mat-drawer #rightSidenav position="end" mode="side" [opened]="true">\n    <ajf-fb-node-properties></ajf-fb-node-properties>\n  </mat-drawer>\n  <div #designer class="ajf-designer">\n    <ajf-fb-node-entry\n        *ngFor="let nodeEntry of (nodeEntriesTree|async); let isFirst = first"\n        [isFirst]="isFirst"\n        [nodeEntry]="nodeEntry"></ajf-fb-node-entry>\n  </div>\n</mat-drawer-container>\n',changeDetection:t.ChangeDetectionStrategy.OnPush,encapsulation:t.ViewEncapsulation.None,styles:["ajf-form-builder{display:flex;position:relative;min-height:300px;flex-direction:column;align-items:stretch}ajf-form-builder mat-toolbar mat-menu div[mat-menu-item]>button[mat-button]{flex:1 0 auto}ajf-form-builder mat-toolbar mat-menu div[mat-menu-item]>button[mat-icon-button]{flex:0 0 auto}ajf-form-builder mat-drawer-container{flex:1}ajf-form-builder mat-drawer-container mat-drawer{max-width:20%}ajf-form-builder mat-drawer-container .ajf-designer{padding:1em}ajf-form-builder mat-toolbar .ajf-spacer{flex:1 1 auto}\n"]}]}],i.ctorParameters=function(){return[{type:U},{type:c.MatDialog}]},i.propDecorators={designerCont:[{type:t.ViewChild,args:["designer",{static:!0}]}],form:[{type:t.Input}]},i}(),Z=["#F44336","#4CAF50","#3F51B5","#FFC107","#795548"],G=function(){function i(i){this._service=i,this._hasContent=!1,this._isFirst=!1,this._isNodeEntry=!1,this._level=0,this._branchColors=Z.slice(0),this._dropZones=["fbdz-node"],this._slideDropZones=["fbdz-slide"],this._originOffset=0,this._originLeftMargin="0",this._firstBranchColor=Z[0],this._branchLinesSubscription=w.Subscription.EMPTY,this._childEntriesSubscription=w.Subscription.EMPTY,this._currentEditedNode=this._service.editedNodeEntry}return Object.defineProperty(i.prototype,"hasContent",{get:function(){return this._hasContent},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"isFirst",{get:function(){return this._isFirst},set:function(i){this._isFirst=i},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"isNodeEntry",{get:function(){return this._isNodeEntry},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"nodeEntry",{get:function(){return this._nodeEntry},set:function(i){if(this._nodeEntry=i,null!=i&&void 0!==i.node){var e=i;this._isNodeEntry=!0;var t=e.node;this._hasContent=null!=t&&F.isContainerNode(t)}else this._isNodeEntry=!1,this._hasContent=!1},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"level",{get:function(){return this._level},set:function(i){this._level=i},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"realNodeEntry",{get:function(){return this._nodeEntry},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"branchColors",{get:function(){return this._branchColors},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"dropZones",{get:function(){return this._dropZones},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"slideDropZones",{get:function(){return this._slideDropZones},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"originOffset",{get:function(){return this._originOffset},set:function(i){this._originOffset=i,this._originLeftMargin=4*this._originOffset+"px"},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"originLeftMargin",{get:function(){return this._originLeftMargin},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"firstBranchColor",{get:function(){return this._firstBranchColor},set:function(i){var e=Z.indexOf(i);e>0?(this._firstBranchColor=i,this._branchColors=Z.slice(e).concat(Z.slice(0,e))):(this._firstBranchColor=Z[0],this._branchColors=Z.slice(0))},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"currentEditedNode",{get:function(){return this._currentEditedNode},enumerable:!0,configurable:!0}),i.prototype.onResize=function(){},i.prototype.edit=function(){null!=this.nodeEntry&&this.isNodeEntry&&this._service.editNodeEntry(this.nodeEntry)},i.prototype.delete=function(){null!=this.nodeEntry&&this.isNodeEntry&&this._service.deleteNodeEntry(this.nodeEntry)},i.prototype.ngAfterViewInit=function(){var i=this;setTimeout((function(){return i._updateBranchHeights()})),this._childEntriesSubscription=this.childEntries.changes.subscribe((function(){i._updateBranchHeights()}))},i.prototype.ngOnDestroy=function(){this._branchLinesSubscription.unsubscribe(),this._childEntriesSubscription.unsubscribe()},i.prototype.onDropSuccess=function(i,e){void 0===e&&(e=!1);var t=i.item.data;if(null!=this._nodeEntry){if(void 0!==t.nodeType&&(!this.isNodeEntry||this.isNodeEntry&&e)){var n=e?{parent:this.nodeEntry.node,parentNode:0}:this._nodeEntry;this._service.insertNode(t,n.parent,n.parentNode,e)}}else this._service.insertNode(t,null,0,e)},i.prototype.disableSlideDropPredicate=function(i){return!i.data.isSlide},i.prototype.emptyAreaDropPredicate=function(){var i=this;return function(e,t){return i._level>0?!e.data.isSlide:e.data.isSlide||!1}},i.prototype._updateBranchHeights=function(){if(null!=this.nodeEntry&&this.isNodeEntry&&null!=this.branchLines&&null!=this.childEntries){var i=this.nodeEntry,e=this.branchLines.toArray(),t=null!=i.content?i.content.length:0,n=this.childEntries.toArray().slice(t);e.length==n.length&&e.forEach((function(i,e){i.height=n[e].nativeElement.offsetTop}))}},i.decorators=[{type:t.Component,args:[{selector:"ajf-fb-node-entry",template:'<ng-container *ngIf="nodeEntry != null ; else rootEmpty">\n  <ng-template [ngIf]="isNodeEntry">\n    <ajf-fb-branch-line\n        *ngFor="let childNodeEntry of realNodeEntry.children; let idx = index"\n        [offset]="idx"\n        [color]="branchColors[idx]"></ajf-fb-branch-line>\n  </ng-template>\n  <div class="mat-card-container"\n      [class.ajf-highlight]="(currentEditedNode|async) == nodeEntry">\n    <div *ngIf="!isFirst"\n        class="ajf-origin-line"\n        [style.margin-left]="originLeftMargin"\n        [style.border-color]="firstBranchColor"></div>\n    <ng-template [ngIf]="isNodeEntry">\n      <mat-card>\n        <div class="ajf-title-row">\n          <ajf-node-icon [node]="realNodeEntry.node"></ajf-node-icon>\n          <span class="ajf-title" [innerHTML]="(realNodeEntry.node.label || realNodeEntry.node.name)  | translate"></span>\n          <span class="ajf-actions">\n            <button [disabled]="(currentEditedNode|async) == nodeEntry" (click)="edit()" mat-icon-button>\n              <mat-icon>edit</mat-icon>\n            </button>\n            <button [disabled]="(currentEditedNode|async) == null" (click)="delete()" mat-icon-button>\n              <mat-icon>delete</mat-icon>\n            </button>\n          </span>\n        </div>\n        <div *ngIf="hasContent">\n          <ajf-fb-node-entry\n              *ngFor="let contentEntry of realNodeEntry.content; let isFirstChild = first; let idx = index"\n              [level]="level + 1"\n              [isFirst]="isFirstChild"\n              [firstBranchColor]="branchColors[idx]"\n              [nodeEntry]="contentEntry"></ajf-fb-node-entry>\n          <mat-card class="ajf-empty"\n              *ngIf="realNodeEntry.content.length === 0"\n              cdkDropList\n              [cdkDropListEnterPredicate]="disableSlideDropPredicate"\n              (cdkDropListDropped)="onDropSuccess($event, true)">&nbsp;</mat-card>\n        </div>\n      </mat-card>\n    </ng-template>\n    <ng-template [ngIf]="!isNodeEntry">\n      <mat-card class="ajf-empty"\n          cdkDropList\n          [cdkDropListEnterPredicate]="emptyAreaDropPredicate()"\n          (cdkDropListDropped)="onDropSuccess($event)">&nbsp;</mat-card>\n    </ng-template>\n  </div>\n  <ng-template [ngIf]="isNodeEntry">\n    <ajf-fb-node-entry\n        *ngFor="let childNodeEntry of realNodeEntry.children; let idx = index"\n        [level]="level"\n        [originOffset]="idx"\n        [firstBranchColor]="branchColors[idx]"\n        [nodeEntry]="childNodeEntry"></ajf-fb-node-entry>\n  </ng-template>\n</ng-container>\n<ng-template #rootEmpty>\n  <div class="mat-card-container">\n    <mat-card class="ajf-empty"\n        cdkDropList\n        [cdkDropListEnterPredicate]="emptyAreaDropPredicate()"\n        (cdkDropListDropped)="onDropSuccess($event)">&nbsp;</mat-card>\n  </div>\n</ng-template>\n',host:{"(window.resize)":"onResize()"},encapsulation:t.ViewEncapsulation.None,changeDetection:t.ChangeDetectionStrategy.OnPush,styles:["ajf-fb-node-entry{display:block;position:relative}ajf-fb-node-entry .mat-card-container{position:relative}ajf-fb-node-entry .mat-card-container .ajf-origin-line{position:absolute;top:0;left:25px;width:25px;height:25px;border-bottom:2px solid;border-left:2px solid;border-bottom-left-radius:.5em}ajf-fb-node-entry .mat-card-container mat-card{margin-left:50px;padding:.5em 1em;margin-top:.2em;margin-bottom:.2em;background-color:#fff}ajf-fb-node-entry .mat-card-container mat-card .ajf-title-row{display:flex;flex-direction:row;align-items:center}ajf-fb-node-entry .mat-card-container mat-card .ajf-title-row>.ajf-title{flex:1 1 auto}ajf-fb-node-entry .mat-card-container mat-card .ajf-title-row>.ajf-actions{flex:0 0 auto;white-space:nowrap}ajf-fb-node-entry .mat-card-container mat-card.ajf-empty{line-height:36px;border:2px dashed;box-shadow:none;box-sizing:border-box}ajf-fb-node-entry .mat-card-container.ajf-highlight>mat-card{background-color:#fff9c4}\n"]}]}],i.ctorParameters=function(){return[{type:U}]},i.propDecorators={branchLines:[{type:t.ViewChildren,args:[M]}],childEntries:[{type:t.ViewChildren,args:[i,{read:t.ElementRef}]}],isFirst:[{type:t.Input}],nodeEntry:[{type:t.Input}],level:[{type:t.Input}],originOffset:[{type:t.Input}],firstBranchColor:[{type:t.Input}]},i}(),K=function(){function i(i,e){this.dialogRef=e,this._fields=i.flatFields.pipe(D.map((function(i){return i.sort((function(i,e){return i.name.localeCompare(e.name)}))})))}return Object.defineProperty(i.prototype,"fields",{get:function(){return this._fields},enumerable:!0,configurable:!0}),i.prototype.saveCondition=function(){null!=this.editor&&this.dialogRef.close({condition:this.editor.editedValue,errorMessage:this.errorMessage})},i.decorators=[{type:t.Component,args:[{selector:"ajf-fb-validation-condition-editor-dialog",template:'<h3 matDialogTitle translate>Edit condition</h3>\n<mat-dialog-content>\n  <mat-form-field>\n    <input matInput [(ngModel)]="errorMessage" [placeholder]="\'Error message\' | translate">\n  </mat-form-field>\n  <ajf-condition-editor\n      *ngIf="fields|async as curFields"\n      [fields]="curFields!"\n      [condition]="condition"></ajf-condition-editor>\n</mat-dialog-content>\n<mat-dialog-actions>\n  <button mat-button translate (click)="saveCondition()">Save</button>\n  <button mat-button translate matDialogClose>Close</button>\n</mat-dialog-actions>\n',encapsulation:t.ViewEncapsulation.None,changeDetection:t.ChangeDetectionStrategy.OnPush,styles:["ajf-fb-validation-condition-editor-dialog mat-dialog-content{overflow:visible}\n"]}]}],i.ctorParameters=function(){return[{type:U},{type:c.MatDialogRef}]},i.propDecorators={editor:[{type:t.ViewChild,args:[z,{static:!1}]}]},i}(),Q=function(){function i(i,e){this.dialogRef=e,this._fields=i.flatFields.pipe(D.map((function(i){return i.sort((function(i,e){return i.name.localeCompare(e.name)}))})))}return Object.defineProperty(i.prototype,"fields",{get:function(){return this._fields},enumerable:!0,configurable:!0}),i.prototype.saveCondition=function(){null!=this.editor&&this.dialogRef.close({condition:this.editor.editedValue,warningMessage:this.warningMessage})},i.decorators=[{type:t.Component,args:[{selector:"ajf-fb-warning-condition-editor-dialog",template:'<h3 matDialogTitle translate>Edit condition</h3>\n<mat-dialog-content>\n  <mat-form-field>\n    <input matInput [(ngModel)]="warningMessage"\n      [placeholder]="\'Warning message\' | translate">\n  </mat-form-field>\n  <ajf-condition-editor\n      *ngIf="fields|async as curFields"\n      [fields]="curFields!"\n      [condition]="condition"></ajf-condition-editor>\n</mat-dialog-content>\n<mat-dialog-actions>\n  <button mat-button translate (click)="saveCondition()">Save</button>\n  <button mat-button translate matDialogClose>Close</button>\n</mat-dialog-actions>\n',encapsulation:t.ViewEncapsulation.None,changeDetection:t.ChangeDetectionStrategy.OnPush,styles:["ajf-fb-warning-condition-editor-dialog mat-dialog-content{overflow:visible}\n"]}]}],i.ctorParameters=function(){return[{type:U},{type:c.MatDialogRef}]},i.propDecorators={editor:[{type:t.ViewChild,args:[z,{static:!1}]}]},i}();
/**
     * @license
     * Copyright (C) 2018 Gnucoop soc. coop.
     *
     * This file is part of the Advanced JSON forms (ajf).
     *
     * Advanced JSON forms (ajf) is free software: you can redistribute it and/or
     * modify it under the terms of the GNU Affero General Public License as
     * published by the Free Software Foundation, either version 3 of the License,
     * or (at your option) any later version.
     *
     * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,
     * but WITHOUT ANY WARRANTY; without even the implied warranty of
     * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero
     * General Public License for more details.
     *
     * You should have received a copy of the GNU Affero General Public License
     * along with Advanced JSON forms (ajf).
     * If not, see http://www.gnu.org/licenses/.
     *
     */
function X(i){var e=i.value.minReps,t=i.value.maxReps;return null!=e&&null!=t&&e>t?{reps:"Min repetions cannot be greater than max repetitions"}:null}function ii(i){var e=i.value.minValue,t=i.value.maxValue;return null!=e&&null!=t&&e>t?{valueLimit:"Min value cannot be greater than max value"}:null}function ei(i){var e=i.value.minDigits,t=i.value.maxDigits;return null!=e&&null!=t&&e>t?{digits:"Min digits cannot be greater than max digits"}:null}var ti=function(){function i(i,e,n){var o=this;this._service=i,this._dialog=e,this._fb=n,this._fieldSizes=[{label:"Normal",value:"normal"},{label:"Small",value:"small"},{label:"Smaller",value:"smaller"},{label:"Tiny",value:"tiny"},{label:"Mini",value:"mini"}],this._choicesOrigins=[],this._conditionalBranches=[],this._validationConditions=[],this._warningConditions=[],this.isRepeatingContainerNode=function(i){return null!=i&&F.isRepeatingContainerNode(i.node)},this._visibilitySub=w.Subscription.EMPTY,this._conditionalBranchesSub=w.Subscription.EMPTY,this._formulaRepsSub=w.Subscription.EMPTY,this._choicesFilterSub=w.Subscription.EMPTY,this._formulaSub=w.Subscription.EMPTY,this._forceValueSub=w.Subscription.EMPTY,this._validationConditionsSub=w.Subscription.EMPTY,this._warningConditionsSub=w.Subscription.EMPTY,this._nextSlideConditionSub=w.Subscription.EMPTY,this._choicesOriginsSub=w.Subscription.EMPTY,this._triggerConditionsSub=w.Subscription.EMPTY,this._editConditionDialogSub=w.Subscription.EMPTY,this._editValidationConditionDialogSub=w.Subscription.EMPTY,this._editWarningConditionDialogSub=w.Subscription.EMPTY,this._editVisibilityEvt=new t.EventEmitter,this._editVisibilitySub=w.Subscription.EMPTY,this._editConditionalBranchEvt=new t.EventEmitter,this._editConditionalBranchSub=w.Subscription.EMPTY,this._editFormulaRepsEvt=new t.EventEmitter,this._editFormulaRepsSub=w.Subscription.EMPTY,this._editChoicesFilterEvt=new t.EventEmitter,this._editChoicesFilterSub=w.Subscription.EMPTY,this._editFormulaEvt=new t.EventEmitter,this._editFormulaSub=w.Subscription.EMPTY,this._editForceValueEvt=new t.EventEmitter,this._editForceValueSub=w.Subscription.EMPTY,this._editValidationConditionEvt=new t.EventEmitter,this._editValidationConditionSub=w.Subscription.EMPTY,this._addValidationConditionEvt=new t.EventEmitter,this._addValidationConditionSub=w.Subscription.EMPTY,this._removeValidationConditionEvt=new t.EventEmitter,this._removeValidationConditionSub=w.Subscription.EMPTY,this._editWarningConditionEvt=new t.EventEmitter,this._editWarningConditionSub=w.Subscription.EMPTY,this._addWarningConditionEvt=new t.EventEmitter,this._addWarningConditionSub=w.Subscription.EMPTY,this._removeWarningConditionEvt=new t.EventEmitter,this._removeWarningConditionSub=w.Subscription.EMPTY,this._editNextSlideConditionEvt=new t.EventEmitter,this._editNextSlideConditionSub=w.Subscription.EMPTY,this._editTriggerConditionEvt=new t.EventEmitter,this._editTriggerConditionSub=w.Subscription.EMPTY,this._addTriggerConditionEvt=new t.EventEmitter,this._addTriggerConditionSub=w.Subscription.EMPTY,this._removeTriggerConditionEvt=new t.EventEmitter,this._removeTriggerConditionSub=w.Subscription.EMPTY,this._saveEvt=new t.EventEmitter,this._saveSub=w.Subscription.EMPTY,this._nodeEntry=i.editedNodeEntry,this._choicesOriginsSub=i.choicesOrigins.subscribe((function(i){return o._choicesOrigins=i||[]})),this._enabled=this._nodeEntry.pipe(D.map((function(i){return null!=i}))),this._initForm(),this._initVisibilityEdit(),this._initConditionalBranchEdit(),this._initFormulaRepsEdit(),this._initChoicesFilterEdit(),this._initFormulaEdit(),this._initForceValueEdit(),this._initValidationConditionEdit(),this._initAddValidationCondition(),this._initRemoveValidationCondition(),this._initWarningConditionEdit(),this._initAddWarningCondition(),this._initRemoveWarningCondition(),this._initNextSlideConditionEdit(),this._initTriggerConditionEdit(),this._initAddTriggerCondition(),this._initRemoveTriggerCondition(),this._initSave()}return Object.defineProperty(i.prototype,"fieldSizes",{get:function(){return this._fieldSizes},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"nodeEntry",{get:function(){return this._nodeEntry},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"choicesOrigins",{get:function(){return this._choicesOrigins},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"enabled",{get:function(){return this._enabled},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"propertiesForm",{get:function(){return this._propertiesForm},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"hasChoices",{get:function(){return this._hasChoices},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"curVisibility",{get:function(){return this._curVisibility},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"curFormulaReps",{get:function(){return this._curFormulaReps},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"curChoicesFilter",{get:function(){return this._curChoicesFilter},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"curForceValue",{get:function(){return this._curForceValue},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"curFormula",{get:function(){return this._curFormula},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"conditionalBranches",{get:function(){return this._conditionalBranches},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"validationConditions",{get:function(){return this._validationConditions},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"warningConditions",{get:function(){return this._warningConditions},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"nextSlideCondition",{get:function(){return this._nextSlideCondition},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"triggerConditions",{get:function(){return this._triggerConditions},enumerable:!0,configurable:!0}),i.prototype.editVisibility=function(){this._editVisibilityEvt.emit()},i.prototype.editConditionalBranch=function(i){i<0||i>=this._conditionalBranches.length||this._editConditionalBranchEvt.emit(i)},i.prototype.editFormulaReps=function(){this._editFormulaRepsEvt.emit()},i.prototype.editChoicesFilter=function(){this._editChoicesFilterEvt.emit()},i.prototype.editFormula=function(){this._editFormulaEvt.emit()},i.prototype.editForceValue=function(){this._editForceValueEvt.emit()},i.prototype.editValidationCondition=function(i){i<0||i>=this._validationConditions.length||this._editValidationConditionEvt.emit(i)},i.prototype.addValidationCondition=function(){this._addValidationConditionEvt.emit()},i.prototype.removeValidationCondition=function(i){i<0||i>=this._validationConditions.length||this._removeValidationConditionEvt.emit(i)},i.prototype.editWarningCondition=function(i){i<0||i>=this._warningConditions.length||this._editWarningConditionEvt.emit(i)},i.prototype.addWarningCondition=function(){this._addWarningConditionEvt.emit()},i.prototype.removeWarningCondition=function(i){i<0||i>=this._warningConditions.length||this._removeWarningConditionEvt.emit(i)},i.prototype.editNextSlideCondition=function(){this._editNextSlideConditionEvt.emit()},i.prototype.editTriggerCondition=function(i){i<0||i>=this._triggerConditions.length||this._editTriggerConditionEvt.emit(i)},i.prototype.addTriggerCondition=function(){this._addTriggerConditionEvt.emit()},i.prototype.removeTriggerCondition=function(i){i<0||i>=this._triggerConditions.length||this._removeTriggerConditionEvt.emit(i)},i.prototype.isField=function(i){return null!=i&&F.isField(i.node)},i.prototype.isNumericField=function(i){return F.isField(i)&&F.isNumberField(i)},i.prototype.isFieldWithChoices=function(i){return F.isField(i)&&F.isFieldWithChoices(i)},i.prototype.save=function(){this._saveEvt.emit()},i.prototype.cancel=function(){this._service.cancelNodeEntryEdit()},i.prototype.ngOnDestroy=function(){this._choicesOriginsSub.unsubscribe(),this._visibilitySub.unsubscribe(),this._formulaRepsSub.unsubscribe(),this._choicesFilterSub.unsubscribe(),this._formulaSub.unsubscribe(),this._forceValueSub.unsubscribe(),this._validationConditionsSub.unsubscribe(),this._warningConditionsSub.unsubscribe(),this._triggerConditionsSub.unsubscribe(),this._editConditionDialogSub.unsubscribe(),this._editValidationConditionDialogSub.unsubscribe(),this._editWarningConditionDialogSub.unsubscribe(),this._editChoicesFilterSub.unsubscribe(),this._editConditionalBranchSub.unsubscribe(),this._editVisibilitySub.unsubscribe(),this._editFormulaRepsSub.unsubscribe(),this._editFormulaSub.unsubscribe(),this._editForceValueSub.unsubscribe(),this._editValidationConditionSub.unsubscribe(),this._editWarningConditionSub.unsubscribe(),this._nextSlideConditionSub.unsubscribe(),this._addTriggerConditionSub.unsubscribe(),this._addValidationConditionSub.unsubscribe(),this._addWarningConditionSub.unsubscribe(),this._editNextSlideConditionSub.unsubscribe(),this._editTriggerConditionSub.unsubscribe(),this._removeTriggerConditionSub.unsubscribe(),this._removeValidationConditionSub.unsubscribe(),this._removeWarningConditionSub.unsubscribe(),this._saveSub.unsubscribe()},i.prototype._initSave=function(){var i=this;this._saveSub=this._saveEvt.pipe(D.withLatestFrom(this.propertiesForm)).subscribe((function(e){var t=x.__assign(x.__assign({},e[1].value),{conditionalBranches:i._conditionalBranches});i._service.saveNodeEntry(t)}))},i.prototype._initForm=function(){var i=this;this._propertiesForm=this._nodeEntry.pipe(D.filter((function(i){return null!=i})),D.map((function(e){null!=i._visibilitySub&&i._visibilitySub.unsubscribe(),null!=i._conditionalBranchesSub&&i._conditionalBranchesSub.unsubscribe();var t=null!=(e=e).node.visibility?e.node.visibility.condition:null,o=null!=e.node.visibility?i._guessVisibilityOpt(e.node.visibility):null,r={name:[e.node.name,n.Validators.required],label:e.node.label,visibilityOpt:[o,n.Validators.required],visibility:[t,n.Validators.required],conditionalBranchesNum:e.node.conditionalBranches.length},a=[];if(F.isRepeatingContainerNode(e.node)){var s=e.node,l=null!=s.formulaReps?s.formulaReps.formula:null;r.formulaReps=[l,n.Validators.required],r.minReps=s.minReps,r.maxReps=s.maxReps,i._curFormulaReps=l,a.push(X)}if(i.isField(e)){var d=e.node,c=null,u=!1,p=[];null!=d.validation&&(null!=d.validation.forceValue&&(c=d.validation.forceValue.condition),u=null!=d.validation.notEmpty,p=(d.validation.conditions||[]).map((function(i){return{condition:i.condition,errorMessage:i.errorMessage}})));var f=!1,m=[];null!=d.warning&&(f=null!=d.warning.notEmpty,m=(d.warning.conditions||[]).map((function(i){return{condition:i.condition,warningMessage:i.warningMessage}})));var h=null!=d.formula?d.formula.formula:null;r.description=d.description,r.defaultValue=d.defaultValue,r.size=d.size,r.formula=h,r.forceValue=c,r.notEmpty=u,r.validationConditions=[p,[]],r.notEmptyWarning=f,r.warningConditions=[m,[]],r.nextSlideCondition=[d.nextSlideCondition],i._curForceValue=c,i._curFormula=h,i._validationConditions=p,i._warningConditions=m}if(i.isNumericField(e.node)){var g=e.node,b=void 0,_=void 0,v=void 0,y=void 0;null!=g.validation&&(null!=g.validation.minValue&&(b=(g.validation.minValue.condition||"").replace("$value >= ","")),null!=g.validation.maxValue&&(_=(g.validation.maxValue.condition||"").replace("$value <= ","")),null!=g.validation.minDigits&&(v=(g.validation.minDigits.condition||"").replace("$value.toString().length >= ","")),null!=g.validation.maxDigits&&(y=(g.validation.maxDigits.condition||"").replace("$value.toString().length <= ",""))),r.minValue=b,r.maxValue=_,r.minDigits=v,r.maxDigits=y,a.push(ii),a.push(ei)}if(i.isFieldWithChoices(e.node)){var C=e.node,S=(C.triggerConditions||[]).map((function(i){return i.condition}));r.choicesOriginRef=C.choicesOriginRef,r.choicesFilter=null!=C.choicesFilter?C.choicesFilter.formula:null,r.forceExpanded=C.forceExpanded,r.forceNarrow=C.forceNarrow,r.triggerConditions=S,i._triggerConditions=S}var j=i._fb.group(r);return j.setValidators(a),i._conditionalBranches=e.node.conditionalBranches.map((function(i){return i.condition})),i._curVisibility=null!=e.node.visibility?e.node.visibility.condition:null,i._handleConditionalBranchesChange(j),i._handleVisibilityChange(j),i._handleFormulaRepsChange(j),i._handleChoicesFilterChange(j),i._handleFormulaChange(j),i._handleForceValueChange(j),i._handleValidationCondtionsChange(j),i._handleWarningCondtionsChange(j),i._handleNextSlideConditionChange(j),i._handleTriggerCondtionsChange(j),j})),D.publishReplay(1),D.refCount())},i.prototype._destroyConditionDialog=function(){null!=this._editConditionDialogSub&&(this._editConditionDialogSub.unsubscribe(),this._editConditionDialogSub=w.Subscription.EMPTY),null!=this._editConditionDialog&&(this._editConditionDialog.close(),this._editConditionDialog=null)},i.prototype._destroyValidationConditionDialog=function(){null!=this._editValidationConditionDialogSub&&(this._editValidationConditionDialogSub.unsubscribe(),this._editValidationConditionDialogSub=w.Subscription.EMPTY),null!=this._editValidationConditionDialog&&(this._editValidationConditionDialog.close(),this._editValidationConditionDialog=null)},i.prototype._destroyWarningConditionDialog=function(){null!=this._editWarningConditionDialogSub&&(this._editWarningConditionDialogSub.unsubscribe(),this._editWarningConditionDialogSub=w.Subscription.EMPTY),null!=this._editWarningConditionDialog&&(this._editWarningConditionDialog.close(),this._editWarningConditionDialog=null)},i.prototype._initRemoveTriggerCondition=function(){this._removeTriggerConditionSub=this._removeTriggerConditionEvt.pipe(D.withLatestFrom(this._propertiesForm)).subscribe((function(i){var e=i[0],t=i[1];if(null!=t){var n=t.controls.triggerConditions,o=(n.value||[]).slice(0);e<0||e>=o.length||(o.splice(e,1),n.setValue(o))}}))},i.prototype._initAddTriggerCondition=function(){this._addTriggerConditionSub=this._addTriggerConditionEvt.pipe(D.withLatestFrom(this._propertiesForm)).subscribe((function(i){var e=i[1];if(null!=e){var t=e.controls.triggerConditions,n=(t.value||[]).slice(0);n.push(""),t.setValue(n)}}))},i.prototype._initTriggerConditionEdit=function(){var i=this;this._editTriggerConditionSub=this._editTriggerConditionEvt.pipe(D.withLatestFrom(this._propertiesForm)).subscribe((function(e){i._destroyConditionDialog();var t=e[0];t<0||t>=i._triggerConditions.length||null==e[1]||(i._editConditionDialog=i._dialog.open(H),i._editConditionDialog.componentInstance.condition=i._triggerConditions[t],i._editConditionDialogSub=i._editConditionDialog.afterClosed().subscribe((function(e){void 0!==e&&(i._triggerConditions[t]=e),i._editConditionDialogSub.unsubscribe(),i._editConditionDialogSub=w.Subscription.EMPTY})))}))},i.prototype._initRemoveWarningCondition=function(){this._removeWarningConditionSub=this._removeWarningConditionEvt.pipe(D.withLatestFrom(this._propertiesForm)).subscribe((function(i){var e=i[0],t=i[1];if(null!=t){var n=t.controls.warningConditions,o=(n.value||[]).slice(0);e<0||e>=o.length||(o.splice(e,1),n.setValue(o))}}))},i.prototype._initAddWarningCondition=function(){this._addWarningConditionSub=this._addWarningConditionEvt.pipe(D.withLatestFrom(this._propertiesForm)).subscribe((function(i){var e=i[1];if(null!=e){var t=e.controls.warningConditions,n=(t.value||[]).slice(0);n.push({condition:"",errorMessage:""}),t.setValue(n)}}))},i.prototype._initWarningConditionEdit=function(){var i=this;this._editWarningConditionSub=this._editWarningConditionEvt.pipe(D.withLatestFrom(this._propertiesForm)).subscribe((function(e){i._destroyWarningConditionDialog();var t=e[0];if(!(t<0||t>=i._warningConditions.length||null==e[1])){i._editWarningConditionDialog=i._dialog.open(Q);var n=i._editWarningConditionDialog.componentInstance,o=i._warningConditions[t];n.condition=o.condition,n.warningMessage=o.warningMessage,i._editWarningConditionDialogSub=i._editWarningConditionDialog.afterClosed().subscribe((function(e){void 0!==e&&(i._warningConditions[t]=e),i._editWarningConditionDialogSub.unsubscribe(),i._editWarningConditionDialogSub=w.Subscription.EMPTY}))}}))},i.prototype._initRemoveValidationCondition=function(){this._removeValidationConditionSub=this._removeValidationConditionEvt.pipe(D.withLatestFrom(this._propertiesForm)).subscribe((function(i){var e=i[0],t=i[1];if(null!=t){var n=t.controls.validationConditions,o=(n.value||[]).slice(0);e<0||e>=o.length||(o.splice(e,1),n.setValue(o))}}))},i.prototype._initAddValidationCondition=function(){this._addValidationConditionSub=this._addValidationConditionEvt.pipe(D.withLatestFrom(this._propertiesForm)).subscribe((function(i){var e=i[1];if(null!=e){var t=e.controls.validationConditions,n=(t.value||[]).slice(0);n.push({condition:"",errorMessage:""}),t.setValue(n)}}))},i.prototype._initValidationConditionEdit=function(){var i=this;this._editValidationConditionSub=this._editValidationConditionEvt.pipe(D.withLatestFrom(this._propertiesForm)).subscribe((function(e){i._destroyValidationConditionDialog();var t=e[0];if(!(t<0||t>=i._validationConditions.length||null==e[1])){i._editValidationConditionDialog=i._dialog.open(K);var n=i._editValidationConditionDialog.componentInstance,o=i._validationConditions[t];n.condition=o.condition,n.errorMessage=o.errorMessage,i._editValidationConditionDialogSub=i._editValidationConditionDialog.afterClosed().subscribe((function(e){void 0!==e&&(i._validationConditions[t]=e),i._editValidationConditionDialogSub.unsubscribe(),i._editValidationConditionDialogSub=w.Subscription.EMPTY}))}}))},i.prototype._initForceValueEdit=function(){var i=this;this._editForceValueSub=this._editForceValueEvt.pipe(D.withLatestFrom(this._propertiesForm)).subscribe((function(e){i._destroyConditionDialog();var t=e[1];if(null!=t){var n=t.controls.forceValue;i._editConditionDialog=i._dialog.open(H),i._editConditionDialog.componentInstance.condition=n.value,i._editConditionDialogSub=i._editConditionDialog.afterClosed().subscribe((function(e){void 0!==e&&n.setValue(e),i._editConditionDialogSub.unsubscribe(),i._editConditionDialogSub=w.Subscription.EMPTY}))}}))},i.prototype._initNextSlideConditionEdit=function(){var i=this;this._editNextSlideConditionSub=this._editNextSlideConditionEvt.pipe(D.withLatestFrom(this._propertiesForm)).subscribe((function(e){i._destroyConditionDialog();var t=e[1];if(null!=t){var n=t.controls.nextSlideCondition;i._editConditionDialog=i._dialog.open(H),i._editConditionDialog.componentInstance.condition=n.value,i._editConditionDialogSub=i._editConditionDialog.afterClosed().subscribe((function(e){void 0!==e&&n.setValue(e),i._editConditionDialogSub.unsubscribe(),i._editConditionDialogSub=w.Subscription.EMPTY}))}}))},i.prototype._initFormulaEdit=function(){var i=this;this._editFormulaSub=this._editFormulaEvt.pipe(D.withLatestFrom(this._propertiesForm)).subscribe((function(e){i._destroyConditionDialog();var t=e[1];if(null!=t){var n=t.controls.formula;i._editConditionDialog=i._dialog.open(H),i._editConditionDialog.componentInstance.condition=n.value,i._editConditionDialogSub=i._editConditionDialog.afterClosed().subscribe((function(e){void 0!==e&&n.setValue(e),i._editConditionDialogSub.unsubscribe(),i._editConditionDialogSub=w.Subscription.EMPTY}))}}))},i.prototype._initFormulaRepsEdit=function(){var i=this;this._editFormulaRepsSub=this._editFormulaRepsEvt.pipe(D.withLatestFrom(this._propertiesForm)).subscribe((function(e){i._destroyConditionDialog();var t=e[1];if(null!=t){var n=t.controls.formulaReps;i._editConditionDialog=i._dialog.open(H),i._editConditionDialog.componentInstance.condition=n.value,i._editConditionDialogSub=i._editConditionDialog.afterClosed().subscribe((function(e){void 0!==e&&n.setValue(e),i._editConditionDialogSub.unsubscribe(),i._editConditionDialogSub=w.Subscription.EMPTY}))}}))},i.prototype._initChoicesFilterEdit=function(){var i=this;this._editChoicesFilterSub=this._editChoicesFilterEvt.pipe(D.withLatestFrom(this._propertiesForm)).subscribe((function(e){i._destroyConditionDialog();var t=e[1];if(null!=t){var n=t.controls.choicesFilter;i._editConditionDialog=i._dialog.open(H),i._editConditionDialog.componentInstance.condition=n.value,i._editConditionDialogSub=i._editConditionDialog.afterClosed().subscribe((function(e){void 0!==e&&n.setValue(e),i._editConditionDialogSub.unsubscribe(),i._editConditionDialogSub=w.Subscription.EMPTY}))}}))},i.prototype._initConditionalBranchEdit=function(){var i=this;this._editConditionalBranchSub=this._editConditionalBranchEvt.pipe(D.withLatestFrom(this._propertiesForm)).subscribe((function(e){i._destroyConditionDialog();var t=e[0];t<0||t>=i._conditionalBranches.length||null==e[1]||(i._editConditionDialog=i._dialog.open(H),i._editConditionDialog.componentInstance.condition=i._conditionalBranches[t],i._editConditionDialogSub=i._editConditionDialog.afterClosed().subscribe((function(e){void 0!==e&&(i._conditionalBranches[t]=e),i._editConditionDialogSub.unsubscribe(),i._editConditionDialogSub=w.Subscription.EMPTY})))}))},i.prototype._initVisibilityEdit=function(){var i=this;this._editVisibilitySub=this._editVisibilityEvt.pipe(D.withLatestFrom(this._propertiesForm)).subscribe((function(e){i._destroyConditionDialog();var t=e[1];if(null!=t){var n=t.controls.visibility,o=n.value;i._editConditionDialog=i._dialog.open(H),i._editConditionDialog.componentInstance.condition=o,i._editConditionDialogSub=i._editConditionDialog.afterClosed().subscribe((function(e){void 0!==e&&n.setValue(e),i._editConditionDialogSub.unsubscribe(),i._editConditionDialogSub=w.Subscription.EMPTY}))}}))},i.prototype._handleTriggerCondtionsChange=function(i){var e=this;this._triggerConditionsSub=i.valueChanges.pipe(D.distinctUntilChanged((function(i,e){return JSON.stringify(i.triggerConditions)===JSON.stringify(e.triggerConditions)}))).subscribe((function(i){e._triggerConditions=i.triggerConditions}))},i.prototype._handleWarningCondtionsChange=function(i){var e=this;this._warningConditionsSub=i.valueChanges.pipe(D.distinctUntilChanged((function(i,e){return JSON.stringify(i.warningConditions)===JSON.stringify(e.warningConditions)}))).subscribe((function(i){e._warningConditions=i.warningConditions}))},i.prototype._handleValidationCondtionsChange=function(i){var e=this;this._validationConditionsSub=i.valueChanges.pipe(D.distinctUntilChanged((function(i,e){return JSON.stringify(i.validationConditions)===JSON.stringify(e.validationConditions)}))).subscribe((function(i){e._validationConditions=i.validationConditions}))},i.prototype._handleForceValueChange=function(i){var e=this;this._forceValueSub=i.valueChanges.pipe(D.distinctUntilChanged((function(i,e){return i.forceValue===e.forceValue}))).subscribe((function(i){e._curForceValue=i.forceValue}))},i.prototype._handleNextSlideConditionChange=function(i){var e=this;this._formulaSub=i.valueChanges.pipe(D.distinctUntilChanged((function(i,e){return i.nextSlideCondition===e.nextSlideCondition}))).subscribe((function(i){e._nextSlideCondition=i.nextSlideCondition}))},i.prototype._handleFormulaChange=function(i){var e=this;this._formulaSub=i.valueChanges.pipe(D.distinctUntilChanged((function(i,e){return i.formula===e.formula}))).subscribe((function(i){e._curFormula=i.formula}))},i.prototype._handleFormulaRepsChange=function(i){var e=this;this._formulaRepsSub=i.valueChanges.pipe(D.distinctUntilChanged((function(i,e){return i.formulaReps===e.formulaReps}))).subscribe((function(i){e._curFormulaReps=i.formulaReps}))},i.prototype._handleChoicesFilterChange=function(i){var e=this;this._choicesFilterSub=i.valueChanges.pipe(D.distinctUntilChanged((function(i,e){return i.choicesFilter===e.choicesFilter}))).subscribe((function(i){e._curChoicesFilter=i.choicesFilter}))},i.prototype._handleConditionalBranchesChange=function(i){var e=this;this._conditionalBranchesSub=i.valueChanges.pipe(D.distinctUntilChanged((function(i,e){return i.conditionalBranchesNum===e.conditionalBranchesNum}))).subscribe((function(i){var t=i.conditionalBranchesNum,n=e._conditionalBranches.length;if(n<t){for(var o=[],r=n;r<t;r++)o.push(N.alwaysCondition().condition);e._conditionalBranches=e._conditionalBranches.concat(o)}else n>t&&e._conditionalBranches.splice(0,n-t)}))},i.prototype._handleVisibilityChange=function(i){var e=this;this._visibilitySub=i.valueChanges.pipe(D.distinctUntilChanged((function(i,e){return i.visibilityOpt===e.visibilityOpt}))).subscribe((function(t){var n;switch(t.visibilityOpt){case"always":n=N.alwaysCondition().condition;break;case"never":n=N.neverCondition().condition;break;default:n=null}e._curVisibility=n,i.controls.visibility.setValue(n)}))},i.prototype._guessVisibilityOpt=function(i){return 0===i.condition.localeCompare(N.alwaysCondition().condition)?"always":0===i.condition.localeCompare(N.neverCondition().condition)?"never":"condition"},i.decorators=[{type:t.Component,args:[{selector:"ajf-fb-node-properties",template:'<div [style.display]="(enabled|async) ? \'none\' : \'block\'" class="ajf-disabled-overlay"></div>\n<div class="ajf-header">\n  <h3 translate>Properties</h3>\n  <mat-icon (click)="save()">save</mat-icon>\n  <mat-icon (click)="cancel()">cancel</mat-icon>\n</div>\n<ng-container *ngIf="nodeEntry|async as ne">\n  <ng-container *ngIf="propertiesForm|async as pf">\n    <form [formGroup]="pf!" novalidate>\n      <div class="ajf-prop">\n        <mat-form-field>\n          <input matInput formControlName="name" [placeholder]="\'Name\' | translate">\n        </mat-form-field>\n      </div>\n      <div class="ajf-prop">\n        <mat-form-field>\n          <input matInput formControlName="label" [placeholder]="\'Label\' | translate">\n        </mat-form-field>\n      </div>\n      <div class="ajf-prop">\n        <mat-form-field>\n          <mat-label translate>Visibility</mat-label>\n          <mat-select\n              formControlName="visibilityOpt" [placeholder]="\'Visible\' | translate">\n            <mat-option value="always" translate>Always</mat-option>\n            <mat-option value="never" translate>Never</mat-option>\n            <mat-option value="condition" translate>Condition...</mat-option>\n          </mat-select>\n        </mat-form-field>\n        <button (click)="editVisibility()"\n            [disabled]="pf!.value.visibilityOpt != \'condition\'"\n            mat-raised-button [matTooltip]="curVisibility || \'\'">\n          <div class="ajf-icon-cont">\n            <mat-icon>edit</mat-icon>\n            <span>{{ curVisibility }}</span>\n          </div>\n        </button>\n      </div>\n      <div class="ajf-prop">\n        <div><label translate>Branches</label></div>\n        <div>\n          <mat-slider formControlName="conditionalBranchesNum"\n              thumbLabel tickInterval="auto" min="1" max="5" step="1"></mat-slider>\n        </div>\n        <div *ngFor="let branch of conditionalBranches; let idx = index">\n          <button (click)="editConditionalBranch(idx)" mat-raised-button [matTooltip]="branch">\n            <div class="ajf-icon-cont">\n              <mat-icon>edit</mat-icon>\n              <span>{{ branch }}</span>\n            </div>\n          </button>\n        </div>\n      </div>\n      <ng-template [ngIf]="isRepeatingContainerNode(ne)">\n        <div class="ajf-prop">\n          <div><label translate>Repetitions</label></div>\n          <div>\n            <button (click)="editFormulaReps()" mat-raised-button [matTooltip]="curFormulaReps || \'\'">\n              <div class="ajf-icon-cont">\n                <mat-icon>edit</mat-icon>\n                <span>{{ curFormulaReps }}</span>\n              </div>\n            </button>\n          </div>\n          <div><label translate>Min repetitions</label></div>\n          <div>\n            <mat-slider formControlName="minReps"\n                thumbLabel tickInterval="auto" min="1" max="5" step="1"></mat-slider>\n          </div>\n          <div><label translate>Max repetitions</label></div>\n          <div>\n            <mat-slider formControlName="maxReps"\n                thumbLabel tickInterval="auto" min="1" max="5" step="1"></mat-slider>\n          </div>\n        </div>\n      </ng-template>\n      <ng-template [ngIf]="isField(ne)">\n        <div class="ajf-prop">\n          <mat-form-field>\n            <mat-label translate>Field size</mat-label>\n            <mat-select formControlName="size"\n                [placeholder]="\'Size\' | translate">\n              <mat-option *ngFor="let fieldSize of fieldSizes"\n                [value]="fieldSize.value">\n                {{ fieldSize.label }}\n              </mat-option>\n            </mat-select>\n          </mat-form-field>\n        </div>\n        <div class="ajf-prop">\n          <mat-form-field>\n            <textarea matInput formControlName="description"\n                [placeholder]="\'Description\' | translate"></textarea>\n          </mat-form-field>\n        </div>\n        <div class="ajf-prop">\n          <mat-form-field>\n            <input matInput formControlName="defaultValue"\n              [placeholder]="\'Default value\' | translate">\n          </mat-form-field>\n        </div>\n        <div class="ajf-prop">\n          <div><label translate>Formula</label></div>\n          <div>\n            <button (click)="editFormula()" mat-raised-button [matTooltip]="curFormula || \'\'">\n              <div class="ajf-icon-cont">\n                <mat-icon>edit</mat-icon>\n                <span>{{ curFormula }}</span>\n              </div>\n            </button>\n          </div>\n        </div>\n        \x3c!-- <div class="ajf-prop">\n          <div><label translate>Force value</label></div>\n          <div>\n            <button (click)="editForceValue()" mat-raised-button [matTooltip]="curForceValue">\n              <div class="ajf-icon-cont">\n                <mat-icon>edit</mat-icon>\n                <span>{{ curForceValue }}</span>\n              </div>\n            </button>\n          </div>\n        </div> --\x3e\n        <div class="ajf-prop">\n          <mat-checkbox formControlName="notEmpty" translate>Not empty</mat-checkbox>\n        </div>\n        <ng-template [ngIf]="isNumericField(ne!.node)">\n          <div class="ajf-prop">\n            <mat-form-field>\n              <input matInput formControlName="minValue"\n                [placeholder]="\'Min value\' | translate">\n            </mat-form-field>\n          </div>\n          <div class="ajf-prop">\n            <mat-form-field>\n              <input matInput formControlName="maxValue"\n                [placeholder]="\'Max value\' | translate">\n            </mat-form-field>\n          </div>\n          <div class="ajf-prop">\n            <mat-form-field>\n              <input matInput formControlName="minDigits"\n                [placeholder]="\'Min digits\' | translate">\n            </mat-form-field>\n          </div>\n          <div class="ajf-prop">\n            <mat-form-field>\n              <input matInput formControlName="maxDigits"\n                [placeholder]="\'Max digits\' | translate">\n            </mat-form-field>\n          </div>\n        </ng-template>\n        <div class="ajf-prop">\n          <div class="ajf-header">\n            <label translate>Validation</label>\n            <mat-icon class="ajf-pointer" (click)="addValidationCondition()">add_circle_outline</mat-icon>\n          </div>\n          <div *ngIf="validationConditions == null || validationConditions.length == 0"\n              class="ajf-validation-row ajf-emph" translate>No conditions</div>\n          <div class="ajf-validation-row" *ngFor="let validationCondition of validationConditions; let idx = index">\n            <button (click)="editValidationCondition(idx)"\n                mat-raised-button [matTooltip]="validationCondition.condition">\n              <div class="ajf-icon-cont">\n                <mat-icon>edit</mat-icon>\n                <span>{{ validationCondition.condition }}</span>\n              </div>\n            </button>\n            <mat-icon class="ajf-pointer" (click)="removeValidationCondition(idx)">remove_circle_outline</mat-icon>\n          </div>\n        </div>\n        <div class="ajf-prop">\n          <mat-checkbox formControlName="notEmptyWarning" translate>Not empty warning</mat-checkbox>\n        </div>\n        <div class="ajf-prop">\n          <div class="ajf-header">\n            <label translate>Warnings</label>\n            <mat-icon class="ajf-pointer" (click)="addWarningCondition()">add_circle_outline</mat-icon>\n          </div>\n          <div  *ngIf="warningConditions == null || warningConditions.length == 0"\n              class="ajf-validation-row ajf-emph" translate>No warnings</div>\n          <div class="ajf-validation-row" *ngFor="let warningCondition of warningConditions; let idx = index">\n            <button (click)="editWarningCondition(idx)"\n                mat-raised-button [matTooltip]="warningCondition.condition">\n              <div class="ajf-icon-cont">\n                <mat-icon>edit</mat-icon>\n                <span>{{ warningCondition.condition }}</span>\n              </div>\n            </button>\n            <mat-icon class="ajf-pointer" (click)="removeWarningCondition(idx)">remove_circle_outline</mat-icon>\n          </div>\n        </div>\n        <div class="ajf-prop">\n          <div><label translate>Go to next slide condition</label></div>\n          <div>\n            <button (click)="editNextSlideCondition()" mat-raised-button [matTooltip]="nextSlideCondition">\n              <div class="ajf-icon-cont">\n                <mat-icon>edit</mat-icon>\n                <span>{{ nextSlideCondition }}</span>\n              </div>\n            </button>\n          </div>\n        </div>\n        <ng-template [ngIf]="isFieldWithChoices(ne!.node)">\n          <div class="ajf-prop">\n            <mat-form-field>\n              <mat-label translate>Choices origins</mat-label>\n              <mat-select formControlName="choicesOriginRef" [placeholder]="\'Choices\' | translate">\n                <mat-option *ngFor="let choicesOrigin of choicesOrigins" [value]="choicesOrigin.name">\n                  {{ choicesOrigin.label || choicesOrigin.name }}\n                </mat-option>\n              </mat-select>\n            </mat-form-field>\n          </div>\n          <div class="ajf-prop">\n            <div><label translate>Choices filter</label></div>\n            <div>\n              <button (click)="editChoicesFilter()" mat-raised-button [matTooltip]="curChoicesFilter">\n                <div class="ajf-icon-cont">\n                  <mat-icon>edit</mat-icon>\n                  <span>{{ curChoicesFilter }}</span>\n                </div>\n              </button>\n            </div>\n          </div>\n          <div class="ajf-prop">\n            <mat-checkbox formControlName="forceExpanded" translate>Force expanded selection</mat-checkbox>\n          </div>\n          <div class="ajf-prop">\n            <mat-checkbox formControlName="forceNarrow" translate>Force narrow selection</mat-checkbox>\n          </div>\n          <div class="ajf-prop">\n            <div class="ajf-header">\n              <label translate>Trigger selection</label>\n              <mat-icon class="ajf-pointer" (click)="addTriggerCondition()">add_circle_outline</mat-icon>\n            </div>\n            <div *ngIf="triggerConditions == null || triggerConditions.length == 0"\n                class="ajf-validation-row ajf-emph" translate>No trigger condition </div>\n            <div class="ajf-validation-row" *ngFor="let triggerCondition of triggerConditions; let idx = index">\n              <button (click)="editTriggerCondition(idx)"\n                  mat-raised-button [matTooltip]="triggerCondition">\n                <div class="ajf-icon-cont">\n                  <mat-icon>edit</mat-icon>\n                  <span>{{ triggerCondition }}</span>\n                </div>\n              </button>\n              <mat-icon class="pointer" (click)="removeTriggerCondition(idx)">remove_circle_outline</mat-icon>\n            </div>\n          </div>\n        </ng-template>\n      </ng-template>\n    </form>\n  </ng-container>\n</ng-container>\n',encapsulation:t.ViewEncapsulation.None,changeDetection:t.ChangeDetectionStrategy.OnPush,styles:["ajf-fb-node-properties{display:block;padding:1em;position:relative}ajf-fb-node-properties mat-icon{cursor:pointer}ajf-fb-node-properties .ajf-header{display:flex;flex-direction:row;align-items:center;flex-wrap:nowrap}ajf-fb-node-properties .ajf-header>h3,ajf-fb-node-properties .ajf-header>label{flex:1 0 auto;margin-right:.5em}ajf-fb-node-properties .ajf-header>mat-icon{flex:0 0 auto;margin-left:.5em}ajf-fb-node-properties .ajf-disabled-overlay{position:absolute;top:0;right:0;bottom:0;left:0;opacity:.4;background-color:#fff}ajf-fb-node-properties .ajf-emph{font-style:italic}ajf-fb-node-properties [mat-raised-button]{margin:.5em 0}ajf-fb-node-properties [mat-raised-button].ajf-pointer{cursor:pointer}ajf-fb-node-properties [mat-raised-button] .ajf-icon-cont{display:flex;flex-direction:row;align-items:center}ajf-fb-node-properties [mat-raised-button] .ajf-icon-cont span{flex:1 1 auto;overflow:hidden;text-overflow:ellipsis;display:block;min-height:36px}ajf-fb-node-properties .ajf-validation-row{margin:.5em 0;display:flex;flex-direction:row;align-items:center}ajf-fb-node-properties .ajf-validation-row button{flex:1 1 auto}ajf-fb-node-properties .ajf-validation-row mat-icon{flex:0 0 auto}ajf-fb-node-properties .ajf-prop{margin:.5em 0}ajf-fb-node-properties mat-form-field,ajf-fb-node-properties mat-slider,ajf-fb-node-properties [mat-raised-button]{width:100%}\n"]}]}],i.ctorParameters=function(){return[{type:U},{type:c.MatDialog},{type:n.FormBuilder}]},i}(),ni=function(){function i(i){this._cdr=i}return Object.defineProperty(i.prototype,"nodeType",{get:function(){return this._nodeType},set:function(i){this._nodeType=i,this._cdr.markForCheck()},enumerable:!0,configurable:!0}),i.decorators=[{type:t.Component,args:[{selector:"ajf-fb-node-type-entry",template:'<ng-container *ngIf="nodeType">\n  <mat-icon\n    [fontSet]="nodeType.icon.fontSet" [fontIcon]="nodeType.icon.fontIcon"></mat-icon>\n  {{ nodeType.label }}\n</ng-container>\n',encapsulation:t.ViewEncapsulation.None,changeDetection:t.ChangeDetectionStrategy.OnPush,styles:["ajf-fb-node-type-entry{display:block;padding:1em 1.5em}ajf-fb-node-type-entry mat-icon{vertical-align:middle}\n"]}]}],i.ctorParameters=function(){return[{type:t.ChangeDetectorRef}]},i.propDecorators={nodeType:[{type:t.Input}]},i}(),oi=function(){function i(){}return i.decorators=[{type:t.NgModule,args:[{imports:[e.CommonModule,n.FormsModule,n.ReactiveFormsModule,o.DragDropModule,r.MatAutocompleteModule,a.MatButtonModule,s.MatCardModule,l.MatCheckboxModule,d.MatChipsModule,c.MatDialogModule,u.MatFormFieldModule,p.MatIconModule,f.MatInputModule,m.MatListModule,h.MatMenuModule,g.MatSelectModule,b.MatSidenavModule,_.MatSliderModule,v.MatTableModule,y.MatToolbarModule,C.MatTooltipModule,S.TranslateModule,j.AjfMonacoEditorModule,E.AjfNodeIconModule],declarations:[M,q,I,H,z,G,ti,ni,$,K,Q,J],exports:[J],providers:[U]}]}],i}();
/**
     * @license
     * Copyright (C) 2018 Gnucoop soc. coop.
     *
     * This file is part of the Advanced JSON forms (ajf).
     *
     * Advanced JSON forms (ajf) is free software: you can redistribute it and/or
     * modify it under the terms of the GNU Affero General Public License as
     * published by the Free Software Foundation, either version 3 of the License,
     * or (at your option) any later version.
     *
     * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,
     * but WITHOUT ANY WARRANTY; without even the implied warranty of
     * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero
     * General Public License for more details.
     *
     * You should have received a copy of the GNU Affero General Public License
     * along with Advanced JSON forms (ajf).
     * If not, see http://www.gnu.org/licenses/.
     *
     */
/**
     * @license
     * Copyright (C) 2018 Gnucoop soc. coop.
     *
     * This file is part of the Advanced JSON forms (ajf).
     *
     * Advanced JSON forms (ajf) is free software: you can redistribute it and/or
     * modify it under the terms of the GNU Affero General Public License as
     * published by the Free Software Foundation, either version 3 of the License,
     * or (at your option) any later version.
     *
     * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,
     * but WITHOUT ANY WARRANTY; without even the implied warranty of
     * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero
     * General Public License for more details.
     *
     * You should have received a copy of the GNU Affero General Public License
     * along with Advanced JSON forms (ajf).
     * If not, see http://www.gnu.org/licenses/.
     *
     */
i.AjfFormBuilder=J,i.AjfFormBuilderModule=oi,i.AjfFormBuilderService=U,i.flattenNodes=B,i.ɵajf_src_material_form_builder_form_builder_a=M,i.ɵajf_src_material_form_builder_form_builder_b=q,i.ɵajf_src_material_form_builder_form_builder_c=I,i.ɵajf_src_material_form_builder_form_builder_d=H,i.ɵajf_src_material_form_builder_form_builder_e=z,i.ɵajf_src_material_form_builder_form_builder_f=G,i.ɵajf_src_material_form_builder_form_builder_g=ti,i.ɵajf_src_material_form_builder_form_builder_h=ni,i.ɵajf_src_material_form_builder_form_builder_i=$,i.ɵajf_src_material_form_builder_form_builder_j=K,i.ɵajf_src_material_form_builder_form_builder_k=Q,Object.defineProperty(i,"__esModule",{value:!0})}));