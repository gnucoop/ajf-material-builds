{"version":3,"file":"material-form-builder.umd.js","sources":["../../../../../src/material/form-builder/branch-line.ts","../../../../../external/npm/node_modules/tslib/tslib.es6.js","../../../../../src/material/form-builder/choices-origin-data-source.ts","../../../../../src/material/form-builder/choices-origin-editor.ts","../../../../../src/material/form-builder/form-builder-service.ts","../../../../../src/material/form-builder/choices-origin-editor-dialog.ts","../../../../../src/material/form-builder/condition-editor.ts","../../../../../src/material/form-builder/condition-editor-dialog.ts","../../../../../src/material/form-builder/form-builder-utils.ts","../../../../../src/material/form-builder/string-identifier-dialog.ts","../../../../../src/material/form-builder/form-builder.ts","../../../../../src/material/form-builder/node-entry.ts","../../../../../src/material/form-builder/validation-condition-editor-dialog.ts","../../../../../src/material/form-builder/warning-condition-editor-dialog.ts","../../../../../src/material/form-builder/node-properties.ts","../../../../../src/material/form-builder/node-type-entry.ts","../../../../../src/material/form-builder/form-builder-module.ts","../../../../../src/material/form-builder/public-api.ts","../../../../../src/material/form-builder/index.ts"],"sourcesContent":["/**\n * @license\n * Copyright (C) Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {\n  ChangeDetectionStrategy,\n  Component,\n  ElementRef,\n  Input,\n  Renderer2,\n  ViewEncapsulation\n} from '@angular/core';\n\n@Component({\n  selector: 'ajf-fb-branch-line',\n  templateUrl: 'branch-line.html',\n  styleUrls: ['branch-line.css'],\n  encapsulation: ViewEncapsulation.None,\n  changeDetection: ChangeDetectionStrategy.OnPush\n})\nexport class AjfFbBranchLine {\n  private _offset = 0;\n  @Input()\n  set offset(offset: number) {\n    this._offset = offset;\n    this._updateOffset();\n  }\n\n  private _color: string;\n  @Input()\n  set color(color: string) {\n    this._color = color;\n    this._updateColor();\n  }\n\n  private _height = 0;\n  @Input()\n  set height(height: number) {\n    this._height = height;\n    this._updateHeight();\n  }\n\n  constructor(private _el: ElementRef, private _renderer: Renderer2) {}\n\n  private _updateHeight(): void {\n    const height = `${Math.max(0, this._height - 25)}px`;\n    this._renderer.setStyle(this._el.nativeElement, 'height', height);\n  }\n\n  private _updateOffset(): void {\n    const margin = `${this._offset * 4}px`;\n    this._renderer.setStyle(this._el.nativeElement, 'margin-top', margin);\n    this._renderer.setStyle(this._el.nativeElement, 'margin-left', margin);\n  }\n\n  private _updateColor(): void {\n    this._renderer.setStyle(this._el.nativeElement, 'border-color', this._color);\n  }\n}\n","/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation.\r\n\r\nPermission to use, copy, modify, and/or distribute this software for any\r\npurpose with or without fee is hereby granted.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\r\nREGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\r\nAND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\r\nINDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\r\nLOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR\r\nOTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\r\nPERFORMANCE OF THIS SOFTWARE.\r\n***************************************************************************** */\r\n/* global Reflect, Promise */\r\n\r\nvar extendStatics = function(d, b) {\r\n    extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\r\n    return extendStatics(d, b);\r\n};\r\n\r\nexport function __extends(d, b) {\r\n    if (typeof b !== \"function\" && b !== null)\r\n        throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\r\n    extendStatics(d, b);\r\n    function __() { this.constructor = d; }\r\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n}\r\n\r\nexport var __assign = function() {\r\n    __assign = Object.assign || function __assign(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\r\n        }\r\n        return t;\r\n    }\r\n    return __assign.apply(this, arguments);\r\n}\r\n\r\nexport function __rest(s, e) {\r\n    var t = {};\r\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\r\n        t[p] = s[p];\r\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\r\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\r\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\r\n                t[p[i]] = s[p[i]];\r\n        }\r\n    return t;\r\n}\r\n\r\nexport function __decorate(decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n}\r\n\r\nexport function __param(paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n}\r\n\r\nexport function __metadata(metadataKey, metadataValue) {\r\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(metadataKey, metadataValue);\r\n}\r\n\r\nexport function __awaiter(thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n}\r\n\r\nexport function __generator(thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n}\r\n\r\nexport var __createBinding = Object.create ? (function(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    Object.defineProperty(o, k2, { enumerable: true, get: function() { return m[k]; } });\r\n}) : (function(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    o[k2] = m[k];\r\n});\r\n\r\nexport function __exportStar(m, o) {\r\n    for (var p in m) if (p !== \"default\" && !Object.prototype.hasOwnProperty.call(o, p)) __createBinding(o, m, p);\r\n}\r\n\r\nexport function __values(o) {\r\n    var s = typeof Symbol === \"function\" && Symbol.iterator, m = s && o[s], i = 0;\r\n    if (m) return m.call(o);\r\n    if (o && typeof o.length === \"number\") return {\r\n        next: function () {\r\n            if (o && i >= o.length) o = void 0;\r\n            return { value: o && o[i++], done: !o };\r\n        }\r\n    };\r\n    throw new TypeError(s ? \"Object is not iterable.\" : \"Symbol.iterator is not defined.\");\r\n}\r\n\r\nexport function __read(o, n) {\r\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\r\n    if (!m) return o;\r\n    var i = m.call(o), r, ar = [], e;\r\n    try {\r\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\r\n    }\r\n    catch (error) { e = { error: error }; }\r\n    finally {\r\n        try {\r\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\r\n        }\r\n        finally { if (e) throw e.error; }\r\n    }\r\n    return ar;\r\n}\r\n\r\n/** @deprecated */\r\nexport function __spread() {\r\n    for (var ar = [], i = 0; i < arguments.length; i++)\r\n        ar = ar.concat(__read(arguments[i]));\r\n    return ar;\r\n}\r\n\r\n/** @deprecated */\r\nexport function __spreadArrays() {\r\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\r\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\r\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\r\n            r[k] = a[j];\r\n    return r;\r\n}\r\n\r\nexport function __spreadArray(to, from) {\r\n    for (var i = 0, il = from.length, j = to.length; i < il; i++, j++)\r\n        to[j] = from[i];\r\n    return to;\r\n}\r\n\r\nexport function __await(v) {\r\n    return this instanceof __await ? (this.v = v, this) : new __await(v);\r\n}\r\n\r\nexport function __asyncGenerator(thisArg, _arguments, generator) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var g = generator.apply(thisArg, _arguments || []), i, q = [];\r\n    return i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i;\r\n    function verb(n) { if (g[n]) i[n] = function (v) { return new Promise(function (a, b) { q.push([n, v, a, b]) > 1 || resume(n, v); }); }; }\r\n    function resume(n, v) { try { step(g[n](v)); } catch (e) { settle(q[0][3], e); } }\r\n    function step(r) { r.value instanceof __await ? Promise.resolve(r.value.v).then(fulfill, reject) : settle(q[0][2], r); }\r\n    function fulfill(value) { resume(\"next\", value); }\r\n    function reject(value) { resume(\"throw\", value); }\r\n    function settle(f, v) { if (f(v), q.shift(), q.length) resume(q[0][0], q[0][1]); }\r\n}\r\n\r\nexport function __asyncDelegator(o) {\r\n    var i, p;\r\n    return i = {}, verb(\"next\"), verb(\"throw\", function (e) { throw e; }), verb(\"return\"), i[Symbol.iterator] = function () { return this; }, i;\r\n    function verb(n, f) { i[n] = o[n] ? function (v) { return (p = !p) ? { value: __await(o[n](v)), done: n === \"return\" } : f ? f(v) : v; } : f; }\r\n}\r\n\r\nexport function __asyncValues(o) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var m = o[Symbol.asyncIterator], i;\r\n    return m ? m.call(o) : (o = typeof __values === \"function\" ? __values(o) : o[Symbol.iterator](), i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i);\r\n    function verb(n) { i[n] = o[n] && function (v) { return new Promise(function (resolve, reject) { v = o[n](v), settle(resolve, reject, v.done, v.value); }); }; }\r\n    function settle(resolve, reject, d, v) { Promise.resolve(v).then(function(v) { resolve({ value: v, done: d }); }, reject); }\r\n}\r\n\r\nexport function __makeTemplateObject(cooked, raw) {\r\n    if (Object.defineProperty) { Object.defineProperty(cooked, \"raw\", { value: raw }); } else { cooked.raw = raw; }\r\n    return cooked;\r\n};\r\n\r\nvar __setModuleDefault = Object.create ? (function(o, v) {\r\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\r\n}) : function(o, v) {\r\n    o[\"default\"] = v;\r\n};\r\n\r\nexport function __importStar(mod) {\r\n    if (mod && mod.__esModule) return mod;\r\n    var result = {};\r\n    if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\r\n    __setModuleDefault(result, mod);\r\n    return result;\r\n}\r\n\r\nexport function __importDefault(mod) {\r\n    return (mod && mod.__esModule) ? mod : { default: mod };\r\n}\r\n\r\nexport function __classPrivateFieldGet(receiver, privateMap) {\r\n    if (!privateMap.has(receiver)) {\r\n        throw new TypeError(\"attempted to get private field on non-instance\");\r\n    }\r\n    return privateMap.get(receiver);\r\n}\r\n\r\nexport function __classPrivateFieldSet(receiver, privateMap, value) {\r\n    if (!privateMap.has(receiver)) {\r\n        throw new TypeError(\"attempted to set private field on non-instance\");\r\n    }\r\n    privateMap.set(receiver, value);\r\n    return value;\r\n}\r\n","/**\n * @license\n * Copyright (C) Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {DataSource} from '@angular/cdk/collections';\n\nimport {BehaviorSubject, Observable} from 'rxjs';\n\n\nexport type ChoicesOriginChoiceEntry = {\n  label: string,\n  value: string\n};\n\nexport class ChoicesOriginDataSource extends DataSource<ChoicesOriginChoiceEntry> {\n  private _choices: BehaviorSubject<ChoicesOriginChoiceEntry[]> =\n      new BehaviorSubject<ChoicesOriginChoiceEntry[]>([]);\n  private _choicesObs: Observable<ChoicesOriginChoiceEntry[]>;\n\n  constructor() {\n    super();\n    this._choicesObs = this._choices as Observable<ChoicesOriginChoiceEntry[]>;\n  }\n\n  connect(): Observable<ChoicesOriginChoiceEntry[]> {\n    return this._choicesObs;\n  }\n\n  disconnect() {}\n\n  updateChoices(choices: ChoicesOriginChoiceEntry[]) {\n    this._choices.next(choices);\n  }\n}\n","/**\n * @license\n * Copyright (C) Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {AjfChoicesOrigin, isChoicesFixedOrigin} from '@ajf/core/forms';\nimport {ChangeDetectionStrategy, Component, Input, ViewEncapsulation} from '@angular/core';\n\nimport {ChoicesOriginChoiceEntry, ChoicesOriginDataSource} from './choices-origin-data-source';\n\n\n@Component({\n  selector: 'ajf-fb-choices-origin-editor',\n  templateUrl: 'choices-origin-editor.html',\n  styleUrls: ['choices-origin-editor.css'],\n  encapsulation: ViewEncapsulation.None,\n  changeDetection: ChangeDetectionStrategy.OnPush\n})\nexport class AjfFbChoicesOriginEditor {\n  private _displayedColumns: string[] = ['label', 'value', 'delete'];\n  get displayedColumns(): string[] {\n    return this._displayedColumns;\n  }\n\n  private _choicesOrigin: AjfChoicesOrigin<any>;\n  get choicesOrigin(): AjfChoicesOrigin<any> {\n    return this._choicesOrigin;\n  }\n  @Input()\n  set choicesOrigin(choicesOrigin: AjfChoicesOrigin<any>) {\n    this._choicesOrigin = choicesOrigin;\n    this.name = choicesOrigin.name;\n    this.label = choicesOrigin.label;\n\n    this.canEditChoices = isChoicesFixedOrigin(choicesOrigin);\n    this._choicesArr = choicesOrigin.choices;\n    this._choices.updateChoices(this._choicesArr);\n  }\n\n  editing: {[key: string]: boolean} = {};\n  name: string;\n  label: string;\n  canEditChoices: boolean;\n\n  private _choices: ChoicesOriginDataSource = new ChoicesOriginDataSource();\n  get choices(): ChoicesOriginDataSource {\n    return this._choices;\n  }\n\n  private _choicesArr: ChoicesOriginChoiceEntry[] = [];\n  get choicesArr(): ChoicesOriginChoiceEntry[] {\n    return this._choicesArr;\n  }\n\n  updateValue(evt: any, cell: string, _value: any, rowIdx: number): void {\n    this.editing[rowIdx + '-' + cell] = false;\n    (this._choicesArr[rowIdx] as any)[cell] = evt.target.value;\n    this._choices.updateChoices(this._choicesArr);\n  }\n\n  deleteRow(rowIdx: number): void {\n    this._choicesArr.splice(rowIdx, 1);\n    this._choices.updateChoices(this._choicesArr);\n  }\n\n  addRow(): void {\n    this._choicesArr.push({label: '', value: ''});\n    this._choices.updateChoices(this._choicesArr);\n  }\n}\n","/**\n * @license\n * Copyright (C) Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {\n  AjfAttachmentsOrigin,\n  AjfChoicesOrigin,\n  AjfField,\n  AjfFieldType,\n  AjfFieldWithChoices,\n  AjfForm,\n  AjfFormStringIdentifier,\n  AjfNode,\n  AjfNodeGroup,\n  AjfNodesOperation,\n  AjfNodeType,\n  AjfRepeatingContainerNode,\n  AjfRepeatingSlide,\n  AjfSlide,\n  createChoicesFixedOrigin,\n  createContainerNode,\n  createField,\n  createForm,\n  createValidation,\n  createValidationGroup,\n  createWarning,\n  createWarningGroup,\n  isChoicesFixedOrigin,\n  isContainerNode,\n  isField,\n  isFieldWithChoices,\n  isRepeatingContainerNode,\n  isSlidesNode,\n  maxDigitsValidation,\n  maxValidation,\n  minDigitsValidation,\n  minValidation,\n  notEmptyValidation,\n  notEmptyWarning\n} from '@ajf/core/forms';\nimport {AjfCondition, alwaysCondition, createCondition, createFormula} from '@ajf/core/models';\nimport {deepCopy} from '@ajf/core/utils';\nimport {moveItemInArray} from '@angular/cdk/drag-drop';\nimport {EventEmitter, Injectable} from '@angular/core';\nimport {BehaviorSubject, combineLatest, Observable, Subject, Subscription} from 'rxjs';\nimport {filter, map, publishReplay, refCount, scan, withLatestFrom} from 'rxjs/operators';\n\nimport {\n  AjfAttachmentsOriginsOperation,\n  AjfChoicesOriginsOperation,\n  AjfFormStringIdentifierOperation\n} from './operations';\n\n\nexport interface AjfFormBuilderNodeTypeEntry {\n  label: string;\n  icon: {fontSet: string, fontIcon: string};\n  nodeType: {\n    node: AjfNodeType;\n    field?: AjfFieldType,\n  };\n  isSlide?: boolean;\n}\n\n\nexport interface AjfFormBuilderNodeEntry {\n  node: AjfNode;\n  container: AjfContainerNode|null;\n  children: AjfFormBuilderNodeEntry[];\n  content: AjfFormBuilderNodeEntry[];\n}\n\n\nexport interface AjfFormBuilderEmptySlot {\n  parent: AjfNode;\n  parentNode: number;\n}\n\n/**\n * Represents a node's position change in the formbuilder.\n */\nexport interface AjfFormBuilderMoveEvent {\n  /**\n   * The node being moved.\n   */\n  nodeEntry: AjfFormBuilderNode;\n\n  /**\n   * The index of the node previous position.\n   */\n  fromIndex: number;\n\n  /**\n   * The index of the node new position.\n   */\n  toIndex: number;\n}\n\n\nexport type AjfFormBuilderNode = AjfFormBuilderNodeEntry|AjfFormBuilderEmptySlot;\nexport type AjfContainerNode = AjfSlide|AjfRepeatingSlide|AjfNodeGroup;\n\nfunction getNodeContainer(c: {nodes: AjfNode[]}, node: AjfNode): {nodes: AjfNode[]}|null {\n  if (c.nodes.indexOf(node) > -1) {\n    return c;\n  }\n  const cns = c.nodes.filter(n => isContainerNode(n));\n  const len = cns.length;\n  for (let i = 0; i < len; i++) {\n    const cn = getNodeContainer(<AjfContainerNode>cns[i], node);\n    if (cn != null) {\n      return cn;\n    }\n  }\n  return null;\n}\n\nfunction buildFormBuilderNodesSubtree(\n    nodes: AjfNode[], parent: AjfNode, ignoreConditionalBranches = false): AjfFormBuilderNode[] {\n  const entries: AjfFormBuilderNode[] = nodes.filter(n => n.parent === parent.id)\n                                            .sort((n1, n2) => n1.parentNode - n2.parentNode)\n                                            .map(n => {\n                                              const children =\n                                                  buildFormBuilderNodesSubtree(nodes, n);\n                                              if (children.length === 0) {\n                                                children.push({parent: n, parentNode: 0});\n                                              }\n                                              return <AjfFormBuilderNodeEntry>{\n                                                node: n,\n                                                children,\n                                                content: buildFormBuilderNodesContent(nodes, n)\n                                              };\n                                            });\n  if (!ignoreConditionalBranches) {\n    const entriesNum = entries.length;\n    const cbs = parent.conditionalBranches.length;\n    for (let i = entriesNum; i < cbs; i++) {\n      entries.push({parent: parent, parentNode: i});\n    }\n  }\n  return entries;\n}\n\nfunction buildFormBuilderNodesContent(_nodes: AjfNode[], node: AjfNode): AjfFormBuilderNode[] {\n  if (isContainerNode(node)) {\n    return buildFormBuilderNodesSubtree((<AjfContainerNode>node).nodes, node, true);\n  }\n  return [];\n}\n\nexport function flattenNodes(nodes: AjfNode[]): AjfNode[] {\n  let flatNodes: AjfNode[] = [];\n\n  nodes.forEach((node: AjfNode) => {\n    if (isContainerNode(node)) {\n      flatNodes = flatNodes.concat(flattenNodes((<AjfContainerNode>node).nodes));\n    }\n    flatNodes.push(node);\n  });\n\n  return flatNodes;\n}\n\nfunction getDescendants(\n    flatNodes: AjfNode[], parentNode: AjfNode, branch: number|null = null): AjfNode[] {\n  return branch != null ?\n      flatNodes.filter(n => n.parent === parentNode.id && n.parentNode === branch) :\n      flatNodes.filter(n => n.parent === parentNode.id);\n}\n\nfunction removeNodes(nodes: AjfNode[], ids: number[]): AjfNode[] {\n  const len = nodes.length;\n  for (let i = 0; i < len; i++) {\n    const node = nodes[i];\n    if (isContainerNode(node)) {\n      const container = (<AjfContainerNode>node);\n      container.nodes = removeNodes(container.nodes, ids);\n    }\n  }\n  return nodes.filter(n => ids.indexOf(n.id) === -1);\n}\n\nfunction deleteNodeSubtree(\n    nodes: AjfNode[], parentNode: AjfNode, branch: number|null = null): AjfNode[] {\n  const flatNodes = flattenNodes(nodes);\n  let delNodes: AjfNode[] = [];\n  let descendants = getDescendants(flatNodes, parentNode, branch);\n  const len = descendants.length;\n  for (let i = 0; i < len; i++) {\n    delNodes = delNodes.concat(getDescendants(flatNodes, descendants[i]));\n  }\n  delNodes = delNodes.concat(descendants);\n  return removeNodes(nodes, delNodes.map(n => n.id));\n}\n\nlet nodeUniqueId = 0;\n\n\n@Injectable()\nexport class AjfFormBuilderService {\n  private _availableNodeTypes: AjfFormBuilderNodeTypeEntry[] = [\n    {\n      label: 'Slide',\n      icon: {fontSet: 'ajf-icon', fontIcon: 'field-slide'},\n      nodeType: {node: AjfNodeType.AjfSlide},\n      isSlide: true\n    },\n    {\n      label: 'Repeating slide',\n      icon: {fontSet: 'ajf-icon', fontIcon: 'field-repeatingslide'},\n      nodeType: {node: AjfNodeType.AjfRepeatingSlide},\n      isSlide: true\n    },\n    {\n      label: 'String',\n      icon: {fontSet: 'ajf-icon', fontIcon: 'field-string'},\n      nodeType: {node: AjfNodeType.AjfField, field: AjfFieldType.String}\n    },\n    {\n      label: 'Text',\n      icon: {fontSet: 'ajf-icon', fontIcon: 'field-text'},\n      nodeType: {node: AjfNodeType.AjfField, field: AjfFieldType.Text}\n    },\n    {\n      label: 'Number',\n      icon: {fontSet: 'ajf-icon', fontIcon: 'field-number'},\n      nodeType: {node: AjfNodeType.AjfField, field: AjfFieldType.Number}\n    },\n    {\n      label: 'Boolean',\n      icon: {fontSet: 'ajf-icon', fontIcon: 'field-boolean'},\n      nodeType: {node: AjfNodeType.AjfField, field: AjfFieldType.Boolean}\n    },\n    {\n      label: 'Single choice',\n      icon: {fontSet: 'ajf-icon', fontIcon: 'field-singlechoice'},\n      nodeType: {node: AjfNodeType.AjfField, field: AjfFieldType.SingleChoice}\n    },\n    {\n      label: 'Multiple choice',\n      icon: {fontSet: 'ajf-icon', fontIcon: 'field-multiplechoice'},\n      nodeType: {node: AjfNodeType.AjfField, field: AjfFieldType.MultipleChoice}\n    },\n    {\n      label: 'Formula',\n      icon: {fontSet: 'ajf-icon', fontIcon: 'field-formula'},\n      nodeType: {node: AjfNodeType.AjfField, field: AjfFieldType.Formula}\n    },\n    {\n      label: 'Date',\n      icon: {fontSet: 'ajf-icon', fontIcon: 'field-date'},\n      nodeType: {node: AjfNodeType.AjfField, field: AjfFieldType.Date}\n    },\n    {\n      label: 'Date input',\n      icon: {fontSet: 'ajf-icon', fontIcon: 'field-dateinput'},\n      nodeType: {node: AjfNodeType.AjfField, field: AjfFieldType.DateInput}\n    },\n    {\n      label: 'Time',\n      icon: {fontSet: 'ajf-icon', fontIcon: 'field-time'},\n      nodeType: {node: AjfNodeType.AjfField, field: AjfFieldType.Time}\n    },\n    {\n      label: 'Table',\n      icon: {fontSet: 'ajf-icon', fontIcon: 'field-table'},\n      nodeType: {node: AjfNodeType.AjfField, field: AjfFieldType.Table}\n    }\n  ];\n  /**\n   * Available node types\n   *\n   * @readonly\n   * @memberOf AjfFormBuilderService\n   */\n  get availableNodeTypes(): AjfFormBuilderNodeTypeEntry[] {\n    return this._availableNodeTypes;\n  }\n\n  private _form: BehaviorSubject<AjfForm|null> = new BehaviorSubject<AjfForm|null>(null);\n  private _formObs: Observable<AjfForm|null> = this._form as Observable<AjfForm|null>;\n\n  /**\n   * Current edited form stream\n   *\n   * @readonly\n   * @memberOf AjfFormBuilderService\n   */\n  get form(): Observable<AjfForm|null> {\n    return this._formObs;\n  }\n\n  private _attachmentsOrigins: Observable<AjfAttachmentsOrigin<any>[]>;\n  get attachmentsOrigins(): Observable<AjfAttachmentsOrigin<any>[]> {\n    return this._attachmentsOrigins;\n  }\n\n  private _choicesOrigins: Observable<AjfChoicesOrigin<any>[]>;\n  get choicesOrigins(): Observable<AjfChoicesOrigin<any>[]> {\n    return this._choicesOrigins;\n  }\n\n  private _stringIdentifier: Observable<AjfFormStringIdentifier[]>;\n  get stringIdentifier(): Observable<AjfFormStringIdentifier[]> {\n    return this._stringIdentifier;\n  }\n\n  private _nodesWithoutChoiceOrigins: Observable<AjfSlide[]>;\n  private _nodes: Observable<AjfNode[]>;\n  get nodes(): Observable<AjfNode[]> {\n    return this._nodes;\n  }\n\n  private _flatNodes: Observable<AjfNode[]>;\n  get flatNodes(): Observable<AjfNode[]> {\n    return this._flatNodes;\n  }\n\n  private _flatFields: Observable<AjfField[]>;\n  get flatFields(): Observable<AjfField[]> {\n    return this._flatFields;\n  }\n\n  private _nodeEntriesTree: Observable<AjfFormBuilderNodeEntry[]>;\n  get nodeEntriesTree(): Observable<AjfFormBuilderNodeEntry[]> {\n    return this._nodeEntriesTree;\n  }\n\n  /**\n   * A list of the ids of the dropLists connected to the source list.\n   */\n  private _connectedDropLists: BehaviorSubject<string[]> = new BehaviorSubject<string[]>([]);\n  get connectedDropLists(): BehaviorSubject<string[]> {\n    return this._connectedDropLists;\n  }\n\n  private _editedNodeEntry: BehaviorSubject<AjfFormBuilderNodeEntry|null> =\n      new BehaviorSubject<AjfFormBuilderNodeEntry|null>(null);\n  private _editedNodeEntryObs: Observable<AjfFormBuilderNodeEntry|null> =\n      this._editedNodeEntry as Observable<AjfFormBuilderNodeEntry|null>;\n  get editedNodeEntry(): Observable<AjfFormBuilderNodeEntry|null> {\n    return this._editedNodeEntryObs;\n  }\n\n  private _editedCondition: BehaviorSubject<AjfCondition|null> =\n      new BehaviorSubject<AjfCondition|null>(null);\n  private _editedConditionObs: Observable<AjfCondition|null> =\n      this._editedCondition as Observable<AjfCondition|null>;\n  get editedCondition(): Observable<AjfCondition|null> {\n    return this._editedConditionObs;\n  }\n\n  private _editedChoicesOrigin: BehaviorSubject<AjfChoicesOrigin<any>|null> =\n      new BehaviorSubject<AjfChoicesOrigin<any>|null>(null);\n  private _editedChoicesOriginObs: Observable<AjfChoicesOrigin<any>|null> =\n      this._editedChoicesOrigin as Observable<AjfChoicesOrigin<any>|null>;\n  get editedChoicesOrigin(): Observable<AjfChoicesOrigin<any>|null> {\n    return this._editedChoicesOriginObs;\n  }\n\n  private _beforeNodesUpdate: EventEmitter<void> = new EventEmitter<void>();\n  private _beforeNodesUpdateObs: Observable<void> = this._beforeNodesUpdate as Observable<void>;\n  get beforeNodesUpdate(): Observable<void> {\n    return this._beforeNodesUpdateObs;\n  }\n  private _afterNodeUpdate: EventEmitter<void> = new EventEmitter<void>();\n  private _afterNodeUpdateObs: Observable<void> = this._afterNodeUpdate as Observable<void>;\n  get afterNodeUpdate(): Observable<void> {\n    return this._afterNodeUpdateObs;\n  }\n\n  private _nodesUpdates: Subject<AjfNodesOperation> = new Subject<AjfNodesOperation>();\n  private _attachmentsOriginsUpdates: Subject<AjfAttachmentsOriginsOperation> =\n      new Subject<AjfAttachmentsOriginsOperation>();\n  private _choicesOriginsUpdates: Subject<AjfChoicesOriginsOperation> =\n      new Subject<AjfChoicesOriginsOperation>();\n  private _stringIdentifierUpdates: Subject<AjfFormStringIdentifierOperation> =\n      new Subject<AjfFormStringIdentifierOperation>();\n\n  private _saveNodeEntryEvent: EventEmitter<any> = new EventEmitter<any>();\n  private _deleteNodeEntryEvent: EventEmitter<AjfFormBuilderNodeEntry> =\n      new EventEmitter<AjfFormBuilderNodeEntry>();\n  /**\n   * Event fired when the position of a node in a tree changes.\n   */\n  private _moveNodeEntryEvent: EventEmitter<AjfFormBuilderMoveEvent> =\n      new EventEmitter<AjfFormBuilderMoveEvent>();\n\n  /**\n   * Subscribes to the moveNodeEntryEvent event emitter;\n   */\n  private _moveNodeSub: Subscription = Subscription.EMPTY;\n\n  constructor() {\n    this._initChoicesOriginsStreams();\n    this._initAttachmentsOriginsStreams();\n    this._initStringIdentifierStreams();\n    this._initNodesStreams();\n    this._initFormStreams();\n    this._initSaveNode();\n    this._initMoveNode();\n    this._initDeleteNode();\n  }\n\n  /**\n   * Sets the current edited form\n   *\n   * @param form\n   *\n   * @memberOf AjfFormBuilderService\n   */\n  setForm(form: AjfForm|null): void {\n    if (form !== this._form.getValue()) {\n      this._form.next(form);\n    }\n  }\n\n  editNodeEntry(nodeEntry: AjfFormBuilderNodeEntry): void {\n    this._editedNodeEntry.next(nodeEntry);\n  }\n\n  editCondition(condition: AjfCondition): void {\n    this._editedCondition.next(condition);\n  }\n\n  saveCurrentCondition(condition: string): void {\n    let c = this._editedCondition.getValue();\n    if (c == null) {\n      return;\n    }\n    c.condition = condition;\n    this._editedCondition.next(null);\n  }\n\n  cancelConditionEdit(): void {\n    this._editedChoicesOrigin.next(null);\n  }\n\n  assignListId(node: AjfNode, empty: boolean = false): string {\n    if (node.nodeType === AjfNodeType.AjfSlide || node.nodeType === AjfNodeType.AjfRepeatingSlide) {\n      const listId = empty ? `empty_fields_list_${node.id}` : `fields_list_${node.id}`;\n      if (this._connectedDropLists.value.indexOf(listId) == -1) {\n        this._connectDropList(listId);\n      }\n      return listId;\n    }\n    return '';\n  }\n\n  insertNode(\n      nodeType: AjfFormBuilderNodeTypeEntry, parent: AjfNode, parentNode: number, inContent = false,\n      insertInIndex = 0): void {\n    let node: AjfNode|AjfField;\n    const id = ++nodeUniqueId;\n    const isFieldNode = nodeType.nodeType?.field != null;\n    if (isFieldNode) {\n      node = createField({\n        id,\n        nodeType: AjfNodeType.AjfField,\n        fieldType: nodeType.nodeType.field!,\n        parent: parent.id,\n        parentNode,\n        name: '',\n      });\n    } else {\n      node = createContainerNode({\n        id,\n        nodeType: nodeType.nodeType.node,\n        parent: 0,\n        parentNode,\n        name: '',\n        nodes: [],\n      });\n    }\n    this._beforeNodesUpdate.emit();\n    this._nodesUpdates.next((nodes: AjfNode[]): AjfNode[] => {\n      const cn = isContainerNode(parent) && inContent ?\n          (<AjfContainerNode>parent) :\n          getNodeContainer({nodes}, parent) as AjfContainerNode;\n      if (!isFieldNode) {\n        let newNodes = nodes.slice(0);\n        newNodes.splice(insertInIndex, 0, node);\n        newNodes = this._updateNodesList(0, newNodes);\n        return newNodes;\n      } else {\n        let newNodes = cn.nodes.slice(0);\n        newNodes.splice(insertInIndex, 0, node);\n        newNodes = this._updateNodesList(cn.id, newNodes);\n        cn.nodes = newNodes;\n      }\n      return nodes;\n    });\n  }\n\n  saveNodeEntry(properties: any): void {\n    this._saveNodeEntryEvent.emit(properties);\n  }\n\n  cancelNodeEntryEdit(): void {\n    this._editedNodeEntry.next(null);\n  }\n\n  deleteNodeEntry(nodeEntry: AjfFormBuilderNodeEntry): void {\n    this._deleteNodeEntryEvent.next(nodeEntry);\n  }\n\n  /**\n   * Triggers the moveNode event when a node is moved in the formbuilder.\n   * @param nodeEntry The node to be moved.\n   */\n  moveNodeEntry(nodeEntry: AjfFormBuilderNodeEntry, from: number, to: number): void {\n    const moveEvent: AjfFormBuilderMoveEvent = {nodeEntry: nodeEntry, fromIndex: from, toIndex: to};\n    this._moveNodeEntryEvent.next(moveEvent);\n  }\n\n  getCurrentForm(): Observable<AjfForm> {\n    return combineLatest([\n             this.form, this._nodesWithoutChoiceOrigins, this.attachmentsOrigins,\n             this.choicesOrigins, this.stringIdentifier\n           ])\n        .pipe(\n            filter(([form]) => form != null),\n            map(([form, nodes, attachmentsOrigins, choicesOrigins, stringIdentifier]) => {\n              return createForm({\n                choicesOrigins: (choicesOrigins as AjfChoicesOrigin<any>[]).slice(0),\n                attachmentsOrigins: (attachmentsOrigins as AjfAttachmentsOrigin<any>[]).slice(0),\n                stringIdentifier: ((stringIdentifier || []) as AjfFormStringIdentifier[]).slice(0),\n                nodes: (nodes as AjfSlide[]).slice(0),\n                supplementaryInformations: (form as AjfForm).supplementaryInformations,\n              });\n            }));\n  }\n\n  editChoicesOrigin(choicesOrigin: AjfChoicesOrigin<any>): void {\n    this._editedChoicesOrigin.next(choicesOrigin);\n  }\n\n  createChoicesOrigin(): void {\n    this._editedChoicesOrigin.next(createChoicesFixedOrigin<any>({name: ''}));\n  }\n\n  cancelChoicesOriginEdit(): void {\n    this._editedChoicesOrigin.next(null);\n  }\n\n  saveChoicesOrigin(params: {label: string, name: string, choices: any[]}): void {\n    const choicesOrigin = this._editedChoicesOrigin.getValue();\n    if (choicesOrigin != null) {\n      choicesOrigin.label = params.label;\n      choicesOrigin.name = params.name;\n      if (isChoicesFixedOrigin(choicesOrigin)) {\n        choicesOrigin.choices = params.choices;\n      }\n      this._choicesOriginsUpdates.next((choicesOrigins) => {\n        const idx = choicesOrigins.indexOf(choicesOrigin);\n        if (idx > -1) {\n          choicesOrigins = [\n            ...choicesOrigins.slice(0, idx),\n            choicesOrigin,\n            ...choicesOrigins.slice(idx + 1),\n          ];\n        } else {\n          choicesOrigins = [...choicesOrigins, choicesOrigin];\n        }\n        return choicesOrigins;\n      });\n    }\n    this._editedChoicesOrigin.next(null);\n  }\n\n  saveStringIdentifier(identifier: AjfFormStringIdentifier[]): void {\n    this._stringIdentifierUpdates.next(() => [...identifier]);\n  }\n\n  private _buildFormBuilderNodesTree(nodes: AjfNode[]): (AjfFormBuilderNode|null)[] {\n    this._updateNodesList(0, nodes);\n    const rootNodes = nodes.filter(\n        n => n.nodeType == AjfNodeType.AjfSlide || n.nodeType == AjfNodeType.AjfRepeatingSlide);\n    if (rootNodes.length === 0) {\n      return [null];\n    }\n    const rootNode = rootNodes[0];\n    if (isSlidesNode(rootNode)) {\n      const tree: AjfFormBuilderNode[] = [];\n      tree.push(<AjfFormBuilderNodeEntry>{\n        node: rootNode,\n        container: null,\n        children: buildFormBuilderNodesSubtree(nodes, rootNode),\n        content: buildFormBuilderNodesContent(nodes, rootNode)\n      });\n      return tree;\n    }\n    throw new Error('Invalid form definition');\n  }\n\n  /**\n   * Adds the id of a dropList to be connected with the FormBuilder source list.\n   * @param listId The id of the list to connect.\n   */\n  private _connectDropList(listId: string) {\n    let connectedLists = this._connectedDropLists.value.slice(0);\n    this._connectedDropLists.next([...connectedLists, listId]);\n  }\n\n  private _findMaxNodeId(nodes: AjfNode[], _curMaxId = 0): number {\n    let maxId = 0;\n    nodes.forEach((n) => {\n      maxId = Math.max(maxId, n.id);\n      if (isContainerNode(n)) {\n        maxId = Math.max(maxId, this._findMaxNodeId((<AjfContainerNode>n).nodes));\n      }\n    });\n    return maxId;\n  }\n\n  private _initFormStreams(): void {\n    this._form.subscribe((form: AjfForm|null) => {\n      nodeUniqueId = 0;\n      if (form != null && form.nodes != null && form.nodes.length > 0) {\n        nodeUniqueId = this._findMaxNodeId(form.nodes);\n      }\n      this._nodesUpdates.next((_nodes: AjfNode[]): AjfNode[] => {\n        return form != null && form.nodes != null ? form.nodes.slice(0) : [];\n      });\n      this._attachmentsOriginsUpdates.next(\n          (_attachmentsOrigins: AjfAttachmentsOrigin<any>[]): AjfAttachmentsOrigin<any>[] => {\n            return form != null && form.attachmentsOrigins != null ?\n                form.attachmentsOrigins.slice(0) :\n                [];\n          });\n      this._choicesOriginsUpdates.next(\n          (_choicesOrigins: AjfChoicesOrigin<any>[]): AjfChoicesOrigin<any>[] => {\n            return form != null && form.choicesOrigins != null ? form.choicesOrigins.slice(0) : [];\n          });\n      this._stringIdentifierUpdates.next(\n          (_: AjfFormStringIdentifier[]): AjfFormStringIdentifier[] => {\n            return form != null && form.stringIdentifier != null ? form.stringIdentifier.slice(0) :\n                                                                   [];\n          });\n    });\n  }\n\n  private _initChoicesOriginsStreams(): void {\n    this._choicesOrigins =\n        (<Observable<AjfChoicesOriginsOperation>>this._choicesOriginsUpdates)\n            .pipe(\n                scan((choicesOrigins: AjfChoicesOrigin<any>[], op: AjfChoicesOriginsOperation) => {\n                  return op(choicesOrigins);\n                }, []), publishReplay(1), refCount());\n  }\n\n  private _initAttachmentsOriginsStreams(): void {\n    this._attachmentsOrigins = this._attachmentsOriginsUpdates.pipe(\n        scan(\n            (attachmentsOrigins: AjfAttachmentsOrigin<any>[],\n             op: AjfAttachmentsOriginsOperation) => {\n              return op(attachmentsOrigins);\n            },\n            []),\n        publishReplay(1),\n        refCount(),\n    );\n  }\n\n  private _initStringIdentifierStreams(): void {\n    this._stringIdentifier = this._stringIdentifierUpdates.pipe(\n        scan(\n            (stringIdentifier: AjfFormStringIdentifier[], op: AjfFormStringIdentifierOperation) => {\n              return op(stringIdentifier);\n            },\n            []),\n        publishReplay(1),\n        refCount(),\n    );\n  }\n\n  private _initNodesStreams(): void {\n    this._nodes = (<Observable<AjfNodesOperation>>this._nodesUpdates)\n                      .pipe(\n                          scan(\n                              (nodes: AjfNode[], op: AjfNodesOperation) => {\n                                return op(nodes);\n                              },\n                              []),\n                          publishReplay(1),\n                          refCount(),\n                      );\n\n    this._nodesWithoutChoiceOrigins =\n        (this._nodes as Observable<AjfSlide[]>).pipe(map(slides => slides.map(slide => {\n          slide.nodes = (slide.nodes as AjfField[]).map((node: AjfField) => {\n            if (isFieldWithChoices(node)) {\n              const fwc = deepCopy(node);\n              if (fwc && fwc.choices) {\n                delete fwc.choices;\n              }\n              if (fwc && fwc.choicesOrigin) {\n                delete fwc.choicesOrigin;\n              }\n              return fwc;\n            }\n            return node;\n          });\n          return slide;\n        })));\n\n    this._flatNodes = this._nodes.pipe(\n        map((nodes: AjfNode[]) => flattenNodes(nodes)), publishReplay(1), refCount());\n\n    this._flatFields = this._flatNodes.pipe(\n        map((nodes: AjfNode[]) => <AjfField[]>nodes.filter(n => !isContainerNode(n))),\n        publishReplay(1), refCount());\n\n    this._nodeEntriesTree = this._nodes.pipe(\n        map(nodes => <AjfFormBuilderNodeEntry[]>this._buildFormBuilderNodesTree(nodes)),\n        publishReplay(1),\n        refCount(),\n    );\n  }\n\n  private _initSaveNode(): void {\n    this._saveNodeEntryEvent\n        .pipe(\n            withLatestFrom(this.editedNodeEntry, this.choicesOrigins, this.attachmentsOrigins),\n            filter(([_, nodeEntry]) => nodeEntry != null),\n            map(([properties, ne]) => {\n              this._beforeNodesUpdate.emit();\n              const nodeEntry = ne as AjfFormBuilderNodeEntry;\n              const origNode = nodeEntry.node;\n              const node = deepCopy(origNode);\n              node.id = nodeEntry.node.id;\n              node.name = properties.name;\n              node.label = properties.label;\n              node.visibility = properties.visibility != null ?\n                  createCondition({condition: properties.visibility}) :\n                  null;\n\n              const oldConditionalBranches = node.conditionalBranches.length;\n              node.conditionalBranches = properties.conditionalBranches != null ?\n                  properties.conditionalBranches.map(\n                      (condition: string) => createCondition({condition})) :\n                  [alwaysCondition()];\n              const newConditionalBranches = node.conditionalBranches.length;\n\n              if (isRepeatingContainerNode(node)) {\n                const repNode = <AjfRepeatingContainerNode>node;\n                repNode.formulaReps = properties.formulaReps != null ?\n                    createFormula({formula: properties.formulaReps}) :\n                    undefined;\n                repNode.minReps = properties.minReps;\n                repNode.maxReps = properties.maxReps;\n              }\n\n              if (isField(node)) {\n                const field = node as AjfField;\n                field.description = properties.description;\n                field.defaultValue = properties.defaultValue;\n                field.formula = properties.formula != null ?\n                    createFormula({formula: properties.formula}) :\n                    undefined;\n                const forceValue = properties.value;\n                const notEmpty = properties.notEmpty;\n                const validationConditions = properties.validationConditions;\n                let minValue: number|null = parseInt(properties.minValue, 10);\n                let maxValue: number|null = parseInt(properties.maxValue, 10);\n                let minDigits: number|null = parseInt(properties.minDigits, 10);\n                let maxDigits: number|null = parseInt(properties.maxDigits, 10);\n                if (isNaN(minValue)) {\n                  minValue = null;\n                }\n                if (isNaN(maxValue)) {\n                  maxValue = null;\n                }\n                if (isNaN(minDigits)) {\n                  minDigits = null;\n                }\n                if (isNaN(maxDigits)) {\n                  maxDigits = null;\n                }\n                if (forceValue != null || notEmpty != null ||\n                    (validationConditions != null && validationConditions.length > 0) ||\n                    minValue != null || maxValue != null || minDigits != null ||\n                    maxDigits != null) {\n                  const validation = field.validation || createValidationGroup({});\n                  validation.forceValue = forceValue;\n                  validation.notEmpty = notEmpty ? notEmptyValidation() : undefined;\n                  validation.minValue = minValue != null ? minValidation(minValue) : undefined;\n                  validation.maxValue = maxValue != null ? maxValidation(maxValue) : undefined;\n                  validation.minDigits =\n                      minDigits != null ? minDigitsValidation(minDigits) : undefined;\n                  validation.maxDigits =\n                      maxDigits != null ? maxDigitsValidation(maxDigits) : undefined;\n                  validation.conditions =\n                      (validationConditions ||\n                       []).map((c: {condition: string, errorMessage: string}) => createValidation({\n                                 condition: c.condition,\n                                 errorMessage: c.errorMessage\n                               }));\n                  field.validation = validation;\n                } else {\n                  field.validation = undefined;\n                }\n                const notEmptyWarn = properties.notEmptyWarning;\n                const warningConditions = properties.warningConditions;\n                if (notEmptyWarn != null ||\n                    (warningConditions != null && warningConditions.length > 0)) {\n                  const warning = field.warning || createWarningGroup({});\n                  warning.notEmpty = notEmptyWarn ? notEmptyWarning() : undefined;\n                  warning.conditions =\n                      (warningConditions ||\n                       []).map((w: {condition: string, warningMessage: string}) => createWarning({\n                                 condition: w.condition,\n                                 warningMessage: w.warningMessage\n                               }));\n                  field.warning = warning;\n                } else {\n                  field.warning = undefined;\n                }\n                field.nextSlideCondition = properties.nextSlideCondition != null ?\n                    createCondition({condition: properties.nextSlideCondition}) :\n                    undefined;\n                field.size = properties.size;\n                field.defaultValue = properties.defaultValue;\n\n                if (isFieldWithChoices(field)) {\n                  const fwc = <AjfFieldWithChoices<any>>field;\n                  (fwc as any).choicesOriginRef = properties.choicesOriginRef;\n                  fwc.forceExpanded = properties.forceExpanded;\n                  fwc.forceNarrow = properties.forceNarrow;\n                  fwc.triggerConditions = (properties.triggerConditions ||\n                                           []).map((t: string) => createCondition({condition: t}));\n                }\n              }\n\n              this._editedNodeEntry.next(null);\n\n              return (nodes: AjfNode[]): AjfNode[] => {\n                let cn = getNodeContainer({nodes}, origNode);\n                if (cn != null) {\n                  // TODO: @trik check this, was always true?\n                  // if (cn instanceof AjfNode) {\n                  const replaceNodes = cn.nodes === nodes;\n                  const idx = cn.nodes.indexOf(origNode);\n                  let newNodes = cn.nodes.slice(0, idx);\n                  newNodes.push(node);\n                  newNodes = newNodes.concat(cn.nodes.slice(idx + 1));\n                  cn.nodes = newNodes;\n                  if (replaceNodes) {\n                    nodes = newNodes;\n                  } else {\n                    nodes = nodes.slice(0);\n                  }\n                  // } else {\n                  //   const idx = nodes.indexOf(origNode);\n                  //   nodes = nodes.slice(0, idx).concat([node]).concat(nodes.slice(idx + 1));\n                  // }\n                  if (newConditionalBranches < oldConditionalBranches) {\n                    for (let i = newConditionalBranches; i < oldConditionalBranches; i++) {\n                      nodes = deleteNodeSubtree(nodes, node, i);\n                    }\n                  }\n                }\n                return nodes;\n              };\n            }),\n            )\n        .subscribe(this._nodesUpdates);\n  }\n\n  private _initDeleteNode(): void {\n    (<Observable<AjfFormBuilderNodeEntry>>this._deleteNodeEntryEvent)\n        .pipe(map((nodeEntry: AjfFormBuilderNodeEntry) => {\n          this._beforeNodesUpdate.emit();\n          return (nodes: AjfNode[]): AjfNode[] => {\n            const node = nodeEntry.node;\n            let cn = getNodeContainer({nodes}, node);\n            if (cn != null) {\n              const replaceNodes = cn.nodes === nodes;\n              const idx = cn.nodes.indexOf(node);\n              let newNodes = cn.nodes.slice(0, idx);\n              newNodes = newNodes.concat(cn.nodes.slice(idx + 1));\n              cn.nodes = newNodes;\n              if (replaceNodes) {\n                nodes = newNodes;\n              } else {\n                nodes = nodes.slice(0);\n              }\n            }\n            return nodes;\n          };\n        }))\n        .subscribe(this._nodesUpdates);\n  }\n\n  /**\n   * Initializes the subscription to the moveNodeEntryEvent.\n   */\n  private _initMoveNode(): void {\n    this._moveNodeSub.unsubscribe();\n    this._moveNodeSub =\n        this._moveNodeEntryEvent\n            .pipe(\n                map((moveEvent: AjfFormBuilderMoveEvent) => {\n                  this._beforeNodesUpdate.emit();\n                  return (nodes: AjfNode[]): AjfNode[] => {\n                    const nodeEntry = moveEvent.nodeEntry as AjfFormBuilderNodeEntry;\n                    const node = nodeEntry.node;\n                    let cn = getNodeContainer({nodes}, node) as AjfContainerNode;\n                    let newNodes: AjfNode[] = nodes;\n                    if (cn != null) {\n                      const replaceNodes = cn.nodes === nodes;\n                      newNodes = cn.nodes;\n                      moveItemInArray(newNodes, moveEvent.fromIndex, moveEvent.toIndex);\n                      newNodes = this._updateNodesList(cn.id, newNodes);\n                      cn.nodes = newNodes;\n                      if (replaceNodes) {\n                        nodes = newNodes;\n                      } else {\n                        nodes = nodes.slice(0);\n                      }\n                    }\n                    return nodes;\n                  };\n                }),\n                )\n            .subscribe(this._nodesUpdates);\n  }\n\n  /**\n   * Updates the \"id\" and \"parent\" fields of a modified or rearranged list of nodes.\n   * @param containerId The id of the parent container of the list.\n   * @param nodesList The list of nodes to be updated.\n   */\n  private _updateNodesList(containerId: number, nodesList: AjfNode[]): AjfNode[] {\n    if (!nodesList.length) {\n      return [];\n    }\n    const contId = containerId != undefined ? containerId : 0;\n    for (let idx = 0; idx < nodesList.length; idx++) {\n      let currentNode = nodesList[idx];\n      currentNode.id = (contId * 1000) + idx + 1;\n      currentNode.parent = idx == 0 ? contId : (contId * 1000) + idx;\n      if (currentNode.nodeType == AjfNodeType.AjfSlide ||\n          currentNode.nodeType == AjfNodeType.AjfRepeatingSlide) {\n        const currentSlide = currentNode as AjfSlide;\n        if (currentSlide.nodes) {\n          this._updateNodesList(currentSlide.id, currentSlide.nodes);\n        }\n      }\n    }\n    return nodesList;\n  }\n}\n","/**\n * @license\n * Copyright (C) Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {AjfChoicesOrigin} from '@ajf/core/forms';\nimport {ChangeDetectionStrategy, Component, ViewChild, ViewEncapsulation} from '@angular/core';\nimport {Observable} from 'rxjs';\nimport {filter, map} from 'rxjs/operators';\n\nimport {AjfFbChoicesOriginEditor} from './choices-origin-editor';\nimport {AjfFormBuilderService} from './form-builder-service';\n\n\n@Component({\n  selector: 'ajf-fb-choices-origin-editor-dialog',\n  templateUrl: 'choices-origin-editor-dialog.html',\n  styleUrls: ['choices-origin-editor-dialog.css'],\n  encapsulation: ViewEncapsulation.None,\n  changeDetection: ChangeDetectionStrategy.OnPush\n})\nexport class AjfFbChoicesOriginEditorDialog {\n  @ViewChild(AjfFbChoicesOriginEditor, {static: false}) editor: AjfFbChoicesOriginEditor;\n\n  private _choicesOrigin: Observable<AjfChoicesOrigin<any>>;\n  get choicesOrigin(): Observable<AjfChoicesOrigin<any>> {\n    return this._choicesOrigin;\n  }\n\n  constructor(private _service: AjfFormBuilderService) {\n    this._choicesOrigin =\n        this._service.editedChoicesOrigin.pipe(filter(c => c != null), map(c => c!));\n  }\n\n  saveChoicesOrigin(): void {\n    this._service.saveChoicesOrigin(\n        {label: this.editor.label, name: this.editor.name, choices: this.editor.choicesArr});\n  }\n\n  cancelChoicesOriginEdit(): void {\n    this._service.cancelChoicesOriginEdit();\n  }\n}\n","/**\n * @license\n * Copyright (C) Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {AjfField, AjfFieldType, AjfValidationService} from '@ajf/core/forms';\nimport {AjfExpressionUtils} from '@ajf/core/models';\nimport {AjfMonacoEditor} from '@ajf/material/monaco-editor';\nimport {\n  ChangeDetectionStrategy,\n  Component,\n  Input,\n  ViewChild,\n  ViewEncapsulation\n} from '@angular/core';\n\ndeclare var monaco: any;\n\n@Component({\n  selector: 'ajf-condition-editor',\n  templateUrl: 'fb-condition-editor.html',\n  styleUrls: ['fb-condition-editor.css'],\n  changeDetection: ChangeDetectionStrategy.OnPush,\n  encapsulation: ViewEncapsulation.None\n})\nexport class AjfFbConditionEditor {\n  @ViewChild(AjfMonacoEditor, {static: true}) monacoEditor: AjfMonacoEditor;\n\n  private _fields: AjfField[];\n  get fields(): AjfField[] {\n    return this._fields;\n  }\n  @Input()\n  set fields(fields: AjfField[]) {\n    this._fields = fields;\n    this._updateVariables();\n  }\n  @Input() condition: string;\n\n  editedValue: string;\n\n  constructor(_: AjfValidationService) {}\n\n  insertVariable(variable: string): void {\n    if (this.monacoEditor != null && this.monacoEditor.editor != null) {\n      const editor = this.monacoEditor.editor;\n      let value: string[] = editor.getValue().split('\\n');\n      let position: {column: number, lineNumber: number} = editor.getPosition();\n      const ln = position.lineNumber - 1;\n      let line = value[ln];\n      let col = position.column - 1;\n      line = line.substring(0, col) + variable + line.substring(col);\n      value[ln] = line;\n      position.column += variable.length;\n      this.monacoEditor.value = value.join('\\n');\n      editor.setPosition(position);\n      editor.focus();\n      this.editedValue = editor.getValue();\n    }\n  }\n\n  onEditorInit(): void {\n    monaco.languages.typescript.javascriptDefaults.setDiagnosticsOptions(\n        {noSemanticValidation: false, noSyntaxValidation: false});\n\n    monaco.languages.typescript.javascriptDefaults.setCompilerOptions({\n      target: monaco.languages.typescript.ScriptTarget.ES2015,\n      allowNonTsExtensions: true,\n      allowJs: true,\n      module: monaco.languages.typescript.ModuleKind.None\n    });\n\n    try {\n      monaco.languages.typescript.javascriptDefaults.addExtraLib(\n          '', 'condition-editor-variables.d.ts');\n    } catch (e) {\n      monaco.languages.typescript.javascriptDefaults._extraLibs['condition-editor-variables.d.ts'] =\n          '';\n    }\n\n    try {\n      monaco.languages.typescript.javascriptDefaults.addExtraLib(\n          '', 'condition-editor-functions.d.ts');\n    } catch (e) {\n      monaco.languages.typescript.javascriptDefaults._extraLibs['condition-editor-functions.d.ts'] =\n          '';\n    }\n\n    this._updateVariables();\n    this._updateFunctions();\n  }\n\n  private _updateVariables(): void {\n    if (this._fields == null) {\n      return;\n    }\n    try {\n      monaco.languages.typescript.javascriptDefaults._extraLibs['condition-editor-variables.d.ts'] =\n          this._fields\n              .map((field: AjfField) => {\n                return `declare const ${field.name}: ${this._fieldVarType(field.fieldType)};`;\n              })\n              .join('\\n');\n    } catch (e) {\n    }\n  }\n\n  private _updateFunctions(): void {\n    try {\n      monaco.languages.typescript.javascriptDefaults._extraLibs['condition-editor-functions.d.ts'] =\n          AjfExpressionUtils.UTIL_FUNCTIONS;\n    } catch (e) {\n    }\n  }\n\n  private _fieldVarType(fieldType: AjfFieldType): string|null {\n    switch (fieldType) {\n      case AjfFieldType.Boolean:\n        return 'boolean';\n      case AjfFieldType.Date:\n      case AjfFieldType.DateInput:\n      case AjfFieldType.Time:\n        return 'Date';\n      case AjfFieldType.Empty:\n        return 'void';\n      case AjfFieldType.Formula:\n        return 'number';\n      case AjfFieldType.MultipleChoice:\n      case AjfFieldType.SingleChoice:\n        return 'any';\n      case AjfFieldType.Number:\n        return 'number';\n      case AjfFieldType.Table:\n        return 'Array';\n      case AjfFieldType.String:\n      case AjfFieldType.Text:\n        return 'string';\n    }\n    return null;\n  }\n}\n","/**\n * @license\n * Copyright (C) Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {AjfField} from '@ajf/core/forms';\nimport {ChangeDetectionStrategy, Component, ViewChild, ViewEncapsulation} from '@angular/core';\nimport {MatDialogRef} from '@angular/material/dialog';\nimport {Observable} from 'rxjs';\nimport {map} from 'rxjs/operators';\n\nimport {AjfFbConditionEditor} from './condition-editor';\nimport {AjfFormBuilderService} from './form-builder-service';\n\n\n@Component({\n  selector: 'ajf-condition-editor-dialog',\n  templateUrl: 'condition-editor-dialog.html',\n  styleUrls: ['condition-editor-dialog.css'],\n  encapsulation: ViewEncapsulation.None,\n  changeDetection: ChangeDetectionStrategy.OnPush\n})\nexport class AjfFbConditionEditorDialog {\n  @ViewChild(AjfFbConditionEditor, {static: false}) editor: AjfFbConditionEditor;\n\n  private _fields: Observable<AjfField[]>;\n  get fields(): Observable<AjfField[]> {\n    return this._fields;\n  }\n\n  condition: string;\n\n  constructor(\n      service: AjfFormBuilderService, public dialogRef: MatDialogRef<AjfFbConditionEditorDialog>) {\n    this._fields = service.flatFields.pipe(\n        map((fields: AjfField[]) => fields.sort((f1, f2) => f1.name.localeCompare(f2.name))));\n  }\n\n  saveCondition(): void {\n    if (this.editor == null) {\n      return;\n    }\n    const newValue = this.editor.editedValue;\n    this.dialogRef.close(newValue);\n  }\n}\n","/**\n * @license\n * Copyright (C) Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {CdkDrag, CdkDragDrop} from '@angular/cdk/drag-drop';\nimport {\n  AjfFormBuilderEmptySlot,\n  AjfFormBuilderNode,\n  AjfFormBuilderNodeEntry,\n  AjfFormBuilderNodeTypeEntry,\n  AjfFormBuilderService,\n} from './form-builder-service';\n\n/**\n * Triggers when a field or slide node is moved or inserted by drag&dropping in the formbuilder.\n * @param event The drop event.\n * @param fbService The AjfFormBuilderService.\n * @param nodeEntry The current nodeEntry, if present.\n * @param content True if the current nodeEntry contains other nodeEntries.\n */\nexport function onDropProcess(\n    event: CdkDragDrop<AjfFormBuilderNodeEntry>|CdkDragDrop<AjfFormBuilderNodeTypeEntry>,\n    fbService: AjfFormBuilderService,\n    nodeEntry: AjfFormBuilderNode|null,\n    content = false,\n    ): void {\n  const itemData = event.item.data;\n  const containerId = event.container.id;\n  if (!itemData.node) {\n    if (nodeEntry == null && containerId === 'slides-list') {\n      fbService.insertNode(\n          itemData,\n          null as any,\n          0,\n          content,\n          event.currentIndex,\n      );\n      return;\n    }\n    const emptySlot = content ? {parent: (<AjfFormBuilderNodeEntry>nodeEntry).node, parentNode: 0} :\n                                <AjfFormBuilderEmptySlot>nodeEntry;\n    fbService.insertNode(\n        itemData as AjfFormBuilderNodeTypeEntry,\n        emptySlot.parent,\n        emptySlot.parentNode,\n        content,\n        event.currentIndex,\n    );\n    return;\n  }\n  const previousIndex = event.previousIndex;\n  const currentIndex = event.currentIndex;\n  fbService.moveNodeEntry(<AjfFormBuilderNodeEntry>event.item.data, previousIndex, currentIndex);\n}\n\n/**\n * Disables the drag&drop of Slide items.\n * @param item The dragged item.\n */\nexport function disableSlideDropPredicate(item: CdkDrag<AjfFormBuilderNodeTypeEntry>): boolean {\n  return !item.data.isSlide;\n}\n\n/**\n * Disables the drag&drop of Field items.\n * @param item The dragged item.\n */\nexport function disableFieldDropPredicate(item: CdkDrag<AjfFormBuilderNodeTypeEntry>): boolean {\n  if (!item.data.isSlide) {\n    return false;\n  }\n  return true;\n}\n","/**\n * @license\n * Copyright (C) Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {AjfFormStringIdentifier} from '@ajf/core/forms';\nimport {COMMA, ENTER} from '@angular/cdk/keycodes';\nimport {\n  ChangeDetectionStrategy,\n  ChangeDetectorRef,\n  Component,\n  OnDestroy,\n  ViewEncapsulation\n} from '@angular/core';\nimport {MatAutocompleteSelectedEvent} from '@angular/material/autocomplete';\nimport {MatChipInputEvent} from '@angular/material/chips';\nimport {MatTableDataSource} from '@angular/material/table';\nimport {Observable, Subscription} from 'rxjs';\nimport {map, shareReplay} from 'rxjs/operators';\n\nimport {AjfFormBuilderService} from './form-builder-service';\n\n@Component({\n  selector: 'ajf-fb-string-identifier-dialog',\n  templateUrl: 'string-identifier-dialog.html',\n  styleUrls: ['./string-identifier-dialog.css'],\n  changeDetection: ChangeDetectionStrategy.OnPush,\n  encapsulation: ViewEncapsulation.None,\n})\nexport class AjfFbStringIdentifierDialogComponent implements OnDestroy {\n  readonly dataSource: MatTableDataSource<AjfFormStringIdentifier> =\n      new MatTableDataSource<AjfFormStringIdentifier>();\n  readonly displayedColumns = ['label', 'value', 'show', 'delete'];\n  readonly fields$: Observable<string[]>;\n  readonly separatorKeysCodes: number[] = [ENTER, COMMA];\n\n  private _stringIdentifierSub: Subscription = Subscription.EMPTY;\n\n  constructor(private _service: AjfFormBuilderService, private _cdr: ChangeDetectorRef) {\n    this._stringIdentifierSub = _service.stringIdentifier.subscribe(identifier => {\n      this.dataSource.data = [...identifier];\n    });\n    this.fields$ = _service.flatFields.pipe(\n        map(fields => fields.sort((f1, f2) => f1.name.localeCompare(f2.name))\n                          .map(f => f.name)\n                          .filter(f => f.length > 0)),\n        shareReplay(1),\n    );\n  }\n\n  addRow(): void {\n    this.dataSource.data = [...this.dataSource.data, {label: '', value: [], show: undefined}];\n  }\n\n  deleteRow(rowIdx: number): void {\n    this.dataSource.data = [\n      ...this.dataSource.data.slice(0, rowIdx),\n      ...this.dataSource.data.slice(rowIdx + 1),\n    ];\n  }\n\n  addValue(row: AjfFormStringIdentifier, evt: MatChipInputEvent, valueInput: HTMLInputElement):\n      void {\n    if (evt.value.length === 0) {\n      return;\n    }\n    row.value = [...row.value, evt.value];\n    valueInput.value = '';\n    this._cdr.markForCheck();\n  }\n\n  removeValue(row: AjfFormStringIdentifier, value: string): void {\n    const idx = row.value.indexOf(value);\n    if (idx > -1) {\n      row.value = [\n        ...row.value.slice(0, idx),\n        ...row.value.slice(idx + 1),\n      ];\n      this._cdr.markForCheck();\n    }\n  }\n\n  ngOnDestroy(): void {\n    this._stringIdentifierSub.unsubscribe();\n  }\n\n  saveStringIdentifier(): void {\n    this._service.saveStringIdentifier(this.dataSource.data);\n  }\n\n  selected(row: AjfFormStringIdentifier, evt: MatAutocompleteSelectedEvent): void {\n    row.value = [...row.value, evt.option.value];\n    this._cdr.markForCheck();\n  }\n}\n","/**\n * @license\n * Copyright (C) Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {AjfChoicesOrigin, AjfForm} from '@ajf/core/forms';\nimport {AjfCondition} from '@ajf/core/models';\nimport {CdkDrag, CdkDragDrop} from '@angular/cdk/drag-drop';\nimport {\n  AfterContentInit,\n  AfterViewChecked,\n  ChangeDetectionStrategy,\n  Component,\n  ElementRef,\n  EventEmitter,\n  Input,\n  OnDestroy,\n  ViewChild,\n  ViewEncapsulation\n} from '@angular/core';\nimport {MatDialog, MatDialogRef} from '@angular/material/dialog';\nimport {MatSlideToggleChange} from '@angular/material/slide-toggle';\nimport {Observable, Subscription} from 'rxjs';\nimport {sample} from 'rxjs/operators';\n\nimport {AjfFbChoicesOriginEditorDialog} from './choices-origin-editor-dialog';\nimport {AjfFbConditionEditorDialog} from './condition-editor-dialog';\nimport {\n  AjfFormBuilderNodeEntry,\n  AjfFormBuilderNodeTypeEntry,\n  AjfFormBuilderService\n} from './form-builder-service';\nimport {disableFieldDropPredicate, onDropProcess} from './form-builder-utils';\nimport {AjfFbStringIdentifierDialogComponent} from './string-identifier-dialog';\n\n@Component({\n  selector: 'ajf-form-builder',\n  templateUrl: 'form-builder.html',\n  styleUrls: ['form-builder.css'],\n  changeDetection: ChangeDetectionStrategy.OnPush,\n  encapsulation: ViewEncapsulation.None\n})\nexport class AjfFormBuilder implements AfterViewChecked, AfterContentInit, OnDestroy {\n  @ViewChild('designer', {static: true}) designerCont: ElementRef;\n\n  private _form: AjfForm;\n  get form(): AjfForm {\n    return this._form;\n  }\n  @Input()\n  set form(form: AjfForm) {\n    if (this._form !== form) {\n      this._form = form;\n      if (this._init) {\n        this._setCurrentForm();\n      }\n    }\n  }\n\n  private _nodeTypes: AjfFormBuilderNodeTypeEntry[];\n  get nodeTypes(): AjfFormBuilderNodeTypeEntry[] {\n    return this._nodeTypes;\n  }\n\n  private _nodeEntriesTree: Observable<AjfFormBuilderNodeEntry[]>;\n  get nodeEntriesTree(): Observable<AjfFormBuilderNodeEntry[]> {\n    return this._nodeEntriesTree;\n  }\n\n  private _choicesOrigins: Observable<AjfChoicesOrigin<any>[]>;\n  get choicesOrigins(): Observable<AjfChoicesOrigin<any>[]> {\n    return this._choicesOrigins;\n  }\n\n  private _globalExpanded = false;\n  get isGlobalExpanded(): boolean {\n    return this._globalExpanded;\n  }\n\n  /**\n   * The list of the ids of all the dropLists connected to the formbuilder source list.\n   */\n  private _connectedDropLists: Observable<string[]> = this._service.connectedDropLists;\n  get connectedDropLists(): Observable<string[]> {\n    return this._connectedDropLists;\n  }\n\n  private _vc: EventEmitter<void> = new EventEmitter<void>();\n\n  private _init = false;\n  private _editConditionSub: Subscription = Subscription.EMPTY;\n  private _editConditionDialog: MatDialogRef<AjfFbConditionEditorDialog>|null;\n  private _beforeNodesUpdateSub: Subscription = Subscription.EMPTY;\n  private _editChoicesOriginSub: Subscription = Subscription.EMPTY;\n  private _editChoicesOriginDialog: MatDialogRef<AjfFbChoicesOriginEditorDialog>|null;\n  private _stringIdentifierDialog: MatDialogRef<AjfFbStringIdentifierDialogComponent>|null;\n  private _stringIdentifierSub: Subscription = Subscription.EMPTY;\n\n  private _lastScrollTop: number;\n\n  constructor(private _service: AjfFormBuilderService, private _dialog: MatDialog) {\n    this._nodeTypes = _service.availableNodeTypes;\n    this._nodeEntriesTree = _service.nodeEntriesTree;\n    this._choicesOrigins = _service.choicesOrigins;\n    this._editConditionSub =\n        this._service.editedCondition.subscribe((condition: AjfCondition|null) => {\n          if (this._editConditionDialog != null) {\n            this._editConditionDialog.close();\n            this._editConditionDialog = null;\n          }\n          if (condition != null) {\n            this._editConditionDialog =\n                this._dialog.open(AjfFbConditionEditorDialog, {disableClose: true});\n          }\n        });\n    this._editChoicesOriginSub =\n        this._service.editedChoicesOrigin.subscribe((choicesOrigin: AjfChoicesOrigin<any>|null) => {\n          if (this._editChoicesOriginDialog != null) {\n            this._editChoicesOriginDialog.close();\n            this._editChoicesOriginDialog = null;\n          }\n          if (choicesOrigin != null) {\n            this._editChoicesOriginDialog =\n                this._dialog.open(AjfFbChoicesOriginEditorDialog, {disableClose: true});\n          }\n        });\n\n    this._beforeNodesUpdateSub = this._service.beforeNodesUpdate.subscribe(() => {\n      if (this.designerCont == null) {\n        return;\n      }\n      this._lastScrollTop = this.designerCont.nativeElement.scrollTop;\n    });\n\n    this.nodeEntriesTree.pipe(sample((<Observable<void>>this._vc))).subscribe(() => {\n      if (this.designerCont == null) {\n        return;\n      }\n      this.designerCont.nativeElement.scrollTop = this._lastScrollTop;\n    });\n\n    this._stringIdentifierSub = this._service.stringIdentifier.subscribe(() => {});\n  }\n\n  ngAfterViewChecked(): void {\n    this._vc.emit();\n  }\n\n  ngAfterContentInit(): void {\n    this._setCurrentForm();\n    this._init = true;\n  }\n\n  ngOnDestroy(): void {\n    this._editConditionSub.unsubscribe();\n    this._beforeNodesUpdateSub.unsubscribe();\n    this._editChoicesOriginSub.unsubscribe();\n    this._stringIdentifierSub.unsubscribe();\n    this._service.setForm(null);\n  }\n\n  createChoicesOrigin(): void {\n    this._service.createChoicesOrigin();\n  }\n\n  disableDrop(): boolean {\n    return false;\n  }\n\n  disableFieldDrop(item: CdkDrag<AjfFormBuilderNodeTypeEntry>): boolean {\n    return disableFieldDropPredicate(item);\n  }\n\n  /**\n   * Triggers when a field or slide node is moved or inserted by drag&dropping in the formbuilder.\n   * @param event The drop event.\n   * @param content True if the current nodeEntry contains other nodeEntries.\n   */\n  onDrop(\n      event: CdkDragDrop<AjfFormBuilderNodeEntry>|CdkDragDrop<AjfFormBuilderNodeTypeEntry>,\n      content = false): void {\n    onDropProcess(event, this._service, null, content);\n  }\n\n  editChoicesOrigin(choicesOrigin: AjfChoicesOrigin<any>): void {\n    this._service.editChoicesOrigin(choicesOrigin);\n  }\n\n  editStringIdentifier(): void {\n    if (this._stringIdentifierDialog != null) {\n      this._stringIdentifierDialog.close();\n      this._stringIdentifierDialog = null;\n    }\n    this._stringIdentifierDialog = this._dialog.open(\n        AjfFbStringIdentifierDialogComponent, {disableClose: true, width: '60%', height: '60%'});\n  }\n\n  expandAll() {\n    this._globalExpanded = true;\n  }\n\n  collapseAll() {\n    this._globalExpanded = false;\n  }\n\n  expandToggle(evt: MatSlideToggleChange) {\n    if (evt.checked) {\n      this.expandAll();\n    } else {\n      this.collapseAll();\n    }\n  }\n\n  private _setCurrentForm(): void {\n    this._service.setForm(this._form);\n  }\n}\n","/**\n * @license\n * Copyright (C) Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {AjfNode, isContainerNode, isSlidesNode} from '@ajf/core/forms';\nimport {CdkDrag, CdkDragDrop, CdkDropList} from '@angular/cdk/drag-drop';\nimport {\n  AfterViewInit,\n  ChangeDetectionStrategy,\n  Component,\n  ElementRef,\n  Input,\n  OnDestroy,\n  QueryList,\n  ViewChildren,\n  ViewEncapsulation\n} from '@angular/core';\nimport {Observable, Subscription} from 'rxjs';\n\nimport {AjfFbBranchLine} from './branch-line';\nimport {\n  AjfFormBuilderNode,\n  AjfFormBuilderNodeEntry,\n  AjfFormBuilderNodeTypeEntry,\n  AjfFormBuilderService\n} from './form-builder-service';\nimport {\n  disableFieldDropPredicate,\n  disableSlideDropPredicate,\n  onDropProcess\n} from './form-builder-utils';\n\nconst branchColors: string[] = [\n  '#F44336',  // RED\n  '#4CAF50',  // GREEN\n  '#3F51B5',  // INDIGO\n  '#FFC107',  // AMBER\n  '#795548',  // BROWN\n];\n\n\n@Component({\n  selector: 'ajf-fb-node-entry',\n  templateUrl: 'node-entry.html',\n  styleUrls: ['node-entry.css'],\n  host: {'(window.resize)': 'onResize()'},\n  encapsulation: ViewEncapsulation.None,\n  changeDetection: ChangeDetectionStrategy.OnPush\n})\nexport class AjfFbNodeEntry implements AfterViewInit, OnDestroy {\n  @ViewChildren(AjfFbBranchLine) branchLines: QueryList<AjfFbBranchLine>;\n  @ViewChildren(AjfFbNodeEntry, {read: ElementRef}) childEntries: QueryList<ElementRef>;\n\n  private _hasContent = false;\n  get hasContent(): boolean {\n    return this._hasContent;\n  }\n\n  private _isFirst = false;\n  get isFirst(): boolean {\n    return this._isFirst;\n  }\n  @Input()\n  set isFirst(isFirst: boolean) {\n    this._isFirst = isFirst;\n  }\n\n  private _isNodeEntry = false;\n  get isNodeEntry(): boolean {\n    return this._isNodeEntry;\n  }\n\n  private _isExpanded = false;\n  get isExpanded(): boolean {\n    return this._isExpanded;\n  }\n  @Input()\n  set isExpanded(exp: boolean) {\n    this._isExpanded = exp;\n    setTimeout(() => this._updateBranchHeights(), 400);\n  }\n\n  private _nodeEntry: AjfFormBuilderNode;\n  get nodeEntry(): AjfFormBuilderNode {\n    return this._nodeEntry;\n  }\n  @Input()\n  set nodeEntry(nodeEntry: AjfFormBuilderNode) {\n    this._nodeEntry = nodeEntry;\n    if (nodeEntry != null && (<AjfFormBuilderNodeEntry>nodeEntry).node !== void 0) {\n      const ne = <AjfFormBuilderNodeEntry>nodeEntry;\n      this._isNodeEntry = true;\n      const node = ne.node;\n      this._hasContent = node != null && isContainerNode(node);\n    } else {\n      this._isNodeEntry = false;\n      this._hasContent = false;\n    }\n  }\n\n  private _level = 0;\n  get level(): number {\n    return this._level;\n  }\n  @Input()\n  set level(value: number) {\n    this._level = value;\n  }\n  private _isDraggable: boolean = true;\n  get isDraggable(): boolean {\n    return this._isDraggable;\n  }\n  @Input()\n  set isDraggable(draggable: boolean) {\n    this._isDraggable = draggable;\n  }\n\n  get realNodeEntry(): AjfFormBuilderNodeEntry {\n    return this._nodeEntry as AjfFormBuilderNodeEntry;\n  }\n\n  private _branchColors: string[] = branchColors.slice(0);\n  get branchColors(): string[] {\n    return this._branchColors;\n  }\n\n  private _dropZones: string[] = ['fbdz-node'];\n  get dropZones(): string[] {\n    return this._dropZones;\n  }\n\n  private _slideDropZones: string[] = ['fbdz-slide'];\n  get slideDropZones(): string[] {\n    return this._slideDropZones;\n  }\n\n  private _originOffset = 0;\n  get originOffset(): number {\n    return this._originOffset;\n  }\n  @Input()\n  set originOffset(originOffset: number) {\n    this._originOffset = originOffset;\n    this._originLeftMargin = `${this._originOffset * 4}px`;\n  }\n  private _originLeftMargin = '0';\n  get originLeftMargin(): string {\n    return this._originLeftMargin;\n  }\n\n  private _firstBranchColor = branchColors[0];\n  get firstBranchColor(): string {\n    return this._firstBranchColor;\n  }\n  @Input()\n  set firstBranchColor(firstBranchColor: string) {\n    const idx = branchColors.indexOf(firstBranchColor);\n    if (idx > 0) {\n      this._firstBranchColor = firstBranchColor;\n      this._branchColors = branchColors.slice(idx).concat(branchColors.slice(0, idx));\n    } else {\n      this._firstBranchColor = branchColors[0];\n      this._branchColors = branchColors.slice(0);\n    }\n  }\n\n  private _currentEditedNode: Observable<AjfFormBuilderNodeEntry|null>;\n  get currentEditedNode(): Observable<AjfFormBuilderNodeEntry|null> {\n    return this._currentEditedNode;\n  }\n\n  private _branchLinesSubscription: Subscription = Subscription.EMPTY;\n  private _childEntriesSubscription: Subscription = Subscription.EMPTY;\n\n  constructor(private _service: AjfFormBuilderService) {\n    this._currentEditedNode = this._service.editedNodeEntry;\n  }\n\n  onResize(): void {}\n\n  edit(evt: Event): void {\n    evt.stopPropagation();\n    if (this.nodeEntry == null || !this.isNodeEntry) {\n      return;\n    }\n    this._service.editNodeEntry(<AjfFormBuilderNodeEntry>this.nodeEntry);\n  }\n\n  delete(evt: Event): void {\n    evt.stopPropagation();\n    if (this.nodeEntry == null || !this.isNodeEntry) {\n      return;\n    }\n    this._service.deleteNodeEntry(<AjfFormBuilderNodeEntry>this.nodeEntry);\n  }\n\n  isLastNode(): boolean {\n    if (!this.realNodeEntry || !this.realNodeEntry.children) {\n      return false;\n    }\n    return !this.realNodeEntry.children[0].children;\n  }\n\n  isSlide(node: AjfNode): boolean {\n    return isSlidesNode(node);\n  }\n\n  ngAfterViewInit(): void {\n    setTimeout(() => this._updateBranchHeights());\n    this._childEntriesSubscription = this.childEntries.changes.subscribe(() => {\n      this._updateBranchHeights();\n    });\n  }\n\n  ngOnDestroy(): void {\n    this._branchLinesSubscription.unsubscribe();\n    this._childEntriesSubscription.unsubscribe();\n  }\n\n  /**\n   * Triggers when a field or slide node is moved or inserted by drag&dropping in the formbuilder.\n   * @param event The drop event.\n   * @param content True if the current nodeEntry contains other nodeEntries.\n   */\n  onDrop(\n      event: CdkDragDrop<AjfFormBuilderNodeEntry>|CdkDragDrop<AjfFormBuilderNodeTypeEntry>,\n      content = false): void {\n    onDropProcess(event, this._service, this._nodeEntry, content);\n  }\n\n  /**\n   * Assigns a progressive id to the dropList, to connect it to the FormBuilder source list.\n   * @param empty True if the list is marked as empty.\n   */\n  assignId(empty: boolean = false): string {\n    return this._service.assignListId(this.realNodeEntry.node, empty);\n  }\n\n  disableSlideDrop(item: CdkDrag<AjfFormBuilderNodeTypeEntry>): boolean {\n    return disableSlideDropPredicate(item);\n  }\n\n  disableFieldDrop(item: CdkDrag<AjfFormBuilderNodeTypeEntry>): boolean {\n    return disableFieldDropPredicate(item);\n  }\n\n  emptyAreaDropPredicate(): (item: CdkDrag, _drop: CdkDropList) => boolean {\n    return (item: CdkDrag, _drop: CdkDropList): boolean => {\n      if (this._level > 0) {\n        return !item.data.isSlide;\n      }\n      return item.data.isSlide || false;\n    };\n  }\n\n  private _updateBranchHeights(): void {\n    if (this.nodeEntry == null || !this.isNodeEntry || this.branchLines == null ||\n        this.childEntries == null) {\n      return;\n    }\n    const nodeEntry = <AjfFormBuilderNodeEntry>this.nodeEntry;\n    const branchLines: AjfFbBranchLine[] = this.branchLines.toArray();\n    const sliceIdx = nodeEntry.content != null ? nodeEntry.content.length : 0;\n    const childEntries: ElementRef[] = this.childEntries.toArray().slice(sliceIdx);\n\n    if (branchLines.length != childEntries.length) {\n      return;\n    }\n\n    branchLines.forEach((bl: AjfFbBranchLine, idx: number) => {\n      const ce: ElementRef = childEntries[idx];\n      bl.height = ce.nativeElement.offsetTop;\n    });\n  }\n}\n","/**\n * @license\n * Copyright (C) Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {AjfField} from '@ajf/core/forms';\nimport {ChangeDetectionStrategy, Component, ViewChild, ViewEncapsulation} from '@angular/core';\nimport {MatDialogRef} from '@angular/material/dialog';\nimport {Observable} from 'rxjs';\nimport {map} from 'rxjs/operators';\n\nimport {AjfFbConditionEditor} from './condition-editor';\nimport {AjfFormBuilderService} from './form-builder-service';\n\n\n@Component({\n  selector: 'ajf-fb-validation-condition-editor-dialog',\n  templateUrl: 'validation-condition-editor-dialog.html',\n  styleUrls: ['validation-condition-editor-dialog.css'],\n  encapsulation: ViewEncapsulation.None,\n  changeDetection: ChangeDetectionStrategy.OnPush\n})\nexport class AjfFbValidationConditionEditorDialog {\n  @ViewChild(AjfFbConditionEditor, {static: false}) editor: AjfFbConditionEditor;\n\n  private _fields: Observable<AjfField[]>;\n  get fields(): Observable<AjfField[]> {\n    return this._fields;\n  }\n\n  condition: string;\n  errorMessage: string;\n\n  constructor(\n      service: AjfFormBuilderService,\n      public dialogRef: MatDialogRef<AjfFbValidationConditionEditorDialog>) {\n    this._fields = service.flatFields.pipe(\n        map((fields: AjfField[]) => fields.sort((f1, f2) => f1.name.localeCompare(f2.name))));\n  }\n\n  saveCondition(): void {\n    if (this.editor == null) {\n      return;\n    }\n    const newValue = this.editor.editedValue;\n    this.dialogRef.close({condition: newValue, errorMessage: this.errorMessage});\n  }\n}\n","/**\n * @license\n * Copyright (C) Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {AjfField} from '@ajf/core/forms';\nimport {ChangeDetectionStrategy, Component, ViewChild, ViewEncapsulation} from '@angular/core';\nimport {MatDialogRef} from '@angular/material/dialog';\nimport {Observable} from 'rxjs';\nimport {map} from 'rxjs/operators';\n\nimport {AjfFbConditionEditor} from './condition-editor';\nimport {AjfFormBuilderService} from './form-builder-service';\n\n\n@Component({\n  selector: 'ajf-fb-warning-condition-editor-dialog',\n  templateUrl: 'warning-condition-editor-dialog.html',\n  styleUrls: ['warning-condition-editor-dialog.css'],\n  encapsulation: ViewEncapsulation.None,\n  changeDetection: ChangeDetectionStrategy.OnPush\n})\nexport class AjfFbWarningConditionEditorDialog {\n  @ViewChild(AjfFbConditionEditor, {static: false}) editor: AjfFbConditionEditor;\n\n  private _fields: Observable<AjfField[]>;\n  get fields(): Observable<AjfField[]> {\n    return this._fields;\n  }\n\n  condition: string;\n  warningMessage: string;\n\n  constructor(\n      service: AjfFormBuilderService,\n      public dialogRef: MatDialogRef<AjfFbWarningConditionEditorDialog>) {\n    this._fields = service.flatFields.pipe(\n        map((fields: AjfField[]) => fields.sort((f1, f2) => f1.name.localeCompare(f2.name))));\n  }\n\n  saveCondition(): void {\n    if (this.editor == null) {\n      return;\n    }\n    const newValue = this.editor.editedValue;\n    this.dialogRef.close({condition: newValue, warningMessage: this.warningMessage});\n  }\n}\n","/**\n * @license\n * Copyright (C) Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {\n  AjfChoicesOrigin,\n  AjfField,\n  AjfFieldWithChoices,\n  AjfNode,\n  AjfNumberField,\n  AjfRepeatingContainerNode,\n  isField,\n  isFieldWithChoices,\n  isNumberField,\n  isRepeatingContainerNode\n} from '@ajf/core/forms';\nimport {AjfCondition, alwaysCondition, neverCondition} from '@ajf/core/models';\nimport {\n  ChangeDetectionStrategy,\n  ChangeDetectorRef,\n  Component,\n  EventEmitter,\n  OnDestroy,\n  ViewEncapsulation\n} from '@angular/core';\nimport {AbstractControl, FormBuilder, FormGroup, ValidatorFn, Validators} from '@angular/forms';\nimport {MatDialog, MatDialogRef} from '@angular/material/dialog';\nimport {Observable, Subscription} from 'rxjs';\nimport {\n  distinctUntilChanged,\n  filter,\n  map,\n  publishReplay,\n  refCount,\n  withLatestFrom\n} from 'rxjs/operators';\n\nimport {AjfFbConditionEditorDialog} from './condition-editor-dialog';\nimport {AjfFormBuilderNodeEntry, AjfFormBuilderService} from './form-builder-service';\nimport {AjfFbValidationConditionEditorDialog} from './validation-condition-editor-dialog';\nimport {AjfFbWarningConditionEditorDialog} from './warning-condition-editor-dialog';\n\n\nfunction checkRepsValidity(c: AbstractControl): {[key: string]: any}|null {\n  const minReps = c.value.minReps;\n  const maxReps = c.value.maxReps;\n  if (minReps != null && maxReps != null && minReps > maxReps) {\n    return {reps: 'Min repetions cannot be greater than max repetitions'};\n  }\n  return null;\n}\n\nfunction checkValueLimitsValidity(c: AbstractControl): {[key: string]: any}|null {\n  const minValue = c.value.minValue;\n  const maxValue = c.value.maxValue;\n  if (minValue != null && maxValue != null && minValue > maxValue) {\n    return {valueLimit: 'Min value cannot be greater than max value'};\n  }\n  return null;\n}\n\nfunction checkDigitsValidity(c: AbstractControl): {[key: string]: any}|null {\n  const minDigits = c.value.minDigits;\n  const maxDigits = c.value.maxDigits;\n  if (minDigits != null && maxDigits != null && minDigits > maxDigits) {\n    return {digits: 'Min digits cannot be greater than max digits'};\n  }\n  return null;\n}\n\nexport interface ValidationCondition {\n  condition: string;\n  errorMessage: string;\n}\n\nexport interface WarningCondition {\n  condition: string;\n  warningMessage: string;\n}\n\n\n@Component({\n  selector: 'ajf-fb-node-properties',\n  templateUrl: 'node-properties.html',\n  styleUrls: ['node-properties.css'],\n  encapsulation: ViewEncapsulation.None,\n  changeDetection: ChangeDetectionStrategy.OnPush\n})\nexport class AjfFbNodeProperties implements OnDestroy {\n  private _fieldSizes: {label: string, value: string}[] = [\n    {label: 'Normal', value: 'normal'}, {label: 'Small', value: 'small'},\n    {label: 'Smaller', value: 'smaller'}, {label: 'Tiny', value: 'tiny'},\n    {label: 'Mini', value: 'mini'}\n  ];\n  get fieldSizes(): {label: string, value: string}[] {\n    return this._fieldSizes;\n  }\n\n  private _nodeEntry: Observable<AjfFormBuilderNodeEntry|null>;\n  get nodeEntry(): Observable<AjfFormBuilderNodeEntry|null> {\n    return this._nodeEntry;\n  }\n\n  private _choicesOrigins: AjfChoicesOrigin<any>[] = [];\n  get choicesOrigins(): AjfChoicesOrigin<any>[] {\n    return this._choicesOrigins;\n  }\n\n  private _enabled: Observable<boolean>;\n  get enabled(): Observable<boolean> {\n    return this._enabled;\n  }\n\n  private _propertiesForm: Observable<FormGroup>;\n  get propertiesForm(): Observable<FormGroup> {\n    return this._propertiesForm;\n  }\n\n  private _hasChoices: Observable<boolean>;\n  get hasChoices(): Observable<boolean> {\n    return this._hasChoices;\n  }\n\n  private _curVisibility: string|null;\n  get curVisibility(): string|null {\n    return this._curVisibility;\n  }\n\n  private _curFormulaReps: string|null;\n  get curFormulaReps(): string|null {\n    return this._curFormulaReps;\n  }\n\n  private _curChoicesFilter: string;\n  get curChoicesFilter(): string {\n    return this._curChoicesFilter;\n  }\n\n  private _curForceValue: string|null;\n  get curForceValue(): string|null {\n    return this._curForceValue;\n  }\n\n  private _curFormula: string|null;\n  get curFormula(): string|null {\n    return this._curFormula;\n  }\n\n  private _conditionalBranches: string[] = [];\n  get conditionalBranches(): string[] {\n    return this._conditionalBranches;\n  }\n\n  private _validationConditions: ValidationCondition[] = [];\n  get validationConditions(): ValidationCondition[] {\n    return this._validationConditions;\n  }\n\n  private _warningConditions: WarningCondition[] = [];\n  get warningConditions(): WarningCondition[] {\n    return this._warningConditions;\n  }\n\n  private _nextSlideCondition: string;\n  get nextSlideCondition(): string {\n    return this._nextSlideCondition;\n  }\n\n  private _triggerConditions: string[];\n  get triggerConditions(): string[] {\n    return this._triggerConditions;\n  }\n\n  isRepeatingContainerNode: (nodeEntry: AjfFormBuilderNodeEntry|null) => boolean =\n      (nodeEntry) => {\n        return nodeEntry != null && isRepeatingContainerNode(nodeEntry.node);\n      }\n\n  private _visibilityOptSub: Subscription = Subscription.EMPTY;\n  private _visibilitySub: Subscription = Subscription.EMPTY;\n  private _conditionalBranchesSub = Subscription.EMPTY;\n  private _formulaRepsSub = Subscription.EMPTY;\n  private _choicesFilterSub = Subscription.EMPTY;\n  private _formulaSub = Subscription.EMPTY;\n  private _forceValueSub = Subscription.EMPTY;\n  private _validationConditionsSub = Subscription.EMPTY;\n  private _warningConditionsSub = Subscription.EMPTY;\n  private _nextSlideConditionSub = Subscription.EMPTY;\n  private _choicesOriginsSub = Subscription.EMPTY;\n  private _triggerConditionsSub = Subscription.EMPTY;\n\n  private _editConditionDialog: MatDialogRef<AjfFbConditionEditorDialog>|null;\n  private _editConditionDialogSub: Subscription = Subscription.EMPTY;\n  private _editValidationConditionDialog: MatDialogRef<AjfFbValidationConditionEditorDialog>|null;\n  private _editValidationConditionDialogSub: Subscription = Subscription.EMPTY;\n  private _editWarningConditionDialog: MatDialogRef<AjfFbWarningConditionEditorDialog>|null;\n  private _editWarningConditionDialogSub: Subscription = Subscription.EMPTY;\n\n  private _editVisibilityEvt: EventEmitter<void> = new EventEmitter<void>();\n  private _editVisibilitySub = Subscription.EMPTY;\n\n  private _editConditionalBranchEvt: EventEmitter<number> = new EventEmitter<number>();\n  private _editConditionalBranchSub = Subscription.EMPTY;\n\n  private _editFormulaRepsEvt: EventEmitter<void> = new EventEmitter<void>();\n  private _editFormulaRepsSub = Subscription.EMPTY;\n\n  private _editChoicesFilterEvt: EventEmitter<void> = new EventEmitter<void>();\n  private _editChoicesFilterSub = Subscription.EMPTY;\n\n  private _editFormulaEvt: EventEmitter<void> = new EventEmitter<void>();\n  private _editFormulaSub = Subscription.EMPTY;\n\n  private _editForceValueEvt: EventEmitter<void> = new EventEmitter<void>();\n  private _editForceValueSub = Subscription.EMPTY;\n\n  private _editValidationConditionEvt: EventEmitter<number> = new EventEmitter<number>();\n  private _editValidationConditionSub = Subscription.EMPTY;\n\n  private _addValidationConditionEvt: EventEmitter<void> = new EventEmitter<void>();\n  private _addValidationConditionSub = Subscription.EMPTY;\n\n  private _removeValidationConditionEvt: EventEmitter<number> = new EventEmitter<number>();\n  private _removeValidationConditionSub = Subscription.EMPTY;\n\n  private _editWarningConditionEvt: EventEmitter<number> = new EventEmitter<number>();\n  private _editWarningConditionSub = Subscription.EMPTY;\n\n  private _addWarningConditionEvt: EventEmitter<void> = new EventEmitter<void>();\n  private _addWarningConditionSub = Subscription.EMPTY;\n\n  private _removeWarningConditionEvt: EventEmitter<number> = new EventEmitter<number>();\n  private _removeWarningConditionSub = Subscription.EMPTY;\n\n  private _editNextSlideConditionEvt: EventEmitter<void> = new EventEmitter<void>();\n  private _editNextSlideConditionSub = Subscription.EMPTY;\n\n  private _editTriggerConditionEvt: EventEmitter<number> = new EventEmitter<number>();\n  private _editTriggerConditionSub = Subscription.EMPTY;\n\n  private _addTriggerConditionEvt: EventEmitter<void> = new EventEmitter<void>();\n  private _addTriggerConditionSub = Subscription.EMPTY;\n\n  private _removeTriggerConditionEvt: EventEmitter<number> = new EventEmitter<number>();\n  private _removeTriggerConditionSub = Subscription.EMPTY;\n\n  private _saveEvt: EventEmitter<void> = new EventEmitter<void>();\n  private _saveSub = Subscription.EMPTY;\n\n  constructor(\n      private _cdr: ChangeDetectorRef,\n      private _service: AjfFormBuilderService,\n      private _dialog: MatDialog,\n      private _fb: FormBuilder,\n  ) {\n    this._nodeEntry = _service.editedNodeEntry;\n    this._choicesOriginsSub =\n        _service.choicesOrigins.subscribe((c) => this._choicesOrigins = c || []);\n\n    this._enabled = this._nodeEntry.pipe(map((n) => n != null));\n\n    this._initForm();\n    this._initVisibilityEdit();\n    this._initConditionalBranchEdit();\n    this._initFormulaRepsEdit();\n    this._initChoicesFilterEdit();\n    this._initFormulaEdit();\n    this._initForceValueEdit();\n    this._initValidationConditionEdit();\n    this._initAddValidationCondition();\n    this._initRemoveValidationCondition();\n    this._initWarningConditionEdit();\n    this._initAddWarningCondition();\n    this._initRemoveWarningCondition();\n    this._initNextSlideConditionEdit();\n    this._initTriggerConditionEdit();\n    this._initAddTriggerCondition();\n    this._initRemoveTriggerCondition();\n    this._initSave();\n  }\n\n  editVisibility(): void {\n    this._editVisibilityEvt.emit();\n  }\n\n  editConditionalBranch(idx: number): void {\n    if (idx < 0 || idx >= this._conditionalBranches.length) {\n      return;\n    }\n    this._editConditionalBranchEvt.emit(idx);\n  }\n\n  editFormulaReps(): void {\n    this._editFormulaRepsEvt.emit();\n  }\n\n  editChoicesFilter(): void {\n    this._editChoicesFilterEvt.emit();\n  }\n\n  editFormula(): void {\n    this._editFormulaEvt.emit();\n  }\n\n  editForceValue(): void {\n    this._editForceValueEvt.emit();\n  }\n\n  editValidationCondition(idx: number): void {\n    if (idx < 0 || idx >= this._validationConditions.length) {\n      return;\n    }\n    this._editValidationConditionEvt.emit(idx);\n  }\n\n  addValidationCondition(): void {\n    this._addValidationConditionEvt.emit();\n  }\n\n  removeValidationCondition(idx: number): void {\n    if (idx < 0 || idx >= this._validationConditions.length) {\n      return;\n    }\n    this._removeValidationConditionEvt.emit(idx);\n  }\n\n  editWarningCondition(idx: number): void {\n    if (idx < 0 || idx >= this._warningConditions.length) {\n      return;\n    }\n    this._editWarningConditionEvt.emit(idx);\n  }\n\n  addWarningCondition(): void {\n    this._addWarningConditionEvt.emit();\n  }\n\n  removeWarningCondition(idx: number): void {\n    if (idx < 0 || idx >= this._warningConditions.length) {\n      return;\n    }\n    this._removeWarningConditionEvt.emit(idx);\n  }\n\n  editNextSlideCondition(): void {\n    this._editNextSlideConditionEvt.emit();\n  }\n\n  editTriggerCondition(idx: number): void {\n    if (idx < 0 || idx >= this._triggerConditions.length) {\n      return;\n    }\n    this._editTriggerConditionEvt.emit(idx);\n  }\n\n  addTriggerCondition(): void {\n    this._addTriggerConditionEvt.emit();\n  }\n\n  removeTriggerCondition(idx: number): void {\n    if (idx < 0 || idx >= this._triggerConditions.length) {\n      return;\n    }\n    this._removeTriggerConditionEvt.emit(idx);\n  }\n\n  isField(nodeEntry: AjfFormBuilderNodeEntry|null): boolean {\n    return nodeEntry != null && isField(nodeEntry.node);\n  }\n\n  isNumericField(node: AjfNode): boolean {\n    return isField(node) && isNumberField(node as AjfField);\n  }\n\n  isFieldWithChoices(node: AjfNode): boolean {\n    return isField(node) && isFieldWithChoices(node as AjfField);\n  }\n\n  save(): void {\n    this._saveEvt.emit();\n  }\n\n  cancel(): void {\n    this._service.cancelNodeEntryEdit();\n  }\n\n  ngOnDestroy(): void {\n    this._choicesOriginsSub.unsubscribe();\n\n    this._visibilityOptSub.unsubscribe();\n    this._visibilitySub.unsubscribe();\n    this._formulaRepsSub.unsubscribe();\n    this._choicesFilterSub.unsubscribe();\n    this._formulaSub.unsubscribe();\n    this._forceValueSub.unsubscribe();\n    this._validationConditionsSub.unsubscribe();\n    this._warningConditionsSub.unsubscribe();\n    this._triggerConditionsSub.unsubscribe();\n\n    this._editConditionDialogSub.unsubscribe();\n    this._editValidationConditionDialogSub.unsubscribe();\n    this._editWarningConditionDialogSub.unsubscribe();\n\n    this._editChoicesFilterSub.unsubscribe();\n    this._editConditionalBranchSub.unsubscribe();\n    this._editVisibilitySub.unsubscribe();\n    this._editFormulaRepsSub.unsubscribe();\n    this._editFormulaSub.unsubscribe();\n    this._editForceValueSub.unsubscribe();\n    this._editValidationConditionSub.unsubscribe();\n    this._editWarningConditionSub.unsubscribe();\n    this._nextSlideConditionSub.unsubscribe();\n\n    this._addTriggerConditionSub.unsubscribe();\n    this._addValidationConditionSub.unsubscribe();\n    this._addWarningConditionSub.unsubscribe();\n    this._editNextSlideConditionSub.unsubscribe();\n    this._editTriggerConditionSub.unsubscribe();\n    this._removeTriggerConditionSub.unsubscribe();\n    this._removeValidationConditionSub.unsubscribe();\n    this._removeWarningConditionSub.unsubscribe();\n\n    this._saveSub.unsubscribe();\n  }\n\n  private _initSave(): void {\n    this._saveSub = this._saveEvt\n                        .pipe(\n                            withLatestFrom(this.propertiesForm),\n                            )\n                        .subscribe(([_, formGroup]) => {\n                          const fg = formGroup as FormGroup;\n                          const val = {...fg.value, conditionalBranches: this._conditionalBranches};\n                          this._service.saveNodeEntry(val);\n                        });\n  }\n\n  private _initForm(): void {\n    this._propertiesForm = this._nodeEntry.pipe(\n        filter((n) => n != null), map((n) => {\n          if (this._visibilityOptSub != null) {\n            this._visibilityOptSub.unsubscribe();\n          }\n          if (this._visibilitySub != null) {\n            this._visibilitySub.unsubscribe();\n          }\n          if (this._conditionalBranchesSub != null) {\n            this._conditionalBranchesSub.unsubscribe();\n          }\n          n = n!;\n\n          const visibility = n.node.visibility != null ? n.node.visibility.condition : null;\n          const visibilityOpt =\n              n.node.visibility != null ? this._guessVisibilityOpt(n.node.visibility) : null;\n          let controls: any = {\n            name: [n.node.name, Validators.required],\n            label: n.node.label,\n            visibilityOpt: [visibilityOpt, Validators.required],\n            visibility: [visibility, Validators.required],\n            conditionalBranchesNum: n.node.conditionalBranches.length\n          };\n          const validators: ValidatorFn[] = [];\n\n          if (isRepeatingContainerNode(n.node)) {\n            const rn = <AjfRepeatingContainerNode>n.node;\n\n            const formulaReps = rn.formulaReps != null ? rn.formulaReps.formula : null;\n\n            controls.formulaReps = [formulaReps, Validators.required];\n            controls.minReps = rn.minReps;\n            controls.maxReps = rn.maxReps;\n\n            this._curFormulaReps = formulaReps;\n\n            validators.push(checkRepsValidity);\n          }\n\n          if (this.isField(n)) {\n            const field = <AjfField>n.node;\n\n            let forceValue: string|null = null;\n            let notEmpty: boolean = false;\n            let validationConditions: ValidationCondition[] = [];\n            if (field.validation != null) {\n              if (field.validation.forceValue != null) {\n                forceValue = field.validation.forceValue.condition;\n              }\n              notEmpty = field.validation.notEmpty != null;\n              validationConditions = (field.validation.conditions || []).map(c => {\n                return {condition: c.condition, errorMessage: c.errorMessage};\n              });\n            }\n\n            let notEmptyW: boolean = false;\n            let warningConditions: WarningCondition[] = [];\n            if (field.warning != null) {\n              notEmptyW = field.warning.notEmpty != null;\n              warningConditions = (field.warning.conditions || []).map(w => {\n                return {condition: w.condition, warningMessage: w.warningMessage};\n              });\n            }\n            const formula = field.formula != null ? field.formula.formula : null;\n\n            controls.description = field.description;\n            controls.defaultValue = field.defaultValue;\n            controls.hint = field.hint;\n            controls.size = field.size;\n            controls.formula = formula;\n            controls.forceValue = forceValue;\n            controls.notEmpty = notEmpty;\n            controls.validationConditions = [validationConditions, []];\n            controls.notEmptyWarning = notEmptyW;\n            controls.warningConditions = [warningConditions, []];\n            controls.nextSlideCondition = [field.nextSlideCondition];\n\n            this._curForceValue = forceValue;\n            this._curFormula = formula;\n            this._validationConditions = validationConditions;\n            this._warningConditions = warningConditions;\n          }\n\n          if (this.isNumericField(n.node)) {\n            const numField = <AjfNumberField>n.node;\n\n            let minValue: any;\n            let maxValue: any;\n            let minDigits: any;\n            let maxDigits: any;\n            if (numField.validation != null) {\n              if (numField.validation.minValue != null) {\n                minValue = (numField.validation.minValue.condition || '').replace('$value >= ', '');\n              }\n              if (numField.validation.maxValue != null) {\n                maxValue = (numField.validation.maxValue.condition || '').replace('$value <= ', '');\n              }\n              if (numField.validation.minDigits != null) {\n                minDigits = (numField.validation.minDigits.condition ||\n                             '').replace('$value.toString().length >= ', '');\n              }\n              if (numField.validation.maxDigits != null) {\n                maxDigits = (numField.validation.maxDigits.condition ||\n                             '').replace('$value.toString().length <= ', '');\n              }\n            }\n\n            controls.minValue = minValue;\n            controls.maxValue = maxValue;\n            controls.minDigits = minDigits;\n            controls.maxDigits = maxDigits;\n\n            validators.push(checkValueLimitsValidity);\n            validators.push(checkDigitsValidity);\n          }\n\n          if (this.isFieldWithChoices(n.node)) {\n            const fieldWithChoices = <AjfFieldWithChoices<any>>n.node;\n\n            let triggerConditions: string[] =\n                (fieldWithChoices.triggerConditions || []).map((c) => c.condition);\n\n            controls.choicesOriginRef = (fieldWithChoices as any).choicesOriginRef;\n            controls.choicesFilter = fieldWithChoices.choicesFilter != null ?\n                fieldWithChoices.choicesFilter.formula :\n                null;\n            controls.forceExpanded = fieldWithChoices.forceExpanded;\n            controls.forceNarrow = fieldWithChoices.forceNarrow;\n            controls.triggerConditions = triggerConditions;\n\n            this._triggerConditions = triggerConditions;\n          }\n\n          const fg = this._fb.group(controls);\n          fg.setValidators(validators);\n\n          this._conditionalBranches = n.node.conditionalBranches.map(c => c.condition);\n          this._curVisibility = n.node.visibility != null ? n.node.visibility.condition : null;\n\n          this._handleConditionalBranchesChange(fg);\n          this._handleVisibilityChange(fg);\n          this._handleFormulaRepsChange(fg);\n          this._handleChoicesFilterChange(fg);\n          this._handleFormulaChange(fg);\n          this._handleForceValueChange(fg);\n          this._handleValidationCondtionsChange(fg);\n          this._handleWarningCondtionsChange(fg);\n          this._handleNextSlideConditionChange(fg);\n          this._handleTriggerCondtionsChange(fg);\n\n          return fg;\n        }),\n        publishReplay(1), refCount());\n  }\n\n  private _destroyConditionDialog(): void {\n    if (this._editConditionDialogSub != null) {\n      this._editConditionDialogSub.unsubscribe();\n      this._editConditionDialogSub = Subscription.EMPTY;\n    }\n    if (this._editConditionDialog != null) {\n      this._editConditionDialog.close();\n      this._editConditionDialog = null;\n    }\n  }\n\n  private _destroyValidationConditionDialog(): void {\n    if (this._editValidationConditionDialogSub != null) {\n      this._editValidationConditionDialogSub.unsubscribe();\n      this._editValidationConditionDialogSub = Subscription.EMPTY;\n    }\n    if (this._editValidationConditionDialog != null) {\n      this._editValidationConditionDialog.close();\n      this._editValidationConditionDialog = null;\n    }\n  }\n\n  private _destroyWarningConditionDialog(): void {\n    if (this._editWarningConditionDialogSub != null) {\n      this._editWarningConditionDialogSub.unsubscribe();\n      this._editWarningConditionDialogSub = Subscription.EMPTY;\n    }\n    if (this._editWarningConditionDialog != null) {\n      this._editWarningConditionDialog.close();\n      this._editWarningConditionDialog = null;\n    }\n  }\n\n  private _initRemoveTriggerCondition(): void {\n    this._removeTriggerConditionSub = this._removeTriggerConditionEvt\n                                          .pipe(\n                                              withLatestFrom(this._propertiesForm),\n                                              )\n                                          .subscribe(([vcIdx, formGroup]) => {\n                                            if (formGroup == null) {\n                                              return;\n                                            }\n                                            const fg = formGroup as FormGroup;\n                                            const ctrl = fg.controls['triggerConditions'];\n                                            let vcs = (ctrl.value || []).slice(0);\n                                            if (vcIdx < 0 || vcIdx >= vcs.length) {\n                                              return;\n                                            }\n                                            vcs.splice(vcIdx, 1);\n                                            ctrl.setValue(vcs);\n                                          });\n  }\n\n  private _initAddTriggerCondition(): void {\n    this._addTriggerConditionSub = this._addTriggerConditionEvt\n                                       .pipe(\n                                           withLatestFrom(this._propertiesForm),\n                                           )\n                                       .subscribe(([_, formGroup]) => {\n                                         if (formGroup == null) {\n                                           return;\n                                         }\n                                         const fg = formGroup as FormGroup;\n                                         const ctrl = fg.controls['triggerConditions'];\n                                         let vcs = (ctrl.value || []).slice(0);\n                                         vcs.push('');\n                                         ctrl.setValue(vcs);\n                                       });\n  }\n\n  private _initTriggerConditionEdit(): void {\n    this._editConditionDialogSub = Subscription.EMPTY;\n    this._cdr.markForCheck();\n    this._editTriggerConditionSub =\n        this._editTriggerConditionEvt\n            .pipe(\n                withLatestFrom(this._propertiesForm),\n                )\n            .subscribe(([vcIdx, fg]) => {\n              this._destroyConditionDialog();\n              if (vcIdx < 0 || vcIdx >= this._triggerConditions.length || fg == null) {\n                return;\n              }\n              this._editConditionDialog = this._dialog.open(AjfFbConditionEditorDialog);\n              const cmp = this._editConditionDialog.componentInstance;\n              cmp.condition = this._triggerConditions[vcIdx];\n              this._editConditionDialogSub =\n                  this._editConditionDialog.afterClosed().subscribe((cond: string) => {\n                    if (cond !== void 0) {\n                      this._triggerConditions[vcIdx] = cond;\n                    }\n                    this._editConditionDialogSub.unsubscribe();\n                    this._editConditionDialogSub = Subscription.EMPTY;\n                    this._cdr.markForCheck();\n                  });\n            });\n  }\n\n  private _initRemoveWarningCondition(): void {\n    this._removeWarningConditionSub = this._removeWarningConditionEvt\n                                          .pipe(\n                                              withLatestFrom(this._propertiesForm),\n                                              )\n                                          .subscribe(([vcIdx, formGroup]) => {\n                                            if (formGroup == null) {\n                                              return;\n                                            }\n                                            const fg = formGroup as FormGroup;\n                                            const ctrl = fg.controls['warningConditions'];\n                                            let vcs = (ctrl.value || []).slice(0);\n                                            if (vcIdx < 0 || vcIdx >= vcs.length) {\n                                              return;\n                                            }\n                                            vcs.splice(vcIdx, 1);\n                                            ctrl.setValue(vcs);\n                                          });\n  }\n\n  private _initAddWarningCondition(): void {\n    this._addWarningConditionSub = this._addWarningConditionEvt\n                                       .pipe(\n                                           withLatestFrom(this._propertiesForm),\n                                           )\n                                       .subscribe(([_, formGroup]) => {\n                                         if (formGroup == null) {\n                                           return;\n                                         }\n                                         const fg = formGroup as FormGroup;\n                                         const ctrl = fg.controls['warningConditions'];\n                                         let vcs = (ctrl.value || []).slice(0);\n                                         vcs.push({condition: '', errorMessage: ''});\n                                         ctrl.setValue(vcs);\n                                       });\n  }\n\n  private _initWarningConditionEdit(): void {\n    this._editWarningConditionSub =\n        this._editWarningConditionEvt\n            .pipe(\n                withLatestFrom(this._propertiesForm),\n                )\n            .subscribe(([vcIdx, fg]) => {\n              this._destroyWarningConditionDialog();\n              if (vcIdx < 0 || vcIdx >= this._warningConditions.length || fg == null) {\n                return;\n              }\n              this._editWarningConditionDialog =\n                  this._dialog.open(AjfFbWarningConditionEditorDialog);\n              const cmp = this._editWarningConditionDialog.componentInstance;\n              const w = this._warningConditions[vcIdx];\n              cmp.condition = w.condition;\n              cmp.warningMessage = w.warningMessage;\n              this._editWarningConditionDialogSub =\n                  this._editWarningConditionDialog.afterClosed().subscribe(\n                      (cond: WarningCondition) => {\n                        if (cond !== void 0) {\n                          this._warningConditions[vcIdx] = cond;\n                        }\n                        this._editWarningConditionDialogSub.unsubscribe();\n                        this._editWarningConditionDialogSub = Subscription.EMPTY;\n                        this._cdr.markForCheck();\n                      });\n            });\n  }\n\n  private _initRemoveValidationCondition(): void {\n    this._removeValidationConditionSub = this._removeValidationConditionEvt\n                                             .pipe(\n                                                 withLatestFrom(this._propertiesForm),\n                                                 )\n                                             .subscribe(([vcIdx, formGroup]) => {\n                                               if (formGroup == null) {\n                                                 return;\n                                               }\n                                               const fg = formGroup as FormGroup;\n                                               const ctrl = fg.controls['validationConditions'];\n                                               let vcs = (ctrl.value || []).slice(0);\n                                               if (vcIdx < 0 || vcIdx >= vcs.length) {\n                                                 return;\n                                               }\n                                               vcs.splice(vcIdx, 1);\n                                               ctrl.setValue(vcs);\n                                             });\n  }\n\n  private _initAddValidationCondition(): void {\n    this._addValidationConditionSub = this._addValidationConditionEvt\n                                          .pipe(\n                                              withLatestFrom(this._propertiesForm),\n                                              )\n                                          .subscribe(([_, formGroup]) => {\n                                            if (formGroup == null) {\n                                              return;\n                                            }\n                                            const fg = formGroup as FormGroup;\n                                            const ctrl = fg.controls['validationConditions'];\n                                            let vcs = (ctrl.value || []).slice(0);\n                                            vcs.push({condition: '', errorMessage: ''});\n                                            ctrl.setValue(vcs);\n                                          });\n  }\n\n  private _initValidationConditionEdit(): void {\n    this._editValidationConditionSub =\n        this._editValidationConditionEvt\n            .pipe(\n                withLatestFrom(this._propertiesForm),\n                )\n            .subscribe(([vcIdx, fg]) => {\n              this._destroyValidationConditionDialog();\n              if (vcIdx < 0 || vcIdx >= this._validationConditions.length || fg == null) {\n                return;\n              }\n              this._editValidationConditionDialog =\n                  this._dialog.open(AjfFbValidationConditionEditorDialog);\n              const cmp = this._editValidationConditionDialog.componentInstance;\n              const v = this._validationConditions[vcIdx];\n              cmp.condition = v.condition;\n              cmp.errorMessage = v.errorMessage;\n              this._editValidationConditionDialogSub =\n                  this._editValidationConditionDialog.afterClosed().subscribe(\n                      (cond: ValidationCondition) => {\n                        if (cond !== void 0) {\n                          this._validationConditions[vcIdx] = cond;\n                        }\n                        this._editValidationConditionDialogSub.unsubscribe();\n                        this._editValidationConditionDialogSub = Subscription.EMPTY;\n                        this._cdr.markForCheck();\n                      });\n            });\n  }\n\n  private _initForceValueEdit(): void {\n    this._editForceValueSub =\n        this._editForceValueEvt\n            .pipe(\n                withLatestFrom(this._propertiesForm),\n                )\n            .subscribe(([_, formGroup]) => {\n              this._destroyConditionDialog();\n              if (formGroup == null) {\n                return;\n              }\n              const fg = formGroup as FormGroup;\n              const ctrl = fg.controls['forceValue'];\n              this._editConditionDialog = this._dialog.open(AjfFbConditionEditorDialog);\n              this._editConditionDialog.componentInstance.condition = ctrl.value;\n              this._editConditionDialogSub =\n                  this._editConditionDialog.afterClosed().subscribe((cond: string) => {\n                    if (cond !== void 0) {\n                      ctrl.setValue(cond);\n                    }\n                    this._editConditionDialogSub.unsubscribe();\n                    this._editConditionDialogSub = Subscription.EMPTY;\n                    this._cdr.markForCheck();\n                  });\n            });\n  }\n\n  private _initNextSlideConditionEdit(): void {\n    this._editNextSlideConditionSub =\n        this._editNextSlideConditionEvt\n            .pipe(\n                withLatestFrom(this._propertiesForm),\n                )\n            .subscribe(([_, formGroup]) => {\n              this._destroyConditionDialog();\n              if (formGroup == null) {\n                return;\n              }\n              const fg = formGroup as FormGroup;\n              const ctrl = fg.controls['nextSlideCondition'];\n              this._editConditionDialog = this._dialog.open(AjfFbConditionEditorDialog);\n              this._editConditionDialog.componentInstance.condition = ctrl.value;\n              this._editConditionDialogSub =\n                  this._editConditionDialog.afterClosed().subscribe((cond: string) => {\n                    if (cond !== void 0) {\n                      ctrl.setValue(cond);\n                    }\n                    this._editConditionDialogSub.unsubscribe();\n                    this._editConditionDialogSub = Subscription.EMPTY;\n                    this._cdr.markForCheck();\n                  });\n            });\n  }\n\n  private _initFormulaEdit(): void {\n    this._editConditionDialogSub = Subscription.EMPTY;\n    this._cdr.markForCheck();\n    this._editFormulaSub =\n        this._editFormulaEvt\n            .pipe(\n                withLatestFrom(this._propertiesForm),\n                )\n            .subscribe(([_, formGroup]) => {\n              this._destroyConditionDialog();\n              if (formGroup == null) {\n                return;\n              }\n              const fg = formGroup as FormGroup;\n              const ctrl = fg.controls['formula'];\n              this._editConditionDialog = this._dialog.open(AjfFbConditionEditorDialog);\n              this._editConditionDialog.componentInstance.condition = ctrl.value;\n              this._editConditionDialogSub =\n                  this._editConditionDialog.afterClosed().subscribe((cond: string) => {\n                    if (cond !== void 0) {\n                      ctrl.setValue(cond);\n                    }\n                    this._editConditionDialogSub.unsubscribe();\n                    this._editConditionDialogSub = Subscription.EMPTY;\n                    this._cdr.markForCheck();\n                  });\n            });\n  }\n\n  private _initFormulaRepsEdit(): void {\n    this._editFormulaRepsSub =\n        this._editFormulaRepsEvt\n            .pipe(\n                withLatestFrom(this._propertiesForm),\n                )\n            .subscribe(([_, formGroup]) => {\n              this._destroyConditionDialog();\n              if (formGroup == null) {\n                return;\n              }\n              const fg = formGroup as FormGroup;\n              const ctrl = fg.controls['formulaReps'];\n              this._editConditionDialog = this._dialog.open(AjfFbConditionEditorDialog);\n              this._editConditionDialog.componentInstance.condition = ctrl.value;\n              this._editConditionDialogSub =\n                  this._editConditionDialog.afterClosed().subscribe((cond: string) => {\n                    if (cond !== void 0) {\n                      ctrl.setValue(cond);\n                    }\n                    this._editConditionDialogSub.unsubscribe();\n                    this._editConditionDialogSub = Subscription.EMPTY;\n                    this._cdr.markForCheck();\n                  });\n            });\n  }\n\n  private _initChoicesFilterEdit(): void {\n    this._editChoicesFilterSub =\n        this._editChoicesFilterEvt\n            .pipe(\n                withLatestFrom(this._propertiesForm),\n                )\n            .subscribe(([_, formGroup]) => {\n              this._destroyConditionDialog();\n              if (formGroup == null) {\n                return;\n              }\n              const fg = formGroup as FormGroup;\n              const ctrl = fg.controls['choicesFilter'];\n              this._editConditionDialog = this._dialog.open(AjfFbConditionEditorDialog);\n              this._editConditionDialog.componentInstance.condition = ctrl.value;\n              this._editConditionDialogSub =\n                  this._editConditionDialog.afterClosed().subscribe((cond: string) => {\n                    if (cond !== void 0) {\n                      ctrl.setValue(cond);\n                    }\n                    this._editConditionDialogSub.unsubscribe();\n                    this._editConditionDialogSub = Subscription.EMPTY;\n                    this._cdr.markForCheck();\n                  });\n            });\n  }\n\n  private _initConditionalBranchEdit(): void {\n    this._editConditionalBranchSub =\n        this._editConditionalBranchEvt\n            .pipe(\n                withLatestFrom(this._propertiesForm),\n                )\n            .subscribe(([cbIdx, fg]) => {\n              this._destroyConditionDialog();\n              if (cbIdx < 0 || cbIdx >= this._conditionalBranches.length || fg == null) {\n                return;\n              }\n              this._editConditionDialog = this._dialog.open(AjfFbConditionEditorDialog);\n              this._editConditionDialog.componentInstance.condition =\n                  this._conditionalBranches[cbIdx];\n              this._editConditionDialogSub =\n                  this._editConditionDialog.afterClosed().subscribe((cond: string) => {\n                    if (cond !== void 0) {\n                      this._conditionalBranches[cbIdx] = cond;\n                    }\n                    this._editConditionDialogSub.unsubscribe();\n                    this._editConditionDialogSub = Subscription.EMPTY;\n                    this._cdr.markForCheck();\n                  });\n            });\n  }\n\n  private _initVisibilityEdit(): void {\n    this._editVisibilitySub =\n        this._editVisibilityEvt\n            .pipe(\n                withLatestFrom(this._propertiesForm),\n                )\n            .subscribe(([_, formGroup]) => {\n              this._destroyConditionDialog();\n              if (formGroup == null) {\n                return;\n              }\n              const fg = formGroup as FormGroup;\n              const ctrl = fg.controls['visibility'];\n              const condition = ctrl.value;\n              this._editConditionDialog = this._dialog.open(AjfFbConditionEditorDialog);\n              this._editConditionDialog.componentInstance.condition = condition;\n              this._editConditionDialogSub =\n                  this._editConditionDialog.afterClosed().subscribe((cond: string) => {\n                    if (cond !== void 0) {\n                      ctrl.setValue(cond);\n                    }\n                    this._editConditionDialogSub.unsubscribe();\n                    this._editConditionDialogSub = Subscription.EMPTY;\n                    this._cdr.markForCheck();\n                  });\n            });\n  }\n\n  private _handleTriggerCondtionsChange(fg: FormGroup): void {\n    this._triggerConditionsSub = fg.valueChanges\n                                     .pipe(\n                                         distinctUntilChanged(\n                                             (v1, v2) => JSON.stringify(v1.triggerConditions) ===\n                                                 JSON.stringify(v2.triggerConditions)),\n                                         )\n                                     .subscribe((v: any) => {\n                                       this._triggerConditions = v.triggerConditions;\n                                       this._cdr.markForCheck();\n                                     });\n  }\n\n  private _handleWarningCondtionsChange(fg: FormGroup): void {\n    this._warningConditionsSub = fg.valueChanges\n                                     .pipe(\n                                         distinctUntilChanged(\n                                             (v1, v2) => JSON.stringify(v1.warningConditions) ===\n                                                 JSON.stringify(v2.warningConditions)),\n                                         )\n                                     .subscribe((v: any) => {\n                                       this._warningConditions = v.warningConditions;\n                                       this._cdr.markForCheck();\n                                     });\n  }\n\n  private _handleValidationCondtionsChange(fg: FormGroup): void {\n    this._validationConditionsSub =\n        fg.valueChanges\n            .pipe(\n                distinctUntilChanged(\n                    (v1, v2) => JSON.stringify(v1.validationConditions) ===\n                        JSON.stringify(v2.validationConditions)),\n                )\n            .subscribe((v: any) => {\n              this._validationConditions = v.validationConditions;\n              this._cdr.markForCheck();\n            });\n  }\n\n  private _handleForceValueChange(fg: FormGroup): void {\n    this._forceValueSub =\n        fg.valueChanges.pipe(distinctUntilChanged((v1, v2) => v1.forceValue === v2.forceValue))\n            .subscribe((v: any) => {\n              this._curForceValue = v.forceValue;\n              this._cdr.markForCheck();\n            });\n  }\n\n  private _handleNextSlideConditionChange(fg: FormGroup): void {\n    this._formulaSub =\n        fg.valueChanges\n            .pipe(distinctUntilChanged((v1, v2) => v1.nextSlideCondition === v2.nextSlideCondition))\n            .subscribe((v: any) => {\n              this._nextSlideCondition = v.nextSlideCondition;\n              this._cdr.markForCheck();\n            });\n    this._formulaSub =\n        fg.valueChanges\n            .pipe(distinctUntilChanged((v1, v2) => v1.nextSlideCondition === v2.nextSlideCondition))\n            .subscribe((v: any) => {\n              this._nextSlideCondition = v.nextSlideCondition;\n              this._cdr.markForCheck();\n            });\n  }\n\n  private _handleFormulaChange(fg: FormGroup): void {\n    this._formulaSub =\n        fg.valueChanges.pipe(distinctUntilChanged((v1, v2) => v1.formula === v2.formula))\n            .subscribe((v: any) => {\n              this._curFormula = v.formula;\n              this._cdr.markForCheck();\n            });\n  }\n\n  private _handleFormulaRepsChange(fg: FormGroup): void {\n    this._formulaRepsSub =\n        fg.valueChanges.pipe(distinctUntilChanged((v1, v2) => v1.formulaReps === v2.formulaReps))\n            .subscribe((v: any) => {\n              this._curFormulaReps = v.formulaReps;\n              this._cdr.markForCheck();\n            });\n  }\n\n  private _handleChoicesFilterChange(fg: FormGroup): void {\n    this._choicesFilterSub =\n        fg.valueChanges\n            .pipe(distinctUntilChanged((v1, v2) => v1.choicesFilter === v2.choicesFilter))\n            .subscribe((v: any) => {\n              this._curChoicesFilter = v.choicesFilter;\n              this._cdr.markForCheck();\n            });\n  }\n\n  private _handleConditionalBranchesChange(fg: FormGroup): void {\n    this._conditionalBranchesSub =\n        fg.valueChanges\n            .pipe(distinctUntilChanged(\n                (v1, v2) => v1.conditionalBranchesNum === v2.conditionalBranchesNum))\n            .subscribe((v: any) => {\n              const cbNum: number = v.conditionalBranchesNum;\n              const curCbNum = this._conditionalBranches.length;\n              if (curCbNum < cbNum) {\n                let newCbs: string[] = [];\n                for (let i = curCbNum; i < cbNum; i++) {\n                  newCbs.push(alwaysCondition().condition);\n                }\n                this._conditionalBranches = this._conditionalBranches.concat(newCbs);\n              } else if (curCbNum > cbNum) {\n                this._conditionalBranches.splice(0, curCbNum - cbNum);\n              }\n              this._cdr.markForCheck();\n            });\n  }\n\n  private _handleVisibilityChange(fg: FormGroup): void {\n    this._visibilitySub =\n        fg.valueChanges\n            .pipe(distinctUntilChanged((v1, v2) => v1.visibilityOpt === v2.visibilityOpt))\n            .subscribe((v) => {\n              const visibilityOpt = v.visibilityOpt;\n              let newCondition: string|null;\n              switch (visibilityOpt) {\n                case 'always':\n                  newCondition = alwaysCondition().condition;\n                  break;\n                case 'never':\n                  newCondition = neverCondition().condition;\n                  break;\n                default:\n                  newCondition = null;\n              }\n              this._curVisibility = newCondition;\n              fg.controls['visibility'].setValue(newCondition);\n            });\n    this._visibilitySub = fg.valueChanges\n                              .pipe(\n                                  filter(v => v.visibilityOpt === 'condition'),\n                                  distinctUntilChanged((v1, v2) => v1.visibility === v2.visibility),\n                                  )\n                              .subscribe(v => {\n                                this._curVisibility = v.visibility;\n                                this._cdr.markForCheck();\n                              });\n  }\n\n  private _guessVisibilityOpt(condition: AjfCondition): string {\n    if (condition.condition.localeCompare(alwaysCondition().condition) === 0) {\n      return 'always';\n    }\n    if (condition.condition.localeCompare(neverCondition().condition) === 0) {\n      return 'never';\n    }\n    return 'condition';\n  }\n}\n","/**\n * @license\n * Copyright (C) Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {\n  ChangeDetectionStrategy,\n  ChangeDetectorRef,\n  Component,\n  Input,\n  ViewEncapsulation\n} from '@angular/core';\n\nimport {AjfFormBuilderNodeTypeEntry} from './form-builder-service';\n\n\n@Component({\n  selector: 'ajf-fb-node-type-entry',\n  templateUrl: 'node-type-entry.html',\n  styleUrls: ['node-type-entry.css'],\n  encapsulation: ViewEncapsulation.None,\n  changeDetection: ChangeDetectionStrategy.OnPush\n})\nexport class AjfFbNodeTypeEntry {\n  private _nodeType: AjfFormBuilderNodeTypeEntry;\n  get nodeType(): AjfFormBuilderNodeTypeEntry {\n    return this._nodeType;\n  }\n  @Input()\n  set nodeType(nodeType: AjfFormBuilderNodeTypeEntry) {\n    this._nodeType = nodeType;\n    this._cdr.markForCheck();\n  }\n\n  constructor(private _cdr: ChangeDetectorRef) {}\n}\n","/**\n * @license\n * Copyright (C) Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {AjfMonacoEditorModule} from '@ajf/material/monaco-editor';\nimport {AjfNodeIconModule} from '@ajf/material/node-icon';\nimport {DragDropModule} from '@angular/cdk/drag-drop';\nimport {CommonModule} from '@angular/common';\nimport {NgModule} from '@angular/core';\nimport {FormsModule, ReactiveFormsModule} from '@angular/forms';\nimport {MatAutocompleteModule} from '@angular/material/autocomplete';\nimport {MatButtonModule} from '@angular/material/button';\nimport {MatCardModule} from '@angular/material/card';\nimport {MatCheckboxModule} from '@angular/material/checkbox';\nimport {MatChipsModule} from '@angular/material/chips';\nimport {MatDialogModule} from '@angular/material/dialog';\nimport {MatExpansionModule} from '@angular/material/expansion';\nimport {MatFormFieldModule} from '@angular/material/form-field';\nimport {MatIconModule} from '@angular/material/icon';\nimport {MatInputModule} from '@angular/material/input';\nimport {MatListModule} from '@angular/material/list';\nimport {MatMenuModule} from '@angular/material/menu';\nimport {MatSelectModule} from '@angular/material/select';\nimport {MatSidenavModule} from '@angular/material/sidenav';\nimport {MatSlideToggleModule} from '@angular/material/slide-toggle';\nimport {MatSliderModule} from '@angular/material/slider';\nimport {MatTableModule} from '@angular/material/table';\nimport {MatToolbarModule} from '@angular/material/toolbar';\nimport {MatTooltipModule} from '@angular/material/tooltip';\nimport {TranslateModule} from '@ngx-translate/core';\n\nimport {AjfFbBranchLine} from './branch-line';\nimport {AjfFbChoicesOriginEditor} from './choices-origin-editor';\nimport {AjfFbChoicesOriginEditorDialog} from './choices-origin-editor-dialog';\nimport {AjfFbConditionEditor} from './condition-editor';\nimport {AjfFbConditionEditorDialog} from './condition-editor-dialog';\nimport {AjfFormBuilder} from './form-builder';\nimport {AjfFormBuilderService} from './form-builder-service';\nimport {AjfFbNodeEntry} from './node-entry';\nimport {AjfFbNodeProperties} from './node-properties';\nimport {AjfFbNodeTypeEntry} from './node-type-entry';\nimport {AjfFbStringIdentifierDialogComponent} from './string-identifier-dialog';\nimport {AjfFbValidationConditionEditorDialog} from './validation-condition-editor-dialog';\nimport {AjfFbWarningConditionEditorDialog} from './warning-condition-editor-dialog';\n\n@NgModule({\n  imports: [\n    AjfMonacoEditorModule, AjfNodeIconModule,     CommonModule,        DragDropModule,\n    FormsModule,           MatAutocompleteModule, MatButtonModule,     MatCardModule,\n    MatCheckboxModule,     MatChipsModule,        MatDialogModule,     MatFormFieldModule,\n    MatIconModule,         MatInputModule,        MatListModule,       MatMenuModule,\n    MatSelectModule,       MatSidenavModule,      MatSliderModule,     MatTableModule,\n    MatToolbarModule,      MatTooltipModule,      ReactiveFormsModule, TranslateModule,\n    MatExpansionModule,    MatSlideToggleModule,\n\n  ],\n  declarations: [\n    AjfFbBranchLine,\n    AjfFbChoicesOriginEditor,\n    AjfFbChoicesOriginEditorDialog,\n    AjfFbConditionEditor,\n    AjfFbConditionEditorDialog,\n    AjfFbNodeEntry,\n    AjfFbNodeProperties,\n    AjfFbNodeTypeEntry,\n    AjfFbStringIdentifierDialogComponent,\n    AjfFbValidationConditionEditorDialog,\n    AjfFbWarningConditionEditorDialog,\n    AjfFormBuilder,\n  ],\n  exports: [\n    AjfFormBuilder,\n  ],\n  providers: [\n    AjfFormBuilderService,\n  ],\n})\nexport class AjfFormBuilderModule {\n}\n","/**\n * @license\n * Copyright (C) Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nexport * from './form-builder-module';\nexport * from './form-builder-service';\nexport * from './form-builder-utils';\nexport * from './form-builder';\n","/**\n * Generated bundle index. Do not edit.\n */\n\nexport * from './public-api';\n\nexport {AjfFbBranchLine as gc_ajf_src_material_form_builder_form_builder_a} from './branch-line';\nexport {AjfFbChoicesOriginEditor as gc_ajf_src_material_form_builder_form_builder_b} from './choices-origin-editor';\nexport {AjfFbChoicesOriginEditorDialog as gc_ajf_src_material_form_builder_form_builder_c} from './choices-origin-editor-dialog';\nexport {AjfFbConditionEditor as gc_ajf_src_material_form_builder_form_builder_d} from './condition-editor';\nexport {AjfFbConditionEditorDialog as gc_ajf_src_material_form_builder_form_builder_e} from './condition-editor-dialog';\nexport {AjfFbNodeEntry as gc_ajf_src_material_form_builder_form_builder_f} from './node-entry';\nexport {AjfFbNodeProperties as gc_ajf_src_material_form_builder_form_builder_g} from './node-properties';\nexport {AjfFbNodeTypeEntry as gc_ajf_src_material_form_builder_form_builder_h} from './node-type-entry';\nexport {AjfFbStringIdentifierDialogComponent as gc_ajf_src_material_form_builder_form_builder_i} from './string-identifier-dialog';\nexport {AjfFbValidationConditionEditorDialog as gc_ajf_src_material_form_builder_form_builder_j} from './validation-condition-editor-dialog';\nexport {AjfFbWarningConditionEditorDialog as gc_ajf_src_material_form_builder_form_builder_k} from './warning-condition-editor-dialog';"],"names":["Component","ViewEncapsulation","ChangeDetectionStrategy","ElementRef","Renderer2","Input","BehaviorSubject","DataSource","isChoicesFixedOrigin","isContainerNode","AjfNodeType","AjfFieldType","EventEmitter","Subject","Subscription","createField","createContainerNode","combineLatest","filter","map","createForm","createChoicesFixedOrigin","isSlidesNode","scan","publishReplay","refCount","isFieldWithChoices","deepCopy","withLatestFrom","createCondition","alwaysCondition","isRepeatingContainerNode","createFormula","isField","createValidationGroup","notEmptyValidation","minValidation","maxValidation","minDigitsValidation","maxDigitsValidation","createValidation","createWarningGroup","notEmptyWarning","createWarning","moveItemInArray","Injectable","ViewChild","AjfExpressionUtils","AjfValidationService","AjfMonacoEditor","MatDialogRef","MatTableDataSource","ENTER","COMMA","shareReplay","ChangeDetectorRef","sample","MatDialog","ViewChildren","isNumberField","Validators","distinctUntilChanged","neverCondition","FormBuilder","NgModule","AjfMonacoEditorModule","AjfNodeIconModule","CommonModule","DragDropModule","FormsModule","MatAutocompleteModule","MatButtonModule","MatCardModule","MatCheckboxModule","MatChipsModule","MatDialogModule","MatFormFieldModule","MatIconModule","MatInputModule","MatListModule","MatMenuModule","MatSelectModule","MatSidenavModule","MatSliderModule","MatTableModule","MatToolbarModule","MatTooltipModule","ReactiveFormsModule","TranslateModule","MatExpansionModule","MatSlideToggleModule"],"mappings":"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"}