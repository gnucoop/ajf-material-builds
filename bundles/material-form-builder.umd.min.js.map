{"version":3,"sources":["src/material/material-form-builder.umd.js"],"names":["global","factory","exports","module","require","define","amd","self","ajf","material","formBuilder","monacoEditor","nodeIcon","ng","cdk","dragDrop","common","core","forms","autocomplete","button","card","checkbox","chips","dialog","expansionPanel","formField","icon","input","list","menu","select","sidenav","slideToggle","slider","table","toolbar","tooltip","ngxTranslate","collections","rxjs","operators","models","utils","keycodes","this","expansion","core$1","forms$1","AjfFbBranchLine","_el","_renderer","_offset","_height","Object","defineProperty","prototype","set","offset","_updateOffset","enumerable","configurable","color","_color","_updateColor","height","_updateHeight","Math","max","setStyle","nativeElement","margin","decorators","type","Component","args","selector","template","encapsulation","ViewEncapsulation","None","changeDetection","ChangeDetectionStrategy","OnPush","styles","ctorParameters","ElementRef","Renderer2","propDecorators","Input","extendStatics","d","b","setPrototypeOf","__proto__","Array","p","hasOwnProperty","call","__read","o","n","m","Symbol","iterator","r","e","i","ar","next","done","push","value","error","__spreadArray","to","from","il","length","j","ChoicesOriginDataSource","_super","_this","_choices","BehaviorSubject","_choicesObs","__extends","TypeError","String","__","constructor","create","connect","disconnect","updateChoices","choices","DataSource","AjfFbChoicesOriginEditor","_displayedColumns","editing","_choicesArr","get","_choicesOrigin","choicesOrigin","name","label","canEditChoices","isChoicesFixedOrigin","updateValue","evt","cell","_value","rowIdx","target","deleteRow","splice","addRow","getNodeContainer","c","node","nodes","indexOf","cns","filter","isContainerNode","len","cn","buildFormBuilderNodesSubtree","parent","ignoreConditionalBranches","entries","id","sort","n1","n2","parentNode","map","children","content","buildFormBuilderNodesContent","cbs","conditionalBranches","_nodes","flattenNodes","flatNodes","forEach","concat","getDescendants","branch","deleteNodeSubtree","delNodes","descendants","removeNodes","ids","nodeUniqueId","AjfFormBuilderService","_availableNodeTypes","fontSet","fontIcon","nodeType","AjfNodeType","AjfSlide","isSlide","AjfRepeatingSlide","AjfField","field","AjfFieldType","Text","Number","Boolean","SingleChoice","MultipleChoice","Formula","Date","DateInput","Time","Table","_form","_formObs","_connectedDropLists","_editedNodeEntry","_editedNodeEntryObs","_editedCondition","_editedConditionObs","_editedChoicesOrigin","_editedChoicesOriginObs","_beforeNodesUpdate","EventEmitter","_beforeNodesUpdateObs","_afterNodeUpdate","_afterNodeUpdateObs","_nodesUpdates","Subject","_attachmentsOriginsUpdates","_choicesOriginsUpdates","_stringIdentifierUpdates","_saveNodeEntryEvent","_deleteNodeEntryEvent","_moveNodeEntryEvent","_moveNodeSub","Subscription","EMPTY","_initChoicesOriginsStreams","_initAttachmentsOriginsStreams","_initStringIdentifierStreams","_initNodesStreams","_initFormStreams","_initSaveNode","_initMoveNode","_initDeleteNode","_attachmentsOrigins","_choicesOrigins","_stringIdentifier","_flatNodes","_flatFields","_nodeEntriesTree","setForm","form","getValue","editNodeEntry","nodeEntry","editCondition","condition","saveCurrentCondition","cancelConditionEdit","assignListId","empty","listId","_connectDropList","insertNode","inContent","insertInIndex","_a","isFieldNode","createField","fieldType","createContainerNode","emit","newNodes","slice","_updateNodesList","saveNodeEntry","properties","cancelNodeEntryEdit","deleteNodeEntry","moveNodeEntry","fromIndex","toIndex","getCurrentForm","combineLatest","_nodesWithoutChoiceOrigins","attachmentsOrigins","choicesOrigins","stringIdentifier","pipe","_b","_c","createForm","supplementaryInformations","editChoicesOrigin","createChoicesOrigin","createChoicesFixedOrigin","cancelChoicesOriginEdit","saveChoicesOrigin","params","idx","saveStringIdentifier","identifier","_buildFormBuilderNodesTree","rootNodes","rootNode","isSlidesNode","tree","container","Error","connectedLists","_findMaxNodeId","_curMaxId","maxId","subscribe","_","scan","op","publishReplay","refCount","slides","slide","isFieldWithChoices","fwc","deepCopy","withLatestFrom","editedNodeEntry","ne","origNode","visibility","createCondition","oldConditionalBranches","alwaysCondition","newConditionalBranches","isRepeatingContainerNode","repNode","formulaReps","createFormula","formula","undefined","minReps","maxReps","isField","description","defaultValue","forceValue","notEmpty","validationConditions","minValue","parseInt","maxValue","minDigits","maxDigits","isNaN","validation","createValidationGroup","notEmptyValidation","minValidation","maxValidation","minDigitsValidation","maxDigitsValidation","conditions","createValidation","errorMessage","notEmptyWarn","notEmptyWarning","warningConditions","warning","createWarningGroup","w","createWarning","warningMessage","nextSlideCondition","size","choicesOriginRef","forceExpanded","forceNarrow","triggerConditions","t","replaceNodes","unsubscribe","moveEvent","moveItemInArray","containerId","nodesList","contId","currentNode","Injectable","AjfFbChoicesOriginEditorDialog","_service","editedChoicesOrigin","editor","choicesArr","ViewChild","static","AjfFbConditionEditor","_fields","fields","_updateVariables","insertVariable","variable","split","position","getPosition","ln","lineNumber","line","col","column","substring","join","setPosition","focus","editedValue","onEditorInit","monaco","languages","typescript","javascriptDefaults","setDiagnosticsOptions","noSemanticValidation","noSyntaxValidation","setCompilerOptions","ScriptTarget","ES2015","allowNonTsExtensions","allowJs","ModuleKind","addExtraLib","_extraLibs","_updateFunctions","_fieldVarType","AjfExpressionUtils","UTIL_FUNCTIONS","Empty","AjfValidationService","AjfMonacoEditor","AjfFbConditionEditorDialog","service","dialogRef","flatFields","f1","f2","localeCompare","saveCondition","close","onDropProcess","event","fbService","itemData","item","data","previousIndex","currentIndex","emptySlot","disableSlideDropPredicate","disableFieldDropPredicate","MatDialogRef","AjfFbStringIdentifierDialogComponent","_cdr","dataSource","MatTableDataSource","displayedColumns","separatorKeysCodes","ENTER","COMMA","_stringIdentifierSub","fields$","f","shareReplay","addValue","row","valueInput","markForCheck","removeValue","ngOnDestroy","selected","option","ChangeDetectorRef","AjfFormBuilder","_dialog","_globalExpanded","connectedDropLists","_vc","_init","_editConditionSub","_beforeNodesUpdateSub","_editChoicesOriginSub","_nodeTypes","availableNodeTypes","nodeEntriesTree","editedCondition","_editConditionDialog","open","disableClose","_editChoicesOriginDialog","beforeNodesUpdate","designerCont","_lastScrollTop","scrollTop","sample","_setCurrentForm","ngAfterViewChecked","ngAfterContentInit","disableDrop","disableFieldDrop","onDrop","editStringIdentifier","_stringIdentifierDialog","width","expandAll","collapseAll","expandToggle","checked","MatDialog","branchColors","AjfFbNodeEntry","_hasContent","_isFirst","_isNodeEntry","_isExpanded","_level","_isDraggable","_branchColors","_dropZones","_slideDropZones","_originOffset","_originLeftMargin","_firstBranchColor","_branchLinesSubscription","_childEntriesSubscription","_currentEditedNode","isFirst","exp","setTimeout","_updateBranchHeights","_nodeEntry","draggable","originOffset","firstBranchColor","onResize","edit","stopPropagation","isNodeEntry","delete","isLastNode","realNodeEntry","ngAfterViewInit","childEntries","changes","assignId","disableSlideDrop","emptyAreaDropPredicate","_drop","branchLines","toArray","sliceIdx","bl","offsetTop","host","(window.resize)","ViewChildren","read","isExpanded","level","isDraggable","AjfFbValidationConditionEditorDialog","AjfFbWarningConditionEditorDialog","checkRepsValidity","reps","checkValueLimitsValidity","valueLimit","checkDigitsValidity","digits","AjfFbNodeProperties","_fb","_fieldSizes","_conditionalBranches","_validationConditions","_warningConditions","_visibilityOptSub","_visibilitySub","_conditionalBranchesSub","_formulaRepsSub","_choicesFilterSub","_formulaSub","_forceValueSub","_validationConditionsSub","_warningConditionsSub","_nextSlideConditionSub","_choicesOriginsSub","_triggerConditionsSub","_editConditionDialogSub","_editValidationConditionDialogSub","_editWarningConditionDialogSub","_editVisibilityEvt","_editVisibilitySub","_editConditionalBranchEvt","_editConditionalBranchSub","_editFormulaRepsEvt","_editFormulaRepsSub","_editChoicesFilterEvt","_editChoicesFilterSub","_editFormulaEvt","_editFormulaSub","_editForceValueEvt","_editForceValueSub","_editValidationConditionEvt","_editValidationConditionSub","_addValidationConditionEvt","_addValidationConditionSub","_removeValidationConditionEvt","_removeValidationConditionSub","_editWarningConditionEvt","_editWarningConditionSub","_addWarningConditionEvt","_addWarningConditionSub","_removeWarningConditionEvt","_removeWarningConditionSub","_editNextSlideConditionEvt","_editNextSlideConditionSub","_editTriggerConditionEvt","_editTriggerConditionSub","_addTriggerConditionEvt","_addTriggerConditionSub","_removeTriggerConditionEvt","_removeTriggerConditionSub","_saveEvt","_saveSub","_enabled","_initForm","_initVisibilityEdit","_initConditionalBranchEdit","_initFormulaRepsEdit","_initChoicesFilterEdit","_initFormulaEdit","_initForceValueEdit","_initValidationConditionEdit","_initAddValidationCondition","_initRemoveValidationCondition","_initWarningConditionEdit","_initAddWarningCondition","_initRemoveWarningCondition","_initNextSlideConditionEdit","_initTriggerConditionEdit","_initAddTriggerCondition","_initRemoveTriggerCondition","_initSave","_propertiesForm","_hasChoices","_curVisibility","_curFormulaReps","_curChoicesFilter","_curForceValue","_curFormula","_nextSlideCondition","_triggerConditions","editVisibility","editConditionalBranch","editFormulaReps","editChoicesFilter","editFormula","editForceValue","editValidationCondition","addValidationCondition","removeValidationCondition","editWarningCondition","addWarningCondition","removeWarningCondition","editNextSlideCondition","editTriggerCondition","addTriggerCondition","removeTriggerCondition","isNumericField","isNumberField","save","cancel","propertiesForm","val","assign","visibilityOpt","_guessVisibilityOpt","controls","Validators","required","conditionalBranchesNum","validators","rn","notEmptyW","hint","numField","replace","fieldWithChoices","choicesFilter","fg","group","setValidators","_handleConditionalBranchesChange","_handleVisibilityChange","_handleFormulaRepsChange","_handleChoicesFilterChange","_handleFormulaChange","_handleForceValueChange","_handleValidationCondtionsChange","_handleWarningCondtionsChange","_handleNextSlideConditionChange","_handleTriggerCondtionsChange","_destroyConditionDialog","_destroyValidationConditionDialog","_editValidationConditionDialog","_destroyWarningConditionDialog","_editWarningConditionDialog","vcIdx","formGroup","ctrl","vcs","setValue","componentInstance","afterClosed","cond","cmp","v","cbIdx","valueChanges","distinctUntilChanged","v1","v2","JSON","stringify","cbNum","curCbNum","newCbs","newCondition","neverCondition","FormBuilder","AjfFormBuilderModule","AjfFbNodeTypeEntry","_nodeType","NgModule","imports","AjfMonacoEditorModule","AjfNodeIconModule","CommonModule","DragDropModule","FormsModule","MatAutocompleteModule","MatButtonModule","MatCardModule","MatCheckboxModule","MatChipsModule","MatDialogModule","MatFormFieldModule","MatIconModule","MatInputModule","MatListModule","MatMenuModule","MatSelectModule","MatSidenavModule","MatSliderModule","MatTableModule","MatToolbarModule","MatTooltipModule","ReactiveFormsModule","TranslateModule","MatExpansionModule","MatSlideToggleModule","declarations","providers","ɵgc_ajf_src_material_form_builder_form_builder_a","ɵgc_ajf_src_material_form_builder_form_builder_b","ɵgc_ajf_src_material_form_builder_form_builder_c","ɵgc_ajf_src_material_form_builder_form_builder_d","ɵgc_ajf_src_material_form_builder_form_builder_e","ɵgc_ajf_src_material_form_builder_form_builder_f","ɵgc_ajf_src_material_form_builder_form_builder_g","ɵgc_ajf_src_material_form_builder_form_builder_h","ɵgc_ajf_src_material_form_builder_form_builder_i","ɵgc_ajf_src_material_form_builder_form_builder_j","ɵgc_ajf_src_material_form_builder_form_builder_k"],"mappings":"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","sourcesContent":["(function (global, factory) {\n    typeof exports === 'object' && typeof module !== 'undefined' ? factory(exports, require('@ajf/material/monaco-editor'), require('@ajf/material/node-icon'), require('@angular/cdk/drag-drop'), require('@angular/common'), require('@angular/core'), require('@angular/forms'), require('@angular/material/autocomplete'), require('@angular/material/button'), require('@angular/material/card'), require('@angular/material/checkbox'), require('@angular/material/chips'), require('@angular/material/dialog'), require('@angular/material/expansion'), require('@angular/material/form-field'), require('@angular/material/icon'), require('@angular/material/input'), require('@angular/material/list'), require('@angular/material/menu'), require('@angular/material/select'), require('@angular/material/sidenav'), require('@angular/material/slide-toggle'), require('@angular/material/slider'), require('@angular/material/table'), require('@angular/material/toolbar'), require('@angular/material/tooltip'), require('@ngx-translate/core'), require('@ajf/core/forms'), require('@angular/cdk/collections'), require('rxjs'), require('rxjs/operators'), require('@ajf/core/models'), require('@ajf/core/utils'), require('@angular/cdk/keycodes')) :\n    typeof define === 'function' && define.amd ? define('@ajf/material/form-builder', ['exports', '@ajf/material/monaco-editor', '@ajf/material/node-icon', '@angular/cdk/drag-drop', '@angular/common', '@angular/core', '@angular/forms', '@angular/material/autocomplete', '@angular/material/button', '@angular/material/card', '@angular/material/checkbox', '@angular/material/chips', '@angular/material/dialog', '@angular/material/expansion', '@angular/material/form-field', '@angular/material/icon', '@angular/material/input', '@angular/material/list', '@angular/material/menu', '@angular/material/select', '@angular/material/sidenav', '@angular/material/slide-toggle', '@angular/material/slider', '@angular/material/table', '@angular/material/toolbar', '@angular/material/tooltip', '@ngx-translate/core', '@ajf/core/forms', '@angular/cdk/collections', 'rxjs', 'rxjs/operators', '@ajf/core/models', '@ajf/core/utils', '@angular/cdk/keycodes'], factory) :\n    (global = global || self, factory((global.ajf = global.ajf || {}, global.ajf.material = global.ajf.material || {}, global.ajf.material.formBuilder = {}), global.ajf.material.monacoEditor, global.ajf.material.nodeIcon, global.ng.cdk.dragDrop, global.ng.common, global.ng.core, global.ng.forms, global.ng.material.autocomplete, global.ng.material.button, global.ng.material.card, global.ng.material.checkbox, global.ng.material.chips, global.ng.material.dialog, global.ng.material.expansionPanel, global.ng.material.formField, global.ng.material.icon, global.ng.material.input, global.ng.material.list, global.ng.material.menu, global.ng.material.select, global.ng.material.sidenav, global.ng.material.slideToggle, global.ng.material.slider, global.ng.material.table, global.ng.material.toolbar, global.ng.material.tooltip, global.ngxTranslate.core, global.ajf.core.forms, global.ng.cdk.collections, global.rxjs, global.rxjs.operators, global.ajf.core.models, global.ajf.core.utils, global.ng.cdk.keycodes));\n}(this, (function (exports, monacoEditor, nodeIcon, dragDrop, common, core, forms, autocomplete, button, card, checkbox, chips, dialog, expansion, formField, icon, input, list, menu, select, sidenav, slideToggle, slider, table, toolbar, tooltip, core$1, forms$1, collections, rxjs, operators, models, utils, keycodes) { 'use strict';\n\n    /**\n     * @license\n     * Copyright (C) Gnucoop soc. coop.\n     *\n     * This file is part of the Advanced JSON forms (ajf).\n     *\n     * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n     * modify it under the terms of the GNU Affero General Public License as\n     * published by the Free Software Foundation, either version 3 of the License,\n     * or (at your option) any later version.\n     *\n     * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n     * but WITHOUT ANY WARRANTY; without even the implied warranty of\n     * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n     * General Public License for more details.\n     *\n     * You should have received a copy of the GNU Affero General Public License\n     * along with Advanced JSON forms (ajf).\n     * If not, see http://www.gnu.org/licenses/.\n     *\n     */\n    var AjfFbBranchLine = /** @class */ (function () {\n        function AjfFbBranchLine(_el, _renderer) {\n            this._el = _el;\n            this._renderer = _renderer;\n            this._offset = 0;\n            this._height = 0;\n        }\n        Object.defineProperty(AjfFbBranchLine.prototype, \"offset\", {\n            set: function (offset) {\n                this._offset = offset;\n                this._updateOffset();\n            },\n            enumerable: false,\n            configurable: true\n        });\n        Object.defineProperty(AjfFbBranchLine.prototype, \"color\", {\n            set: function (color) {\n                this._color = color;\n                this._updateColor();\n            },\n            enumerable: false,\n            configurable: true\n        });\n        Object.defineProperty(AjfFbBranchLine.prototype, \"height\", {\n            set: function (height) {\n                this._height = height;\n                this._updateHeight();\n            },\n            enumerable: false,\n            configurable: true\n        });\n        AjfFbBranchLine.prototype._updateHeight = function () {\n            var height = Math.max(0, this._height - 25) + \"px\";\n            this._renderer.setStyle(this._el.nativeElement, 'height', height);\n        };\n        AjfFbBranchLine.prototype._updateOffset = function () {\n            var margin = this._offset * 4 + \"px\";\n            this._renderer.setStyle(this._el.nativeElement, 'margin-top', margin);\n            this._renderer.setStyle(this._el.nativeElement, 'margin-left', margin);\n        };\n        AjfFbBranchLine.prototype._updateColor = function () {\n            this._renderer.setStyle(this._el.nativeElement, 'border-color', this._color);\n        };\n        return AjfFbBranchLine;\n    }());\n    AjfFbBranchLine.decorators = [\n        { type: core.Component, args: [{\n                    selector: 'ajf-fb-branch-line',\n                    template: \"\",\n                    encapsulation: core.ViewEncapsulation.None,\n                    changeDetection: core.ChangeDetectionStrategy.OnPush,\n                    styles: [\"ajf-fb-branch-line{display:block;position:absolute;top:25px;left:25px;width:25px;border-top:2px solid;border-left:2px solid;border-top-left-radius:6px;transition:height .5s ease-in-out}\\n\"]\n                },] }\n    ];\n    AjfFbBranchLine.ctorParameters = function () { return [\n        { type: core.ElementRef },\n        { type: core.Renderer2 }\n    ]; };\n    AjfFbBranchLine.propDecorators = {\n        offset: [{ type: core.Input }],\n        color: [{ type: core.Input }],\n        height: [{ type: core.Input }]\n    };\n\n    /*! *****************************************************************************\n    Copyright (c) Microsoft Corporation.\n\n    Permission to use, copy, modify, and/or distribute this software for any\n    purpose with or without fee is hereby granted.\n\n    THE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\n    REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\n    AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\n    INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\n    LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR\n    OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\n    PERFORMANCE OF THIS SOFTWARE.\n    ***************************************************************************** */\n    /* global Reflect, Promise */\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b)\n                if (Object.prototype.hasOwnProperty.call(b, p))\n                    d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    function __extends(d, b) {\n        if (typeof b !== \"function\" && b !== null)\n            throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    }\n    var __assign = function () {\n        __assign = Object.assign || function __assign(t) {\n            for (var s, i = 1, n = arguments.length; i < n; i++) {\n                s = arguments[i];\n                for (var p in s)\n                    if (Object.prototype.hasOwnProperty.call(s, p))\n                        t[p] = s[p];\n            }\n            return t;\n        };\n        return __assign.apply(this, arguments);\n    };\n    function __rest(s, e) {\n        var t = {};\n        for (var p in s)\n            if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\n                t[p] = s[p];\n        if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\n            for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\n                if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\n                    t[p[i]] = s[p[i]];\n            }\n        return t;\n    }\n    function __decorate(decorators, target, key, desc) {\n        var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n        if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\")\n            r = Reflect.decorate(decorators, target, key, desc);\n        else\n            for (var i = decorators.length - 1; i >= 0; i--)\n                if (d = decorators[i])\n                    r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n        return c > 3 && r && Object.defineProperty(target, key, r), r;\n    }\n    function __param(paramIndex, decorator) {\n        return function (target, key) { decorator(target, key, paramIndex); };\n    }\n    function __metadata(metadataKey, metadataValue) {\n        if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\")\n            return Reflect.metadata(metadataKey, metadataValue);\n    }\n    function __awaiter(thisArg, _arguments, P, generator) {\n        function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n        return new (P || (P = Promise))(function (resolve, reject) {\n            function fulfilled(value) { try {\n                step(generator.next(value));\n            }\n            catch (e) {\n                reject(e);\n            } }\n            function rejected(value) { try {\n                step(generator[\"throw\"](value));\n            }\n            catch (e) {\n                reject(e);\n            } }\n            function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n            step((generator = generator.apply(thisArg, _arguments || [])).next());\n        });\n    }\n    function __generator(thisArg, body) {\n        var _ = { label: 0, sent: function () { if (t[0] & 1)\n                throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\n        return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function () { return this; }), g;\n        function verb(n) { return function (v) { return step([n, v]); }; }\n        function step(op) {\n            if (f)\n                throw new TypeError(\"Generator is already executing.\");\n            while (_)\n                try {\n                    if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done)\n                        return t;\n                    if (y = 0, t)\n                        op = [op[0] & 2, t.value];\n                    switch (op[0]) {\n                        case 0:\n                        case 1:\n                            t = op;\n                            break;\n                        case 4:\n                            _.label++;\n                            return { value: op[1], done: false };\n                        case 5:\n                            _.label++;\n                            y = op[1];\n                            op = [0];\n                            continue;\n                        case 7:\n                            op = _.ops.pop();\n                            _.trys.pop();\n                            continue;\n                        default:\n                            if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) {\n                                _ = 0;\n                                continue;\n                            }\n                            if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) {\n                                _.label = op[1];\n                                break;\n                            }\n                            if (op[0] === 6 && _.label < t[1]) {\n                                _.label = t[1];\n                                t = op;\n                                break;\n                            }\n                            if (t && _.label < t[2]) {\n                                _.label = t[2];\n                                _.ops.push(op);\n                                break;\n                            }\n                            if (t[2])\n                                _.ops.pop();\n                            _.trys.pop();\n                            continue;\n                    }\n                    op = body.call(thisArg, _);\n                }\n                catch (e) {\n                    op = [6, e];\n                    y = 0;\n                }\n                finally {\n                    f = t = 0;\n                }\n            if (op[0] & 5)\n                throw op[1];\n            return { value: op[0] ? op[1] : void 0, done: true };\n        }\n    }\n    var __createBinding = Object.create ? (function (o, m, k, k2) {\n        if (k2 === undefined)\n            k2 = k;\n        Object.defineProperty(o, k2, { enumerable: true, get: function () { return m[k]; } });\n    }) : (function (o, m, k, k2) {\n        if (k2 === undefined)\n            k2 = k;\n        o[k2] = m[k];\n    });\n    function __exportStar(m, o) {\n        for (var p in m)\n            if (p !== \"default\" && !Object.prototype.hasOwnProperty.call(o, p))\n                __createBinding(o, m, p);\n    }\n    function __values(o) {\n        var s = typeof Symbol === \"function\" && Symbol.iterator, m = s && o[s], i = 0;\n        if (m)\n            return m.call(o);\n        if (o && typeof o.length === \"number\")\n            return {\n                next: function () {\n                    if (o && i >= o.length)\n                        o = void 0;\n                    return { value: o && o[i++], done: !o };\n                }\n            };\n        throw new TypeError(s ? \"Object is not iterable.\" : \"Symbol.iterator is not defined.\");\n    }\n    function __read(o, n) {\n        var m = typeof Symbol === \"function\" && o[Symbol.iterator];\n        if (!m)\n            return o;\n        var i = m.call(o), r, ar = [], e;\n        try {\n            while ((n === void 0 || n-- > 0) && !(r = i.next()).done)\n                ar.push(r.value);\n        }\n        catch (error) {\n            e = { error: error };\n        }\n        finally {\n            try {\n                if (r && !r.done && (m = i[\"return\"]))\n                    m.call(i);\n            }\n            finally {\n                if (e)\n                    throw e.error;\n            }\n        }\n        return ar;\n    }\n    /** @deprecated */\n    function __spread() {\n        for (var ar = [], i = 0; i < arguments.length; i++)\n            ar = ar.concat(__read(arguments[i]));\n        return ar;\n    }\n    /** @deprecated */\n    function __spreadArrays() {\n        for (var s = 0, i = 0, il = arguments.length; i < il; i++)\n            s += arguments[i].length;\n        for (var r = Array(s), k = 0, i = 0; i < il; i++)\n            for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\n                r[k] = a[j];\n        return r;\n    }\n    function __spreadArray(to, from) {\n        for (var i = 0, il = from.length, j = to.length; i < il; i++, j++)\n            to[j] = from[i];\n        return to;\n    }\n    function __await(v) {\n        return this instanceof __await ? (this.v = v, this) : new __await(v);\n    }\n    function __asyncGenerator(thisArg, _arguments, generator) {\n        if (!Symbol.asyncIterator)\n            throw new TypeError(\"Symbol.asyncIterator is not defined.\");\n        var g = generator.apply(thisArg, _arguments || []), i, q = [];\n        return i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i;\n        function verb(n) { if (g[n])\n            i[n] = function (v) { return new Promise(function (a, b) { q.push([n, v, a, b]) > 1 || resume(n, v); }); }; }\n        function resume(n, v) { try {\n            step(g[n](v));\n        }\n        catch (e) {\n            settle(q[0][3], e);\n        } }\n        function step(r) { r.value instanceof __await ? Promise.resolve(r.value.v).then(fulfill, reject) : settle(q[0][2], r); }\n        function fulfill(value) { resume(\"next\", value); }\n        function reject(value) { resume(\"throw\", value); }\n        function settle(f, v) { if (f(v), q.shift(), q.length)\n            resume(q[0][0], q[0][1]); }\n    }\n    function __asyncDelegator(o) {\n        var i, p;\n        return i = {}, verb(\"next\"), verb(\"throw\", function (e) { throw e; }), verb(\"return\"), i[Symbol.iterator] = function () { return this; }, i;\n        function verb(n, f) { i[n] = o[n] ? function (v) { return (p = !p) ? { value: __await(o[n](v)), done: n === \"return\" } : f ? f(v) : v; } : f; }\n    }\n    function __asyncValues(o) {\n        if (!Symbol.asyncIterator)\n            throw new TypeError(\"Symbol.asyncIterator is not defined.\");\n        var m = o[Symbol.asyncIterator], i;\n        return m ? m.call(o) : (o = typeof __values === \"function\" ? __values(o) : o[Symbol.iterator](), i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i);\n        function verb(n) { i[n] = o[n] && function (v) { return new Promise(function (resolve, reject) { v = o[n](v), settle(resolve, reject, v.done, v.value); }); }; }\n        function settle(resolve, reject, d, v) { Promise.resolve(v).then(function (v) { resolve({ value: v, done: d }); }, reject); }\n    }\n    function __makeTemplateObject(cooked, raw) {\n        if (Object.defineProperty) {\n            Object.defineProperty(cooked, \"raw\", { value: raw });\n        }\n        else {\n            cooked.raw = raw;\n        }\n        return cooked;\n    }\n    ;\n    var __setModuleDefault = Object.create ? (function (o, v) {\n        Object.defineProperty(o, \"default\", { enumerable: true, value: v });\n    }) : function (o, v) {\n        o[\"default\"] = v;\n    };\n    function __importStar(mod) {\n        if (mod && mod.__esModule)\n            return mod;\n        var result = {};\n        if (mod != null)\n            for (var k in mod)\n                if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k))\n                    __createBinding(result, mod, k);\n        __setModuleDefault(result, mod);\n        return result;\n    }\n    function __importDefault(mod) {\n        return (mod && mod.__esModule) ? mod : { default: mod };\n    }\n    function __classPrivateFieldGet(receiver, privateMap) {\n        if (!privateMap.has(receiver)) {\n            throw new TypeError(\"attempted to get private field on non-instance\");\n        }\n        return privateMap.get(receiver);\n    }\n    function __classPrivateFieldSet(receiver, privateMap, value) {\n        if (!privateMap.has(receiver)) {\n            throw new TypeError(\"attempted to set private field on non-instance\");\n        }\n        privateMap.set(receiver, value);\n        return value;\n    }\n\n    var ChoicesOriginDataSource = /** @class */ (function (_super) {\n        __extends(ChoicesOriginDataSource, _super);\n        function ChoicesOriginDataSource() {\n            var _this = _super.call(this) || this;\n            _this._choices = new rxjs.BehaviorSubject([]);\n            _this._choicesObs = _this._choices;\n            return _this;\n        }\n        ChoicesOriginDataSource.prototype.connect = function () {\n            return this._choicesObs;\n        };\n        ChoicesOriginDataSource.prototype.disconnect = function () { };\n        ChoicesOriginDataSource.prototype.updateChoices = function (choices) {\n            this._choices.next(choices);\n        };\n        return ChoicesOriginDataSource;\n    }(collections.DataSource));\n\n    /**\n     * @license\n     * Copyright (C) Gnucoop soc. coop.\n     *\n     * This file is part of the Advanced JSON forms (ajf).\n     *\n     * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n     * modify it under the terms of the GNU Affero General Public License as\n     * published by the Free Software Foundation, either version 3 of the License,\n     * or (at your option) any later version.\n     *\n     * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n     * but WITHOUT ANY WARRANTY; without even the implied warranty of\n     * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n     * General Public License for more details.\n     *\n     * You should have received a copy of the GNU Affero General Public License\n     * along with Advanced JSON forms (ajf).\n     * If not, see http://www.gnu.org/licenses/.\n     *\n     */\n    var AjfFbChoicesOriginEditor = /** @class */ (function () {\n        function AjfFbChoicesOriginEditor() {\n            this._displayedColumns = ['label', 'value', 'delete'];\n            this.editing = {};\n            this._choices = new ChoicesOriginDataSource();\n            this._choicesArr = [];\n        }\n        Object.defineProperty(AjfFbChoicesOriginEditor.prototype, \"displayedColumns\", {\n            get: function () {\n                return this._displayedColumns;\n            },\n            enumerable: false,\n            configurable: true\n        });\n        Object.defineProperty(AjfFbChoicesOriginEditor.prototype, \"choicesOrigin\", {\n            get: function () {\n                return this._choicesOrigin;\n            },\n            set: function (choicesOrigin) {\n                this._choicesOrigin = choicesOrigin;\n                this.name = choicesOrigin.name;\n                this.label = choicesOrigin.label;\n                this.canEditChoices = forms$1.isChoicesFixedOrigin(choicesOrigin);\n                this._choicesArr = choicesOrigin.choices;\n                this._choices.updateChoices(this._choicesArr);\n            },\n            enumerable: false,\n            configurable: true\n        });\n        Object.defineProperty(AjfFbChoicesOriginEditor.prototype, \"choices\", {\n            get: function () {\n                return this._choices;\n            },\n            enumerable: false,\n            configurable: true\n        });\n        Object.defineProperty(AjfFbChoicesOriginEditor.prototype, \"choicesArr\", {\n            get: function () {\n                return this._choicesArr;\n            },\n            enumerable: false,\n            configurable: true\n        });\n        AjfFbChoicesOriginEditor.prototype.updateValue = function (evt, cell, _value, rowIdx) {\n            this.editing[rowIdx + '-' + cell] = false;\n            this._choicesArr[rowIdx][cell] = evt.target.value;\n            this._choices.updateChoices(this._choicesArr);\n        };\n        AjfFbChoicesOriginEditor.prototype.deleteRow = function (rowIdx) {\n            this._choicesArr.splice(rowIdx, 1);\n            this._choices.updateChoices(this._choicesArr);\n        };\n        AjfFbChoicesOriginEditor.prototype.addRow = function () {\n            this._choicesArr.push({ label: '', value: '' });\n            this._choices.updateChoices(this._choicesArr);\n        };\n        return AjfFbChoicesOriginEditor;\n    }());\n    AjfFbChoicesOriginEditor.decorators = [\n        { type: core.Component, args: [{\n                    selector: 'ajf-fb-choices-origin-editor',\n                    template: \"<div>\\n  <mat-form-field>\\n    <input matInput [(ngModel)]=\\\"name\\\"\\n        [placeholder]=\\\"'Name' | translate\\\">\\n  </mat-form-field>\\n  <mat-form-field>\\n    <input matInput [(ngModel)]=\\\"label\\\"\\n        [placeholder]=\\\"'Label' | translate\\\">\\n  </mat-form-field>\\n  <ng-template [ngIf]=\\\"canEditChoices\\\">\\n    <button (click)=\\\"addRow()\\\" mat-button>\\n      <mat-icon>add</mat-icon>\\n      <span translate>Add value</span>\\n    </button>\\n    <mat-table [dataSource]=\\\"choices\\\">\\n      <ng-container matColumnDef=\\\"label\\\">\\n        <mat-header-cell *matHeaderCellDef translate>Label</mat-header-cell>\\n        <mat-cell *matCellDef=\\\"let row; let idx = index\\\">\\n          <input matInput [(ngModel)]=\\\"row.label\\\" type=\\\"text\\\">\\n        </mat-cell>\\n      </ng-container>\\n      <ng-container matColumnDef=\\\"value\\\">\\n        <mat-header-cell *matHeaderCellDef translate>Value</mat-header-cell>\\n        <mat-cell *matCellDef=\\\"let row; let idx = index\\\">\\n          <input matInput [(ngModel)]=\\\"row.value\\\" type=\\\"text\\\">\\n        </mat-cell>\\n      </ng-container>\\n      <ng-container matColumnDef=\\\"delete\\\">\\n        <mat-header-cell *matHeaderCellDef translate>Delete</mat-header-cell>\\n        <mat-cell *matCellDef=\\\"let row; let idx = index\\\">\\n            <mat-icon (click)=\\\"deleteRow(idx)\\\">delete</mat-icon>\\n        </mat-cell>\\n      </ng-container>\\n\\n      <mat-header-row *matHeaderRowDef=\\\"displayedColumns\\\"></mat-header-row>\\n      <mat-row *matRowDef=\\\"let row; columns: displayedColumns;\\\"></mat-row>\\n    </mat-table>\\n  </ng-template>\\n</div>\\n\",\n                    encapsulation: core.ViewEncapsulation.None,\n                    changeDetection: core.ChangeDetectionStrategy.OnPush,\n                    styles: [\"ajf-fb-choices-origin-editor mat-form-field+mat-form-field{margin-left:1em}ajf-fb-choices-origin-editor mat-table{max-height:300px}ajf-fb-choices-origin-editor mat-table mat-icon{cursor:pointer}\\n\"]\n                },] }\n    ];\n    AjfFbChoicesOriginEditor.propDecorators = {\n        choicesOrigin: [{ type: core.Input }]\n    };\n\n    function getNodeContainer(c, node) {\n        if (c.nodes.indexOf(node) > -1) {\n            return c;\n        }\n        var cns = c.nodes.filter(function (n) { return forms$1.isContainerNode(n); });\n        var len = cns.length;\n        for (var i = 0; i < len; i++) {\n            var cn = getNodeContainer(cns[i], node);\n            if (cn != null) {\n                return cn;\n            }\n        }\n        return null;\n    }\n    function buildFormBuilderNodesSubtree(nodes, parent, ignoreConditionalBranches) {\n        if (ignoreConditionalBranches === void 0) { ignoreConditionalBranches = false; }\n        var entries = nodes.filter(function (n) { return n.parent === parent.id; })\n            .sort(function (n1, n2) { return n1.parentNode - n2.parentNode; })\n            .map(function (n) {\n            var children = buildFormBuilderNodesSubtree(nodes, n);\n            if (children.length === 0) {\n                children.push({ parent: n, parentNode: 0 });\n            }\n            return {\n                node: n,\n                children: children,\n                content: buildFormBuilderNodesContent(nodes, n)\n            };\n        });\n        if (!ignoreConditionalBranches) {\n            var entriesNum = entries.length;\n            var cbs = parent.conditionalBranches.length;\n            for (var i = entriesNum; i < cbs; i++) {\n                entries.push({ parent: parent, parentNode: i });\n            }\n        }\n        return entries;\n    }\n    function buildFormBuilderNodesContent(_nodes, node) {\n        if (forms$1.isContainerNode(node)) {\n            return buildFormBuilderNodesSubtree(node.nodes, node, true);\n        }\n        return [];\n    }\n    function flattenNodes(nodes) {\n        var flatNodes = [];\n        nodes.forEach(function (node) {\n            if (forms$1.isContainerNode(node)) {\n                flatNodes = flatNodes.concat(flattenNodes(node.nodes));\n            }\n            flatNodes.push(node);\n        });\n        return flatNodes;\n    }\n    function getDescendants(flatNodes, parentNode, branch) {\n        if (branch === void 0) { branch = null; }\n        return branch != null ?\n            flatNodes.filter(function (n) { return n.parent === parentNode.id && n.parentNode === branch; }) :\n            flatNodes.filter(function (n) { return n.parent === parentNode.id; });\n    }\n    function removeNodes(nodes, ids) {\n        var len = nodes.length;\n        for (var i = 0; i < len; i++) {\n            var node = nodes[i];\n            if (forms$1.isContainerNode(node)) {\n                var container = node;\n                container.nodes = removeNodes(container.nodes, ids);\n            }\n        }\n        return nodes.filter(function (n) { return ids.indexOf(n.id) === -1; });\n    }\n    function deleteNodeSubtree(nodes, parentNode, branch) {\n        if (branch === void 0) { branch = null; }\n        var flatNodes = flattenNodes(nodes);\n        var delNodes = [];\n        var descendants = getDescendants(flatNodes, parentNode, branch);\n        var len = descendants.length;\n        for (var i = 0; i < len; i++) {\n            delNodes = delNodes.concat(getDescendants(flatNodes, descendants[i]));\n        }\n        delNodes = delNodes.concat(descendants);\n        return removeNodes(nodes, delNodes.map(function (n) { return n.id; }));\n    }\n    var nodeUniqueId = 0;\n    var AjfFormBuilderService = /** @class */ (function () {\n        function AjfFormBuilderService() {\n            this._availableNodeTypes = [\n                {\n                    label: 'Slide',\n                    icon: { fontSet: 'ajf-icon', fontIcon: 'field-slide' },\n                    nodeType: { node: forms$1.AjfNodeType.AjfSlide },\n                    isSlide: true\n                },\n                {\n                    label: 'Repeating slide',\n                    icon: { fontSet: 'ajf-icon', fontIcon: 'field-repeatingslide' },\n                    nodeType: { node: forms$1.AjfNodeType.AjfRepeatingSlide },\n                    isSlide: true\n                },\n                {\n                    label: 'String',\n                    icon: { fontSet: 'ajf-icon', fontIcon: 'field-string' },\n                    nodeType: { node: forms$1.AjfNodeType.AjfField, field: forms$1.AjfFieldType.String }\n                },\n                {\n                    label: 'Text',\n                    icon: { fontSet: 'ajf-icon', fontIcon: 'field-text' },\n                    nodeType: { node: forms$1.AjfNodeType.AjfField, field: forms$1.AjfFieldType.Text }\n                },\n                {\n                    label: 'Number',\n                    icon: { fontSet: 'ajf-icon', fontIcon: 'field-number' },\n                    nodeType: { node: forms$1.AjfNodeType.AjfField, field: forms$1.AjfFieldType.Number }\n                },\n                {\n                    label: 'Boolean',\n                    icon: { fontSet: 'ajf-icon', fontIcon: 'field-boolean' },\n                    nodeType: { node: forms$1.AjfNodeType.AjfField, field: forms$1.AjfFieldType.Boolean }\n                },\n                {\n                    label: 'Single choice',\n                    icon: { fontSet: 'ajf-icon', fontIcon: 'field-singlechoice' },\n                    nodeType: { node: forms$1.AjfNodeType.AjfField, field: forms$1.AjfFieldType.SingleChoice }\n                },\n                {\n                    label: 'Multiple choice',\n                    icon: { fontSet: 'ajf-icon', fontIcon: 'field-multiplechoice' },\n                    nodeType: { node: forms$1.AjfNodeType.AjfField, field: forms$1.AjfFieldType.MultipleChoice }\n                },\n                {\n                    label: 'Formula',\n                    icon: { fontSet: 'ajf-icon', fontIcon: 'field-formula' },\n                    nodeType: { node: forms$1.AjfNodeType.AjfField, field: forms$1.AjfFieldType.Formula }\n                },\n                {\n                    label: 'Date',\n                    icon: { fontSet: 'ajf-icon', fontIcon: 'field-date' },\n                    nodeType: { node: forms$1.AjfNodeType.AjfField, field: forms$1.AjfFieldType.Date }\n                },\n                {\n                    label: 'Date input',\n                    icon: { fontSet: 'ajf-icon', fontIcon: 'field-dateinput' },\n                    nodeType: { node: forms$1.AjfNodeType.AjfField, field: forms$1.AjfFieldType.DateInput }\n                },\n                {\n                    label: 'Time',\n                    icon: { fontSet: 'ajf-icon', fontIcon: 'field-time' },\n                    nodeType: { node: forms$1.AjfNodeType.AjfField, field: forms$1.AjfFieldType.Time }\n                },\n                {\n                    label: 'Table',\n                    icon: { fontSet: 'ajf-icon', fontIcon: 'field-table' },\n                    nodeType: { node: forms$1.AjfNodeType.AjfField, field: forms$1.AjfFieldType.Table }\n                }\n            ];\n            this._form = new rxjs.BehaviorSubject(null);\n            this._formObs = this._form;\n            /**\n             * A list of the ids of the dropLists connected to the source list.\n             */\n            this._connectedDropLists = new rxjs.BehaviorSubject([]);\n            this._editedNodeEntry = new rxjs.BehaviorSubject(null);\n            this._editedNodeEntryObs = this._editedNodeEntry;\n            this._editedCondition = new rxjs.BehaviorSubject(null);\n            this._editedConditionObs = this._editedCondition;\n            this._editedChoicesOrigin = new rxjs.BehaviorSubject(null);\n            this._editedChoicesOriginObs = this._editedChoicesOrigin;\n            this._beforeNodesUpdate = new core.EventEmitter();\n            this._beforeNodesUpdateObs = this._beforeNodesUpdate;\n            this._afterNodeUpdate = new core.EventEmitter();\n            this._afterNodeUpdateObs = this._afterNodeUpdate;\n            this._nodesUpdates = new rxjs.Subject();\n            this._attachmentsOriginsUpdates = new rxjs.Subject();\n            this._choicesOriginsUpdates = new rxjs.Subject();\n            this._stringIdentifierUpdates = new rxjs.Subject();\n            this._saveNodeEntryEvent = new core.EventEmitter();\n            this._deleteNodeEntryEvent = new core.EventEmitter();\n            /**\n             * Event fired when the position of a node in a tree changes.\n             */\n            this._moveNodeEntryEvent = new core.EventEmitter();\n            /**\n             * Subscribes to the moveNodeEntryEvent event emitter;\n             */\n            this._moveNodeSub = rxjs.Subscription.EMPTY;\n            this._initChoicesOriginsStreams();\n            this._initAttachmentsOriginsStreams();\n            this._initStringIdentifierStreams();\n            this._initNodesStreams();\n            this._initFormStreams();\n            this._initSaveNode();\n            this._initMoveNode();\n            this._initDeleteNode();\n        }\n        Object.defineProperty(AjfFormBuilderService.prototype, \"availableNodeTypes\", {\n            /**\n             * Available node types\n             *\n             * @readonly\n             * @memberOf AjfFormBuilderService\n             */\n            get: function () {\n                return this._availableNodeTypes;\n            },\n            enumerable: false,\n            configurable: true\n        });\n        Object.defineProperty(AjfFormBuilderService.prototype, \"form\", {\n            /**\n             * Current edited form stream\n             *\n             * @readonly\n             * @memberOf AjfFormBuilderService\n             */\n            get: function () {\n                return this._formObs;\n            },\n            enumerable: false,\n            configurable: true\n        });\n        Object.defineProperty(AjfFormBuilderService.prototype, \"attachmentsOrigins\", {\n            get: function () {\n                return this._attachmentsOrigins;\n            },\n            enumerable: false,\n            configurable: true\n        });\n        Object.defineProperty(AjfFormBuilderService.prototype, \"choicesOrigins\", {\n            get: function () {\n                return this._choicesOrigins;\n            },\n            enumerable: false,\n            configurable: true\n        });\n        Object.defineProperty(AjfFormBuilderService.prototype, \"stringIdentifier\", {\n            get: function () {\n                return this._stringIdentifier;\n            },\n            enumerable: false,\n            configurable: true\n        });\n        Object.defineProperty(AjfFormBuilderService.prototype, \"nodes\", {\n            get: function () {\n                return this._nodes;\n            },\n            enumerable: false,\n            configurable: true\n        });\n        Object.defineProperty(AjfFormBuilderService.prototype, \"flatNodes\", {\n            get: function () {\n                return this._flatNodes;\n            },\n            enumerable: false,\n            configurable: true\n        });\n        Object.defineProperty(AjfFormBuilderService.prototype, \"flatFields\", {\n            get: function () {\n                return this._flatFields;\n            },\n            enumerable: false,\n            configurable: true\n        });\n        Object.defineProperty(AjfFormBuilderService.prototype, \"nodeEntriesTree\", {\n            get: function () {\n                return this._nodeEntriesTree;\n            },\n            enumerable: false,\n            configurable: true\n        });\n        Object.defineProperty(AjfFormBuilderService.prototype, \"connectedDropLists\", {\n            get: function () {\n                return this._connectedDropLists;\n            },\n            enumerable: false,\n            configurable: true\n        });\n        Object.defineProperty(AjfFormBuilderService.prototype, \"editedNodeEntry\", {\n            get: function () {\n                return this._editedNodeEntryObs;\n            },\n            enumerable: false,\n            configurable: true\n        });\n        Object.defineProperty(AjfFormBuilderService.prototype, \"editedCondition\", {\n            get: function () {\n                return this._editedConditionObs;\n            },\n            enumerable: false,\n            configurable: true\n        });\n        Object.defineProperty(AjfFormBuilderService.prototype, \"editedChoicesOrigin\", {\n            get: function () {\n                return this._editedChoicesOriginObs;\n            },\n            enumerable: false,\n            configurable: true\n        });\n        Object.defineProperty(AjfFormBuilderService.prototype, \"beforeNodesUpdate\", {\n            get: function () {\n                return this._beforeNodesUpdateObs;\n            },\n            enumerable: false,\n            configurable: true\n        });\n        Object.defineProperty(AjfFormBuilderService.prototype, \"afterNodeUpdate\", {\n            get: function () {\n                return this._afterNodeUpdateObs;\n            },\n            enumerable: false,\n            configurable: true\n        });\n        /**\n         * Sets the current edited form\n         *\n         * @param form\n         *\n         * @memberOf AjfFormBuilderService\n         */\n        AjfFormBuilderService.prototype.setForm = function (form) {\n            if (form !== this._form.getValue()) {\n                this._form.next(form);\n            }\n        };\n        AjfFormBuilderService.prototype.editNodeEntry = function (nodeEntry) {\n            this._editedNodeEntry.next(nodeEntry);\n        };\n        AjfFormBuilderService.prototype.editCondition = function (condition) {\n            this._editedCondition.next(condition);\n        };\n        AjfFormBuilderService.prototype.saveCurrentCondition = function (condition) {\n            var c = this._editedCondition.getValue();\n            if (c == null) {\n                return;\n            }\n            c.condition = condition;\n            this._editedCondition.next(null);\n        };\n        AjfFormBuilderService.prototype.cancelConditionEdit = function () {\n            this._editedChoicesOrigin.next(null);\n        };\n        AjfFormBuilderService.prototype.assignListId = function (node, empty) {\n            if (empty === void 0) { empty = false; }\n            if (node.nodeType === forms$1.AjfNodeType.AjfSlide || node.nodeType === forms$1.AjfNodeType.AjfRepeatingSlide) {\n                var listId = empty ? \"empty_fields_list_\" + node.id : \"fields_list_\" + node.id;\n                if (this._connectedDropLists.value.indexOf(listId) == -1) {\n                    this._connectDropList(listId);\n                }\n                return listId;\n            }\n            return '';\n        };\n        AjfFormBuilderService.prototype.insertNode = function (nodeType, parent, parentNode, inContent, insertInIndex) {\n            var _this = this;\n            if (inContent === void 0) { inContent = false; }\n            if (insertInIndex === void 0) { insertInIndex = 0; }\n            var _a;\n            var node;\n            var id = ++nodeUniqueId;\n            var isFieldNode = ((_a = nodeType.nodeType) === null || _a === void 0 ? void 0 : _a.field) != null;\n            if (isFieldNode) {\n                node = forms$1.createField({\n                    id: id,\n                    nodeType: forms$1.AjfNodeType.AjfField,\n                    fieldType: nodeType.nodeType.field,\n                    parent: parent.id,\n                    parentNode: parentNode,\n                    name: '',\n                });\n            }\n            else {\n                node = forms$1.createContainerNode({\n                    id: id,\n                    nodeType: nodeType.nodeType.node,\n                    parent: 0,\n                    parentNode: parentNode,\n                    name: '',\n                    nodes: [],\n                });\n            }\n            this._beforeNodesUpdate.emit();\n            this._nodesUpdates.next(function (nodes) {\n                var cn = forms$1.isContainerNode(parent) && inContent ?\n                    parent :\n                    getNodeContainer({ nodes: nodes }, parent);\n                if (!isFieldNode) {\n                    var newNodes = nodes.slice(0);\n                    newNodes.splice(insertInIndex, 0, node);\n                    newNodes = _this._updateNodesList(0, newNodes);\n                    return newNodes;\n                }\n                else {\n                    var newNodes = cn.nodes.slice(0);\n                    newNodes.splice(insertInIndex, 0, node);\n                    newNodes = _this._updateNodesList(cn.id, newNodes);\n                    cn.nodes = newNodes;\n                }\n                return nodes;\n            });\n        };\n        AjfFormBuilderService.prototype.saveNodeEntry = function (properties) {\n            this._saveNodeEntryEvent.emit(properties);\n        };\n        AjfFormBuilderService.prototype.cancelNodeEntryEdit = function () {\n            this._editedNodeEntry.next(null);\n        };\n        AjfFormBuilderService.prototype.deleteNodeEntry = function (nodeEntry) {\n            this._deleteNodeEntryEvent.next(nodeEntry);\n        };\n        /**\n         * Triggers the moveNode event when a node is moved in the formbuilder.\n         * @param nodeEntry The node to be moved.\n         */\n        AjfFormBuilderService.prototype.moveNodeEntry = function (nodeEntry, from, to) {\n            var moveEvent = { nodeEntry: nodeEntry, fromIndex: from, toIndex: to };\n            this._moveNodeEntryEvent.next(moveEvent);\n        };\n        AjfFormBuilderService.prototype.getCurrentForm = function () {\n            return rxjs.combineLatest([\n                this.form, this._nodesWithoutChoiceOrigins, this.attachmentsOrigins,\n                this.choicesOrigins, this.stringIdentifier\n            ])\n                .pipe(operators.filter(function (_b) {\n                var _c = __read(_b, 1), form = _c[0];\n                return form != null;\n            }), operators.map(function (_b) {\n                var _c = __read(_b, 5), form = _c[0], nodes = _c[1], attachmentsOrigins = _c[2], choicesOrigins = _c[3], stringIdentifier = _c[4];\n                return forms$1.createForm({\n                    choicesOrigins: choicesOrigins.slice(0),\n                    attachmentsOrigins: attachmentsOrigins.slice(0),\n                    stringIdentifier: (stringIdentifier || []).slice(0),\n                    nodes: nodes.slice(0),\n                    supplementaryInformations: form.supplementaryInformations,\n                });\n            }));\n        };\n        AjfFormBuilderService.prototype.editChoicesOrigin = function (choicesOrigin) {\n            this._editedChoicesOrigin.next(choicesOrigin);\n        };\n        AjfFormBuilderService.prototype.createChoicesOrigin = function () {\n            this._editedChoicesOrigin.next(forms$1.createChoicesFixedOrigin({ name: '' }));\n        };\n        AjfFormBuilderService.prototype.cancelChoicesOriginEdit = function () {\n            this._editedChoicesOrigin.next(null);\n        };\n        AjfFormBuilderService.prototype.saveChoicesOrigin = function (params) {\n            var choicesOrigin = this._editedChoicesOrigin.getValue();\n            if (choicesOrigin != null) {\n                choicesOrigin.label = params.label;\n                choicesOrigin.name = params.name;\n                if (forms$1.isChoicesFixedOrigin(choicesOrigin)) {\n                    choicesOrigin.choices = params.choices;\n                }\n                this._choicesOriginsUpdates.next(function (choicesOrigins) {\n                    var idx = choicesOrigins.indexOf(choicesOrigin);\n                    if (idx > -1) {\n                        choicesOrigins = __spreadArray(__spreadArray(__spreadArray([], __read(choicesOrigins.slice(0, idx))), [\n                            choicesOrigin\n                        ]), __read(choicesOrigins.slice(idx + 1)));\n                    }\n                    else {\n                        choicesOrigins = __spreadArray(__spreadArray([], __read(choicesOrigins)), [choicesOrigin]);\n                    }\n                    return choicesOrigins;\n                });\n            }\n            this._editedChoicesOrigin.next(null);\n        };\n        AjfFormBuilderService.prototype.saveStringIdentifier = function (identifier) {\n            this._stringIdentifierUpdates.next(function () { return __spreadArray([], __read(identifier)); });\n        };\n        AjfFormBuilderService.prototype._buildFormBuilderNodesTree = function (nodes) {\n            this._updateNodesList(0, nodes);\n            var rootNodes = nodes.filter(function (n) { return n.nodeType == forms$1.AjfNodeType.AjfSlide || n.nodeType == forms$1.AjfNodeType.AjfRepeatingSlide; });\n            if (rootNodes.length === 0) {\n                return [null];\n            }\n            var rootNode = rootNodes[0];\n            if (forms$1.isSlidesNode(rootNode)) {\n                var tree = [];\n                tree.push({\n                    node: rootNode,\n                    container: null,\n                    children: buildFormBuilderNodesSubtree(nodes, rootNode),\n                    content: buildFormBuilderNodesContent(nodes, rootNode)\n                });\n                return tree;\n            }\n            throw new Error('Invalid form definition');\n        };\n        /**\n         * Adds the id of a dropList to be connected with the FormBuilder source list.\n         * @param listId The id of the list to connect.\n         */\n        AjfFormBuilderService.prototype._connectDropList = function (listId) {\n            var connectedLists = this._connectedDropLists.value.slice(0);\n            this._connectedDropLists.next(__spreadArray(__spreadArray([], __read(connectedLists)), [listId]));\n        };\n        AjfFormBuilderService.prototype._findMaxNodeId = function (nodes, _curMaxId) {\n            var _this = this;\n            if (_curMaxId === void 0) { _curMaxId = 0; }\n            var maxId = 0;\n            nodes.forEach(function (n) {\n                maxId = Math.max(maxId, n.id);\n                if (forms$1.isContainerNode(n)) {\n                    maxId = Math.max(maxId, _this._findMaxNodeId(n.nodes));\n                }\n            });\n            return maxId;\n        };\n        AjfFormBuilderService.prototype._initFormStreams = function () {\n            var _this = this;\n            this._form.subscribe(function (form) {\n                nodeUniqueId = 0;\n                if (form != null && form.nodes != null && form.nodes.length > 0) {\n                    nodeUniqueId = _this._findMaxNodeId(form.nodes);\n                }\n                _this._nodesUpdates.next(function (_nodes) {\n                    return form != null && form.nodes != null ? form.nodes.slice(0) : [];\n                });\n                _this._attachmentsOriginsUpdates.next(function (_attachmentsOrigins) {\n                    return form != null && form.attachmentsOrigins != null ?\n                        form.attachmentsOrigins.slice(0) :\n                        [];\n                });\n                _this._choicesOriginsUpdates.next(function (_choicesOrigins) {\n                    return form != null && form.choicesOrigins != null ? form.choicesOrigins.slice(0) : [];\n                });\n                _this._stringIdentifierUpdates.next(function (_) {\n                    return form != null && form.stringIdentifier != null ? form.stringIdentifier.slice(0) :\n                        [];\n                });\n            });\n        };\n        AjfFormBuilderService.prototype._initChoicesOriginsStreams = function () {\n            this._choicesOrigins =\n                this._choicesOriginsUpdates\n                    .pipe(operators.scan(function (choicesOrigins, op) {\n                    return op(choicesOrigins);\n                }, []), operators.publishReplay(1), operators.refCount());\n        };\n        AjfFormBuilderService.prototype._initAttachmentsOriginsStreams = function () {\n            this._attachmentsOrigins = this._attachmentsOriginsUpdates.pipe(operators.scan(function (attachmentsOrigins, op) {\n                return op(attachmentsOrigins);\n            }, []), operators.publishReplay(1), operators.refCount());\n        };\n        AjfFormBuilderService.prototype._initStringIdentifierStreams = function () {\n            this._stringIdentifier = this._stringIdentifierUpdates.pipe(operators.scan(function (stringIdentifier, op) {\n                return op(stringIdentifier);\n            }, []), operators.publishReplay(1), operators.refCount());\n        };\n        AjfFormBuilderService.prototype._initNodesStreams = function () {\n            var _this = this;\n            this._nodes = this._nodesUpdates\n                .pipe(operators.scan(function (nodes, op) {\n                return op(nodes);\n            }, []), operators.publishReplay(1), operators.refCount());\n            this._nodesWithoutChoiceOrigins =\n                this._nodes.pipe(operators.map(function (slides) { return slides.map(function (slide) {\n                    slide.nodes = slide.nodes.map(function (node) {\n                        if (forms$1.isFieldWithChoices(node)) {\n                            var fwc = utils.deepCopy(node);\n                            if (fwc && fwc.choices) {\n                                delete fwc.choices;\n                            }\n                            if (fwc && fwc.choicesOrigin) {\n                                delete fwc.choicesOrigin;\n                            }\n                            return fwc;\n                        }\n                        return node;\n                    });\n                    return slide;\n                }); }));\n            this._flatNodes = this._nodes.pipe(operators.map(function (nodes) { return flattenNodes(nodes); }), operators.publishReplay(1), operators.refCount());\n            this._flatFields = this._flatNodes.pipe(operators.map(function (nodes) { return nodes.filter(function (n) { return !forms$1.isContainerNode(n); }); }), operators.publishReplay(1), operators.refCount());\n            this._nodeEntriesTree = this._nodes.pipe(operators.map(function (nodes) { return _this._buildFormBuilderNodesTree(nodes); }), operators.publishReplay(1), operators.refCount());\n        };\n        AjfFormBuilderService.prototype._initSaveNode = function () {\n            var _this = this;\n            this._saveNodeEntryEvent\n                .pipe(operators.withLatestFrom(this.editedNodeEntry, this.choicesOrigins, this.attachmentsOrigins), operators.filter(function (_b) {\n                var _c = __read(_b, 2), _ = _c[0], nodeEntry = _c[1];\n                return nodeEntry != null;\n            }), operators.map(function (_b) {\n                var _c = __read(_b, 2), properties = _c[0], ne = _c[1];\n                _this._beforeNodesUpdate.emit();\n                var nodeEntry = ne;\n                var origNode = nodeEntry.node;\n                var node = utils.deepCopy(origNode);\n                node.id = nodeEntry.node.id;\n                node.name = properties.name;\n                node.label = properties.label;\n                node.visibility = properties.visibility != null ?\n                    models.createCondition({ condition: properties.visibility }) :\n                    null;\n                var oldConditionalBranches = node.conditionalBranches.length;\n                node.conditionalBranches = properties.conditionalBranches != null ?\n                    properties.conditionalBranches.map(function (condition) { return models.createCondition({ condition: condition }); }) :\n                    [models.alwaysCondition()];\n                var newConditionalBranches = node.conditionalBranches.length;\n                if (forms$1.isRepeatingContainerNode(node)) {\n                    var repNode = node;\n                    repNode.formulaReps = properties.formulaReps != null ?\n                        models.createFormula({ formula: properties.formulaReps }) :\n                        undefined;\n                    repNode.minReps = properties.minReps;\n                    repNode.maxReps = properties.maxReps;\n                }\n                if (forms$1.isField(node)) {\n                    var field = node;\n                    field.description = properties.description;\n                    field.defaultValue = properties.defaultValue;\n                    field.formula = properties.formula != null ?\n                        models.createFormula({ formula: properties.formula }) :\n                        undefined;\n                    var forceValue = properties.value;\n                    var notEmpty = properties.notEmpty;\n                    var validationConditions = properties.validationConditions;\n                    var minValue = parseInt(properties.minValue, 10);\n                    var maxValue = parseInt(properties.maxValue, 10);\n                    var minDigits = parseInt(properties.minDigits, 10);\n                    var maxDigits = parseInt(properties.maxDigits, 10);\n                    if (isNaN(minValue)) {\n                        minValue = null;\n                    }\n                    if (isNaN(maxValue)) {\n                        maxValue = null;\n                    }\n                    if (isNaN(minDigits)) {\n                        minDigits = null;\n                    }\n                    if (isNaN(maxDigits)) {\n                        maxDigits = null;\n                    }\n                    if (forceValue != null || notEmpty != null ||\n                        (validationConditions != null && validationConditions.length > 0) ||\n                        minValue != null || maxValue != null || minDigits != null ||\n                        maxDigits != null) {\n                        var validation = field.validation || forms$1.createValidationGroup({});\n                        validation.forceValue = forceValue;\n                        validation.notEmpty = notEmpty ? forms$1.notEmptyValidation() : undefined;\n                        validation.minValue = minValue != null ? forms$1.minValidation(minValue) : undefined;\n                        validation.maxValue = maxValue != null ? forms$1.maxValidation(maxValue) : undefined;\n                        validation.minDigits =\n                            minDigits != null ? forms$1.minDigitsValidation(minDigits) : undefined;\n                        validation.maxDigits =\n                            maxDigits != null ? forms$1.maxDigitsValidation(maxDigits) : undefined;\n                        validation.conditions =\n                            (validationConditions ||\n                                []).map(function (c) { return forms$1.createValidation({\n                                condition: c.condition,\n                                errorMessage: c.errorMessage\n                            }); });\n                        field.validation = validation;\n                    }\n                    else {\n                        field.validation = undefined;\n                    }\n                    var notEmptyWarn = properties.notEmptyWarning;\n                    var warningConditions = properties.warningConditions;\n                    if (notEmptyWarn != null ||\n                        (warningConditions != null && warningConditions.length > 0)) {\n                        var warning = field.warning || forms$1.createWarningGroup({});\n                        warning.notEmpty = notEmptyWarn ? forms$1.notEmptyWarning() : undefined;\n                        warning.conditions =\n                            (warningConditions ||\n                                []).map(function (w) { return forms$1.createWarning({\n                                condition: w.condition,\n                                warningMessage: w.warningMessage\n                            }); });\n                        field.warning = warning;\n                    }\n                    else {\n                        field.warning = undefined;\n                    }\n                    field.nextSlideCondition = properties.nextSlideCondition != null ?\n                        models.createCondition({ condition: properties.nextSlideCondition }) :\n                        undefined;\n                    field.size = properties.size;\n                    field.defaultValue = properties.defaultValue;\n                    if (forms$1.isFieldWithChoices(field)) {\n                        var fwc = field;\n                        fwc.choicesOriginRef = properties.choicesOriginRef;\n                        fwc.forceExpanded = properties.forceExpanded;\n                        fwc.forceNarrow = properties.forceNarrow;\n                        fwc.triggerConditions = (properties.triggerConditions ||\n                            []).map(function (t) { return models.createCondition({ condition: t }); });\n                    }\n                }\n                _this._editedNodeEntry.next(null);\n                return function (nodes) {\n                    var cn = getNodeContainer({ nodes: nodes }, origNode);\n                    if (cn != null) {\n                        // TODO: @trik check this, was always true?\n                        // if (cn instanceof AjfNode) {\n                        var replaceNodes = cn.nodes === nodes;\n                        var idx = cn.nodes.indexOf(origNode);\n                        var newNodes = cn.nodes.slice(0, idx);\n                        newNodes.push(node);\n                        newNodes = newNodes.concat(cn.nodes.slice(idx + 1));\n                        cn.nodes = newNodes;\n                        if (replaceNodes) {\n                            nodes = newNodes;\n                        }\n                        else {\n                            nodes = nodes.slice(0);\n                        }\n                        // } else {\n                        //   const idx = nodes.indexOf(origNode);\n                        //   nodes = nodes.slice(0, idx).concat([node]).concat(nodes.slice(idx + 1));\n                        // }\n                        if (newConditionalBranches < oldConditionalBranches) {\n                            for (var i = newConditionalBranches; i < oldConditionalBranches; i++) {\n                                nodes = deleteNodeSubtree(nodes, node, i);\n                            }\n                        }\n                    }\n                    return nodes;\n                };\n            }))\n                .subscribe(this._nodesUpdates);\n        };\n        AjfFormBuilderService.prototype._initDeleteNode = function () {\n            var _this = this;\n            this._deleteNodeEntryEvent\n                .pipe(operators.map(function (nodeEntry) {\n                _this._beforeNodesUpdate.emit();\n                return function (nodes) {\n                    var node = nodeEntry.node;\n                    var cn = getNodeContainer({ nodes: nodes }, node);\n                    if (cn != null) {\n                        var replaceNodes = cn.nodes === nodes;\n                        var idx = cn.nodes.indexOf(node);\n                        var newNodes = cn.nodes.slice(0, idx);\n                        newNodes = newNodes.concat(cn.nodes.slice(idx + 1));\n                        cn.nodes = newNodes;\n                        if (replaceNodes) {\n                            nodes = newNodes;\n                        }\n                        else {\n                            nodes = nodes.slice(0);\n                        }\n                    }\n                    return nodes;\n                };\n            }))\n                .subscribe(this._nodesUpdates);\n        };\n        /**\n         * Initializes the subscription to the moveNodeEntryEvent.\n         */\n        AjfFormBuilderService.prototype._initMoveNode = function () {\n            var _this = this;\n            this._moveNodeSub.unsubscribe();\n            this._moveNodeSub =\n                this._moveNodeEntryEvent\n                    .pipe(operators.map(function (moveEvent) {\n                    _this._beforeNodesUpdate.emit();\n                    return function (nodes) {\n                        var nodeEntry = moveEvent.nodeEntry;\n                        var node = nodeEntry.node;\n                        var cn = getNodeContainer({ nodes: nodes }, node);\n                        var newNodes = nodes;\n                        if (cn != null) {\n                            var replaceNodes = cn.nodes === nodes;\n                            newNodes = cn.nodes;\n                            dragDrop.moveItemInArray(newNodes, moveEvent.fromIndex, moveEvent.toIndex);\n                            newNodes = _this._updateNodesList(cn.id, newNodes);\n                            cn.nodes = newNodes;\n                            if (replaceNodes) {\n                                nodes = newNodes;\n                            }\n                            else {\n                                nodes = nodes.slice(0);\n                            }\n                        }\n                        return nodes;\n                    };\n                }))\n                    .subscribe(this._nodesUpdates);\n        };\n        /**\n         * Updates the \"id\" and \"parent\" fields of a modified or rearranged list of nodes.\n         * @param containerId The id of the parent container of the list.\n         * @param nodesList The list of nodes to be updated.\n         */\n        AjfFormBuilderService.prototype._updateNodesList = function (containerId, nodesList) {\n            if (!nodesList.length) {\n                return [];\n            }\n            var contId = containerId != undefined ? containerId : 0;\n            for (var idx = 0; idx < nodesList.length; idx++) {\n                var currentNode = nodesList[idx];\n                currentNode.id = (contId * 1000) + idx + 1;\n                currentNode.parent = idx == 0 ? contId : (contId * 1000) + idx;\n                if (currentNode.nodeType == forms$1.AjfNodeType.AjfSlide ||\n                    currentNode.nodeType == forms$1.AjfNodeType.AjfRepeatingSlide) {\n                    var currentSlide = currentNode;\n                    if (currentSlide.nodes) {\n                        this._updateNodesList(currentSlide.id, currentSlide.nodes);\n                    }\n                }\n            }\n            return nodesList;\n        };\n        return AjfFormBuilderService;\n    }());\n    AjfFormBuilderService.decorators = [\n        { type: core.Injectable }\n    ];\n    AjfFormBuilderService.ctorParameters = function () { return []; };\n\n    /**\n     * @license\n     * Copyright (C) Gnucoop soc. coop.\n     *\n     * This file is part of the Advanced JSON forms (ajf).\n     *\n     * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n     * modify it under the terms of the GNU Affero General Public License as\n     * published by the Free Software Foundation, either version 3 of the License,\n     * or (at your option) any later version.\n     *\n     * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n     * but WITHOUT ANY WARRANTY; without even the implied warranty of\n     * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n     * General Public License for more details.\n     *\n     * You should have received a copy of the GNU Affero General Public License\n     * along with Advanced JSON forms (ajf).\n     * If not, see http://www.gnu.org/licenses/.\n     *\n     */\n    var AjfFbChoicesOriginEditorDialog = /** @class */ (function () {\n        function AjfFbChoicesOriginEditorDialog(_service) {\n            this._service = _service;\n            this._choicesOrigin =\n                this._service.editedChoicesOrigin.pipe(operators.filter(function (c) { return c != null; }), operators.map(function (c) { return c; }));\n        }\n        Object.defineProperty(AjfFbChoicesOriginEditorDialog.prototype, \"choicesOrigin\", {\n            get: function () {\n                return this._choicesOrigin;\n            },\n            enumerable: false,\n            configurable: true\n        });\n        AjfFbChoicesOriginEditorDialog.prototype.saveChoicesOrigin = function () {\n            this._service.saveChoicesOrigin({ label: this.editor.label, name: this.editor.name, choices: this.editor.choicesArr });\n        };\n        AjfFbChoicesOriginEditorDialog.prototype.cancelChoicesOriginEdit = function () {\n            this._service.cancelChoicesOriginEdit();\n        };\n        return AjfFbChoicesOriginEditorDialog;\n    }());\n    AjfFbChoicesOriginEditorDialog.decorators = [\n        { type: core.Component, args: [{\n                    selector: 'ajf-fb-choices-origin-editor-dialog',\n                    template: \"<h3 matDialogTitle translate>Edit choices origin</h3>\\n<mat-dialog-content>\\n  <ajf-fb-choices-origin-editor\\n      *ngIf=\\\"choicesOrigin|async as co\\\"\\n      [choicesOrigin]=\\\"co!\\\"></ajf-fb-choices-origin-editor>\\n</mat-dialog-content>\\n<mat-dialog-actions>\\n  <button mat-button translate (click)=\\\"saveChoicesOrigin()\\\">Save</button>\\n  <button mat-button translate (click)=\\\"cancelChoicesOriginEdit()\\\">Close</button>\\n</mat-dialog-actions>\\n\",\n                    encapsulation: core.ViewEncapsulation.None,\n                    changeDetection: core.ChangeDetectionStrategy.OnPush,\n                    styles: [\"\\n\"]\n                },] }\n    ];\n    AjfFbChoicesOriginEditorDialog.ctorParameters = function () { return [\n        { type: AjfFormBuilderService }\n    ]; };\n    AjfFbChoicesOriginEditorDialog.propDecorators = {\n        editor: [{ type: core.ViewChild, args: [AjfFbChoicesOriginEditor, { static: false },] }]\n    };\n\n    /**\n     * @license\n     * Copyright (C) Gnucoop soc. coop.\n     *\n     * This file is part of the Advanced JSON forms (ajf).\n     *\n     * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n     * modify it under the terms of the GNU Affero General Public License as\n     * published by the Free Software Foundation, either version 3 of the License,\n     * or (at your option) any later version.\n     *\n     * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n     * but WITHOUT ANY WARRANTY; without even the implied warranty of\n     * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n     * General Public License for more details.\n     *\n     * You should have received a copy of the GNU Affero General Public License\n     * along with Advanced JSON forms (ajf).\n     * If not, see http://www.gnu.org/licenses/.\n     *\n     */\n    var AjfFbConditionEditor = /** @class */ (function () {\n        function AjfFbConditionEditor(_) {\n        }\n        Object.defineProperty(AjfFbConditionEditor.prototype, \"fields\", {\n            get: function () {\n                return this._fields;\n            },\n            set: function (fields) {\n                this._fields = fields;\n                this._updateVariables();\n            },\n            enumerable: false,\n            configurable: true\n        });\n        AjfFbConditionEditor.prototype.insertVariable = function (variable) {\n            if (this.monacoEditor != null && this.monacoEditor.editor != null) {\n                var editor = this.monacoEditor.editor;\n                var value = editor.getValue().split('\\n');\n                var position = editor.getPosition();\n                var ln = position.lineNumber - 1;\n                var line = value[ln];\n                var col = position.column - 1;\n                line = line.substring(0, col) + variable + line.substring(col);\n                value[ln] = line;\n                position.column += variable.length;\n                this.monacoEditor.value = value.join('\\n');\n                editor.setPosition(position);\n                editor.focus();\n                this.editedValue = editor.getValue();\n            }\n        };\n        AjfFbConditionEditor.prototype.onEditorInit = function () {\n            monaco.languages.typescript.javascriptDefaults.setDiagnosticsOptions({ noSemanticValidation: false, noSyntaxValidation: false });\n            monaco.languages.typescript.javascriptDefaults.setCompilerOptions({\n                target: monaco.languages.typescript.ScriptTarget.ES2015,\n                allowNonTsExtensions: true,\n                allowJs: true,\n                module: monaco.languages.typescript.ModuleKind.None\n            });\n            try {\n                monaco.languages.typescript.javascriptDefaults.addExtraLib('', 'condition-editor-variables.d.ts');\n            }\n            catch (e) {\n                monaco.languages.typescript.javascriptDefaults._extraLibs['condition-editor-variables.d.ts'] =\n                    '';\n            }\n            try {\n                monaco.languages.typescript.javascriptDefaults.addExtraLib('', 'condition-editor-functions.d.ts');\n            }\n            catch (e) {\n                monaco.languages.typescript.javascriptDefaults._extraLibs['condition-editor-functions.d.ts'] =\n                    '';\n            }\n            this._updateVariables();\n            this._updateFunctions();\n        };\n        AjfFbConditionEditor.prototype._updateVariables = function () {\n            var _this = this;\n            if (this._fields == null) {\n                return;\n            }\n            try {\n                monaco.languages.typescript.javascriptDefaults._extraLibs['condition-editor-variables.d.ts'] =\n                    this._fields\n                        .map(function (field) {\n                        return \"declare const \" + field.name + \": \" + _this._fieldVarType(field.fieldType) + \";\";\n                    })\n                        .join('\\n');\n            }\n            catch (e) {\n            }\n        };\n        AjfFbConditionEditor.prototype._updateFunctions = function () {\n            try {\n                monaco.languages.typescript.javascriptDefaults._extraLibs['condition-editor-functions.d.ts'] =\n                    models.AjfExpressionUtils.UTIL_FUNCTIONS;\n            }\n            catch (e) {\n            }\n        };\n        AjfFbConditionEditor.prototype._fieldVarType = function (fieldType) {\n            switch (fieldType) {\n                case forms$1.AjfFieldType.Boolean:\n                    return 'boolean';\n                case forms$1.AjfFieldType.Date:\n                case forms$1.AjfFieldType.DateInput:\n                case forms$1.AjfFieldType.Time:\n                    return 'Date';\n                case forms$1.AjfFieldType.Empty:\n                    return 'void';\n                case forms$1.AjfFieldType.Formula:\n                    return 'number';\n                case forms$1.AjfFieldType.MultipleChoice:\n                case forms$1.AjfFieldType.SingleChoice:\n                    return 'any';\n                case forms$1.AjfFieldType.Number:\n                    return 'number';\n                case forms$1.AjfFieldType.Table:\n                    return 'Array';\n                case forms$1.AjfFieldType.String:\n                case forms$1.AjfFieldType.Text:\n                    return 'string';\n            }\n            return null;\n        };\n        return AjfFbConditionEditor;\n    }());\n    AjfFbConditionEditor.decorators = [\n        { type: core.Component, args: [{\n                    selector: 'ajf-condition-editor',\n                    template: \"<div class=\\\"ajf-editor\\\">\\n  <ajf-monaco-editor\\n      (init)=\\\"onEditorInit()\\\"\\n      (valueChange)=\\\"editedValue = $event\\\"\\n      [value]=\\\"condition\\\" language=\\\"javascript\\\"></ajf-monaco-editor>\\n</div>\\n<div class=\\\"ajf-editor-panel\\\">\\n  <ng-container *ngIf=\\\"fields as curFields\\\">\\n    <mat-nav-list dense *ngIf=\\\"curFields!.length > 0\\\">\\n      <a mat-list-item\\n          (click)=\\\"insertVariable(field.name)\\\"\\n          [matTooltip]=\\\"field.label\\\"\\n          *ngFor=\\\"let field of curFields!\\\">\\n        <ajf-node-icon [node]=\\\"field\\\"></ajf-node-icon>\\n        {{ field.name }}\\n      </a>\\n    </mat-nav-list>\\n  </ng-container>\\n</div>\\n\",\n                    changeDetection: core.ChangeDetectionStrategy.OnPush,\n                    encapsulation: core.ViewEncapsulation.None,\n                    styles: [\"ajf-condition-editor{display:flex;flex-direction:row;align-items:stretch;max-height:512px}ajf-condition-editor .ajf-editor{flex:.75 0 auto;display:flex;flex-direction:row;align-items:stretch}ajf-condition-editor .ajf-editor monaco-editor{flex:1 0 auto;min-width:512px;min-height:256px}ajf-condition-editor .ajf-editor-panel{flex:.25 0 auto;overflow-y:auto}ajf-condition-editor ajf-monaco-editor{min-width:400px}\\n\"]\n                },] }\n    ];\n    AjfFbConditionEditor.ctorParameters = function () { return [\n        { type: forms$1.AjfValidationService }\n    ]; };\n    AjfFbConditionEditor.propDecorators = {\n        monacoEditor: [{ type: core.ViewChild, args: [monacoEditor.AjfMonacoEditor, { static: true },] }],\n        fields: [{ type: core.Input }],\n        condition: [{ type: core.Input }]\n    };\n\n    /**\n     * @license\n     * Copyright (C) Gnucoop soc. coop.\n     *\n     * This file is part of the Advanced JSON forms (ajf).\n     *\n     * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n     * modify it under the terms of the GNU Affero General Public License as\n     * published by the Free Software Foundation, either version 3 of the License,\n     * or (at your option) any later version.\n     *\n     * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n     * but WITHOUT ANY WARRANTY; without even the implied warranty of\n     * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n     * General Public License for more details.\n     *\n     * You should have received a copy of the GNU Affero General Public License\n     * along with Advanced JSON forms (ajf).\n     * If not, see http://www.gnu.org/licenses/.\n     *\n     */\n    var AjfFbConditionEditorDialog = /** @class */ (function () {\n        function AjfFbConditionEditorDialog(service, dialogRef) {\n            this.dialogRef = dialogRef;\n            this._fields = service.flatFields.pipe(operators.map(function (fields) { return fields.sort(function (f1, f2) { return f1.name.localeCompare(f2.name); }); }));\n        }\n        Object.defineProperty(AjfFbConditionEditorDialog.prototype, \"fields\", {\n            get: function () {\n                return this._fields;\n            },\n            enumerable: false,\n            configurable: true\n        });\n        AjfFbConditionEditorDialog.prototype.saveCondition = function () {\n            if (this.editor == null) {\n                return;\n            }\n            var newValue = this.editor.editedValue;\n            this.dialogRef.close(newValue);\n        };\n        return AjfFbConditionEditorDialog;\n    }());\n    AjfFbConditionEditorDialog.decorators = [\n        { type: core.Component, args: [{\n                    selector: 'ajf-condition-editor-dialog',\n                    template: \"<h3 matDialogTitle translate>Edit condition</h3>\\n<mat-dialog-content>\\n  <ajf-condition-editor\\n      *ngIf=\\\"fields|async as curFields\\\"\\n      [fields]=\\\"curFields!\\\"\\n      [condition]=\\\"condition\\\"></ajf-condition-editor>\\n</mat-dialog-content>\\n<mat-dialog-actions>\\n  <button mat-button translate (click)=\\\"saveCondition()\\\">Save</button>\\n  <button mat-button translate matDialogClose>Close</button>\\n</mat-dialog-actions>\\n\",\n                    encapsulation: core.ViewEncapsulation.None,\n                    changeDetection: core.ChangeDetectionStrategy.OnPush,\n                    styles: [\"ajf-condition-editor-dialog mat-dialog-content{overflow:visible}\\n\"]\n                },] }\n    ];\n    AjfFbConditionEditorDialog.ctorParameters = function () { return [\n        { type: AjfFormBuilderService },\n        { type: dialog.MatDialogRef }\n    ]; };\n    AjfFbConditionEditorDialog.propDecorators = {\n        editor: [{ type: core.ViewChild, args: [AjfFbConditionEditor, { static: false },] }]\n    };\n\n    /**\n     * @license\n     * Copyright (C) Gnucoop soc. coop.\n     *\n     * This file is part of the Advanced JSON forms (ajf).\n     *\n     * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n     * modify it under the terms of the GNU Affero General Public License as\n     * published by the Free Software Foundation, either version 3 of the License,\n     * or (at your option) any later version.\n     *\n     * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n     * but WITHOUT ANY WARRANTY; without even the implied warranty of\n     * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n     * General Public License for more details.\n     *\n     * You should have received a copy of the GNU Affero General Public License\n     * along with Advanced JSON forms (ajf).\n     * If not, see http://www.gnu.org/licenses/.\n     *\n     */\n    /**\n     * Triggers when a field or slide node is moved or inserted by drag&dropping in the formbuilder.\n     * @param event The drop event.\n     * @param fbService The AjfFormBuilderService.\n     * @param nodeEntry The current nodeEntry, if present.\n     * @param content True if the current nodeEntry contains other nodeEntries.\n     */\n    function onDropProcess(event, fbService, nodeEntry, content) {\n        if (content === void 0) { content = false; }\n        var itemData = event.item.data;\n        var containerId = event.container.id;\n        if (!itemData.node) {\n            if (nodeEntry == null && containerId === 'slides-list') {\n                fbService.insertNode(itemData, null, 0, content, event.currentIndex);\n                return;\n            }\n            var emptySlot = content ? { parent: nodeEntry.node, parentNode: 0 } :\n                nodeEntry;\n            fbService.insertNode(itemData, emptySlot.parent, emptySlot.parentNode, content, event.currentIndex);\n            return;\n        }\n        var previousIndex = event.previousIndex;\n        var currentIndex = event.currentIndex;\n        fbService.moveNodeEntry(event.item.data, previousIndex, currentIndex);\n    }\n    /**\n     * Disables the drag&drop of Slide items.\n     * @param item The dragged item.\n     */\n    function disableSlideDropPredicate(item) {\n        return !item.data.isSlide;\n    }\n    /**\n     * Disables the drag&drop of Field items.\n     * @param item The dragged item.\n     */\n    function disableFieldDropPredicate(item) {\n        if (!item.data.isSlide) {\n            return false;\n        }\n        return true;\n    }\n\n    var AjfFbStringIdentifierDialogComponent = /** @class */ (function () {\n        function AjfFbStringIdentifierDialogComponent(_service, _cdr) {\n            var _this = this;\n            this._service = _service;\n            this._cdr = _cdr;\n            this.dataSource = new table.MatTableDataSource();\n            this.displayedColumns = ['label', 'value', 'delete'];\n            this.separatorKeysCodes = [keycodes.ENTER, keycodes.COMMA];\n            this._stringIdentifierSub = rxjs.Subscription.EMPTY;\n            this._stringIdentifierSub = _service.stringIdentifier.subscribe(function (identifier) {\n                _this.dataSource.data = __spreadArray([], __read(identifier));\n            });\n            this.fields$ = _service.flatFields.pipe(operators.map(function (fields) { return fields.sort(function (f1, f2) { return f1.name.localeCompare(f2.name); })\n                .map(function (f) { return f.name; })\n                .filter(function (f) { return f.length > 0; }); }), operators.shareReplay(1));\n        }\n        AjfFbStringIdentifierDialogComponent.prototype.addRow = function () {\n            this.dataSource.data = __spreadArray(__spreadArray([], __read(this.dataSource.data)), [{ label: '', value: [] }]);\n        };\n        AjfFbStringIdentifierDialogComponent.prototype.deleteRow = function (rowIdx) {\n            this.dataSource.data = __spreadArray(__spreadArray([], __read(this.dataSource.data.slice(0, rowIdx))), __read(this.dataSource.data.slice(rowIdx + 1)));\n        };\n        AjfFbStringIdentifierDialogComponent.prototype.addValue = function (row, evt, valueInput) {\n            if (evt.value.length === 0) {\n                return;\n            }\n            row.value = __spreadArray(__spreadArray([], __read(row.value)), [evt.value]);\n            valueInput.value = '';\n            this._cdr.markForCheck();\n        };\n        AjfFbStringIdentifierDialogComponent.prototype.removeValue = function (row, value) {\n            var idx = row.value.indexOf(value);\n            if (idx > -1) {\n                row.value = __spreadArray(__spreadArray([], __read(row.value.slice(0, idx))), __read(row.value.slice(idx + 1)));\n                this._cdr.markForCheck();\n            }\n        };\n        AjfFbStringIdentifierDialogComponent.prototype.ngOnDestroy = function () {\n            this._stringIdentifierSub.unsubscribe();\n        };\n        AjfFbStringIdentifierDialogComponent.prototype.saveStringIdentifier = function () {\n            this._service.saveStringIdentifier(this.dataSource.data);\n        };\n        AjfFbStringIdentifierDialogComponent.prototype.selected = function (row, evt) {\n            row.value = __spreadArray(__spreadArray([], __read(row.value)), [evt.option.value]);\n            this._cdr.markForCheck();\n        };\n        return AjfFbStringIdentifierDialogComponent;\n    }());\n    AjfFbStringIdentifierDialogComponent.decorators = [\n        { type: core.Component, args: [{\n                    selector: 'ajf-fb-string-identifier-dialog',\n                    template: \"<h3 matDialogTitle translate>Edit identifier</h3>\\n<mat-dialog-content>\\n  <button (click)=\\\"addRow()\\\" mat-button>\\n    <mat-icon>add</mat-icon>\\n    <span translate>Add value</span>\\n  </button>\\n  <mat-table [dataSource]=\\\"dataSource\\\">\\n    <ng-container matColumnDef=\\\"label\\\">\\n      <mat-header-cell *matHeaderCellDef translate>Label</mat-header-cell>\\n      <mat-cell *matCellDef=\\\"let row; let idx = index\\\">\\n        <mat-form-field>\\n          <input matInput [placeholder]=\\\"'Label'|translate\\\" autofocus [(ngModel)]=\\\"row.label\\\">\\n        </mat-form-field>\\n      </mat-cell>\\n    </ng-container>\\n    <ng-container matColumnDef=\\\"value\\\">\\n      <mat-header-cell *matHeaderCellDef translate>Value</mat-header-cell>\\n      <mat-cell *matCellDef=\\\"let row; let idx = index\\\">\\n        <mat-form-field>\\n          <mat-chip-list #chipList>\\n            <mat-chip\\n                *ngFor=\\\"let field of row.value\\\"\\n                (removed)=\\\"removeValue(row, field)\\\"\\n            >\\n              {{ field }}\\n              <mat-icon matChipRemove>cancel</mat-icon>\\n            </mat-chip>\\n          </mat-chip-list>\\n          <input\\n              #valueInput\\n              [ngModel]=\\\"row.value\\\"\\n              [matAutocomplete]=\\\"valueAc\\\"\\n              [matChipInputFor]=\\\"chipList\\\"\\n              [matChipInputSeparatorKeyCodes]=\\\"separatorKeysCodes\\\"\\n              [matChipInputAddOnBlur]=\\\"true\\\"\\n              (matChipInputTokenEnd)=\\\"addValue(row, $event, valueInput)\\\"\\n              [placeholder]=\\\"'Value'|translate\\\">\\n          <mat-autocomplete #valueAc=\\\"matAutocomplete\\\"\\n              (optionSelected)=\\\"selected(row, $event)\\\">\\n            <mat-option *ngFor=\\\"let field of fields$ | async\\\" [value]=\\\"field\\\">{{field}}</mat-option>\\n          </mat-autocomplete>\\n        </mat-form-field>\\n      </mat-cell>\\n    </ng-container>\\n    <ng-container matColumnDef=\\\"delete\\\">\\n      <mat-header-cell *matHeaderCellDef translate>Delete</mat-header-cell>\\n      <mat-cell *matCellDef=\\\"let row; let idx = index\\\">\\n          <mat-icon (click)=\\\"deleteRow(idx)\\\">delete</mat-icon>\\n      </mat-cell>\\n    </ng-container>\\n\\n    <mat-header-row *matHeaderRowDef=\\\"displayedColumns\\\"></mat-header-row>\\n    <mat-row *matRowDef=\\\"let row; columns: displayedColumns;\\\"></mat-row>\\n  </mat-table>\\n</mat-dialog-content>\\n<mat-dialog-actions>\\n  <button mat-button translate matDialogClose (click)=\\\"saveStringIdentifier()\\\">Save</button>\\n</mat-dialog-actions>\\n\",\n                    changeDetection: core.ChangeDetectionStrategy.OnPush,\n                    encapsulation: core.ViewEncapsulation.None,\n                    styles: [\"\\n\"]\n                },] }\n    ];\n    AjfFbStringIdentifierDialogComponent.ctorParameters = function () { return [\n        { type: AjfFormBuilderService },\n        { type: core.ChangeDetectorRef }\n    ]; };\n\n    /**\n     * @license\n     * Copyright (C) Gnucoop soc. coop.\n     *\n     * This file is part of the Advanced JSON forms (ajf).\n     *\n     * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n     * modify it under the terms of the GNU Affero General Public License as\n     * published by the Free Software Foundation, either version 3 of the License,\n     * or (at your option) any later version.\n     *\n     * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n     * but WITHOUT ANY WARRANTY; without even the implied warranty of\n     * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n     * General Public License for more details.\n     *\n     * You should have received a copy of the GNU Affero General Public License\n     * along with Advanced JSON forms (ajf).\n     * If not, see http://www.gnu.org/licenses/.\n     *\n     */\n    var AjfFormBuilder = /** @class */ (function () {\n        function AjfFormBuilder(_service, _dialog) {\n            var _this = this;\n            this._service = _service;\n            this._dialog = _dialog;\n            this._globalExpanded = false;\n            /**\n             * The list of the ids of all the dropLists connected to the formbuilder source list.\n             */\n            this._connectedDropLists = this._service.connectedDropLists;\n            this._vc = new core.EventEmitter();\n            this._init = false;\n            this._editConditionSub = rxjs.Subscription.EMPTY;\n            this._beforeNodesUpdateSub = rxjs.Subscription.EMPTY;\n            this._editChoicesOriginSub = rxjs.Subscription.EMPTY;\n            this._stringIdentifierSub = rxjs.Subscription.EMPTY;\n            this._nodeTypes = _service.availableNodeTypes;\n            this._nodeEntriesTree = _service.nodeEntriesTree;\n            this._choicesOrigins = _service.choicesOrigins;\n            this._editConditionSub =\n                this._service.editedCondition.subscribe(function (condition) {\n                    if (_this._editConditionDialog != null) {\n                        _this._editConditionDialog.close();\n                        _this._editConditionDialog = null;\n                    }\n                    if (condition != null) {\n                        _this._editConditionDialog =\n                            _this._dialog.open(AjfFbConditionEditorDialog, { disableClose: true });\n                    }\n                });\n            this._editChoicesOriginSub =\n                this._service.editedChoicesOrigin.subscribe(function (choicesOrigin) {\n                    if (_this._editChoicesOriginDialog != null) {\n                        _this._editChoicesOriginDialog.close();\n                        _this._editChoicesOriginDialog = null;\n                    }\n                    if (choicesOrigin != null) {\n                        _this._editChoicesOriginDialog =\n                            _this._dialog.open(AjfFbChoicesOriginEditorDialog, { disableClose: true });\n                    }\n                });\n            this._beforeNodesUpdateSub = this._service.beforeNodesUpdate.subscribe(function () {\n                if (_this.designerCont == null) {\n                    return;\n                }\n                _this._lastScrollTop = _this.designerCont.nativeElement.scrollTop;\n            });\n            this.nodeEntriesTree.pipe(operators.sample(this._vc)).subscribe(function () {\n                if (_this.designerCont == null) {\n                    return;\n                }\n                _this.designerCont.nativeElement.scrollTop = _this._lastScrollTop;\n            });\n            this._stringIdentifierSub = this._service.stringIdentifier.subscribe(function () { });\n        }\n        Object.defineProperty(AjfFormBuilder.prototype, \"form\", {\n            get: function () {\n                return this._form;\n            },\n            set: function (form) {\n                if (this._form !== form) {\n                    this._form = form;\n                    if (this._init) {\n                        this._setCurrentForm();\n                    }\n                }\n            },\n            enumerable: false,\n            configurable: true\n        });\n        Object.defineProperty(AjfFormBuilder.prototype, \"nodeTypes\", {\n            get: function () {\n                return this._nodeTypes;\n            },\n            enumerable: false,\n            configurable: true\n        });\n        Object.defineProperty(AjfFormBuilder.prototype, \"nodeEntriesTree\", {\n            get: function () {\n                return this._nodeEntriesTree;\n            },\n            enumerable: false,\n            configurable: true\n        });\n        Object.defineProperty(AjfFormBuilder.prototype, \"choicesOrigins\", {\n            get: function () {\n                return this._choicesOrigins;\n            },\n            enumerable: false,\n            configurable: true\n        });\n        Object.defineProperty(AjfFormBuilder.prototype, \"isGlobalExpanded\", {\n            get: function () {\n                return this._globalExpanded;\n            },\n            enumerable: false,\n            configurable: true\n        });\n        Object.defineProperty(AjfFormBuilder.prototype, \"connectedDropLists\", {\n            get: function () {\n                return this._connectedDropLists;\n            },\n            enumerable: false,\n            configurable: true\n        });\n        AjfFormBuilder.prototype.ngAfterViewChecked = function () {\n            this._vc.emit();\n        };\n        AjfFormBuilder.prototype.ngAfterContentInit = function () {\n            this._setCurrentForm();\n            this._init = true;\n        };\n        AjfFormBuilder.prototype.ngOnDestroy = function () {\n            this._editConditionSub.unsubscribe();\n            this._beforeNodesUpdateSub.unsubscribe();\n            this._editChoicesOriginSub.unsubscribe();\n            this._stringIdentifierSub.unsubscribe();\n            this._service.setForm(null);\n        };\n        AjfFormBuilder.prototype.createChoicesOrigin = function () {\n            this._service.createChoicesOrigin();\n        };\n        AjfFormBuilder.prototype.disableDrop = function () {\n            return false;\n        };\n        AjfFormBuilder.prototype.disableFieldDrop = function (item) {\n            return disableFieldDropPredicate(item);\n        };\n        /**\n         * Triggers when a field or slide node is moved or inserted by drag&dropping in the formbuilder.\n         * @param event The drop event.\n         * @param content True if the current nodeEntry contains other nodeEntries.\n         */\n        AjfFormBuilder.prototype.onDrop = function (event, content) {\n            if (content === void 0) { content = false; }\n            onDropProcess(event, this._service, null, content);\n        };\n        AjfFormBuilder.prototype.editChoicesOrigin = function (choicesOrigin) {\n            this._service.editChoicesOrigin(choicesOrigin);\n        };\n        AjfFormBuilder.prototype.editStringIdentifier = function () {\n            if (this._stringIdentifierDialog != null) {\n                this._stringIdentifierDialog.close();\n                this._stringIdentifierDialog = null;\n            }\n            this._stringIdentifierDialog = this._dialog.open(AjfFbStringIdentifierDialogComponent, { disableClose: true, width: '60%', height: '60%' });\n        };\n        AjfFormBuilder.prototype.expandAll = function () {\n            this._globalExpanded = true;\n        };\n        AjfFormBuilder.prototype.collapseAll = function () {\n            this._globalExpanded = false;\n        };\n        AjfFormBuilder.prototype.expandToggle = function (evt) {\n            if (evt.checked) {\n                this.expandAll();\n            }\n            else {\n                this.collapseAll();\n            }\n        };\n        AjfFormBuilder.prototype._setCurrentForm = function () {\n            this._service.setForm(this._form);\n        };\n        return AjfFormBuilder;\n    }());\n    AjfFormBuilder.decorators = [\n        { type: core.Component, args: [{\n                    selector: 'ajf-form-builder',\n                    template: \"<mat-toolbar>\\n  <button mat-icon-button (click)=\\\"leftSidenav.toggle()\\\">\\n    <mat-icon>add_box</mat-icon>\\n  </button>\\n  <button mat-button [matMenuTriggerFor]=\\\"choicesMenu\\\" translate>Choices</button>\\n  <button mat-button (click)=\\\"editStringIdentifier()\\\" translate>Identifier</button>\\n  <button mat-icon-button aria-label=\\\"Collapsed\\\" matTooltip=\\\"Keep slides collapsed\\\">\\n    <mat-icon>unfold_less</mat-icon>\\n  </button>\\n  <mat-slide-toggle color=\\\"primary\\\" (change)=\\\"expandToggle($event)\\\"></mat-slide-toggle> \\n  <button mat-icon-button aria-label=\\\"Expanded\\\" matTooltip=\\\"Keep slides expanded\\\">\\n    <mat-icon>unfold_more</mat-icon>\\n  </button>\\n  <mat-menu #choicesMenu>\\n    <button (click)=\\\"createChoicesOrigin()\\\" mat-menu-item translate>New..</button>\\n    <ng-container *ngIf=\\\"choicesOrigins|async as cos\\\">\\n      <button *ngFor=\\\"let choicesOrigin of cos\\\"\\n          (click)=\\\"editChoicesOrigin(choicesOrigin)\\\" mat-menu-item>\\n        {{ choicesOrigin.label || choicesOrigin.name }}\\n      </button>\\n    </ng-container>\\n  </mat-menu>\\n  <span class=\\\"ajf-spacer\\\"></span>\\n  <button mat-icon-button (click)=\\\"rightSidenav.toggle()\\\">\\n    <mat-icon>settings</mat-icon>\\n  </button>\\n</mat-toolbar>\\n<mat-drawer-container cdkDropListGroup>\\n  <mat-drawer #leftSidenav position=\\\"start\\\" mode=\\\"over\\\">\\n    <div #sourceDropList cdkDropList\\n        [cdkDropListConnectedTo]=\\\"(connectedDropLists|async)!\\\"\\n        [cdkDropListEnterPredicate]=\\\"disableDrop\\\"\\n        [cdkDropListData]=\\\"nodeTypes\\\">\\n      <ajf-fb-node-type-entry *ngFor=\\\"let nodeType of nodeTypes\\\"\\n          cdkDrag\\n          [cdkDragData]=\\\"nodeType\\\"\\n          (cdkDragStarted)=\\\"leftSidenav.close()\\\"\\n          [nodeType]=\\\"nodeType\\\"></ajf-fb-node-type-entry>\\n    </div>\\n  </mat-drawer>\\n  <mat-drawer #rightSidenav position=\\\"end\\\" mode=\\\"side\\\" [opened]=\\\"true\\\">\\n    <ajf-fb-node-properties></ajf-fb-node-properties>\\n  </mat-drawer>\\n  <div #designer class=\\\"ajf-designer\\\">\\n    <ajf-fb-node-entry id=\\\"slides-list\\\"\\n        cdkDropList\\n        (cdkDropListDropped)=\\\"onDrop($event)\\\"\\n        [cdkDropListEnterPredicate]=\\\"disableFieldDrop\\\"\\n        *ngFor=\\\"let nodeEntry of (nodeEntriesTree|async); let isFirst = first\\\"\\n        [isExpanded]=\\\"isGlobalExpanded\\\"\\n        [isFirst]=\\\"isFirst\\\"\\n        [nodeEntry]=\\\"nodeEntry\\\"></ajf-fb-node-entry>\\n  </div>\\n</mat-drawer-container>\\n\",\n                    changeDetection: core.ChangeDetectionStrategy.OnPush,\n                    encapsulation: core.ViewEncapsulation.None,\n                    styles: [\"ajf-form-builder{display:flex;position:relative;min-height:300px;flex-direction:column;align-items:stretch}ajf-form-builder mat-toolbar mat-menu div[mat-menu-item]>button[mat-button]{flex:1 0 auto}ajf-form-builder mat-toolbar mat-menu div[mat-menu-item]>button[mat-icon-button]{flex:0 0 auto}ajf-form-builder mat-drawer-container{flex:1}ajf-form-builder mat-drawer-container mat-drawer{max-width:20%}ajf-form-builder mat-drawer-container .ajf-designer{padding:1em}ajf-form-builder mat-toolbar .ajf-spacer{flex:1 1 auto}\\n\"]\n                },] }\n    ];\n    AjfFormBuilder.ctorParameters = function () { return [\n        { type: AjfFormBuilderService },\n        { type: dialog.MatDialog }\n    ]; };\n    AjfFormBuilder.propDecorators = {\n        designerCont: [{ type: core.ViewChild, args: ['designer', { static: true },] }],\n        form: [{ type: core.Input }]\n    };\n\n    /**\n     * @license\n     * Copyright (C) Gnucoop soc. coop.\n     *\n     * This file is part of the Advanced JSON forms (ajf).\n     *\n     * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n     * modify it under the terms of the GNU Affero General Public License as\n     * published by the Free Software Foundation, either version 3 of the License,\n     * or (at your option) any later version.\n     *\n     * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n     * but WITHOUT ANY WARRANTY; without even the implied warranty of\n     * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n     * General Public License for more details.\n     *\n     * You should have received a copy of the GNU Affero General Public License\n     * along with Advanced JSON forms (ajf).\n     * If not, see http://www.gnu.org/licenses/.\n     *\n     */\n    var branchColors = [\n        '#F44336',\n        '#4CAF50',\n        '#3F51B5',\n        '#FFC107',\n        '#795548', // BROWN\n    ];\n    var AjfFbNodeEntry = /** @class */ (function () {\n        function AjfFbNodeEntry(_service) {\n            this._service = _service;\n            this._hasContent = false;\n            this._isFirst = false;\n            this._isNodeEntry = false;\n            this._isExpanded = false;\n            this._level = 0;\n            this._isDraggable = true;\n            this._branchColors = branchColors.slice(0);\n            this._dropZones = ['fbdz-node'];\n            this._slideDropZones = ['fbdz-slide'];\n            this._originOffset = 0;\n            this._originLeftMargin = '0';\n            this._firstBranchColor = branchColors[0];\n            this._branchLinesSubscription = rxjs.Subscription.EMPTY;\n            this._childEntriesSubscription = rxjs.Subscription.EMPTY;\n            this._currentEditedNode = this._service.editedNodeEntry;\n        }\n        Object.defineProperty(AjfFbNodeEntry.prototype, \"hasContent\", {\n            get: function () {\n                return this._hasContent;\n            },\n            enumerable: false,\n            configurable: true\n        });\n        Object.defineProperty(AjfFbNodeEntry.prototype, \"isFirst\", {\n            get: function () {\n                return this._isFirst;\n            },\n            set: function (isFirst) {\n                this._isFirst = isFirst;\n            },\n            enumerable: false,\n            configurable: true\n        });\n        Object.defineProperty(AjfFbNodeEntry.prototype, \"isNodeEntry\", {\n            get: function () {\n                return this._isNodeEntry;\n            },\n            enumerable: false,\n            configurable: true\n        });\n        Object.defineProperty(AjfFbNodeEntry.prototype, \"isExpanded\", {\n            get: function () {\n                return this._isExpanded;\n            },\n            set: function (exp) {\n                var _this = this;\n                this._isExpanded = exp;\n                setTimeout(function () { return _this._updateBranchHeights(); }, 400);\n            },\n            enumerable: false,\n            configurable: true\n        });\n        Object.defineProperty(AjfFbNodeEntry.prototype, \"nodeEntry\", {\n            get: function () {\n                return this._nodeEntry;\n            },\n            set: function (nodeEntry) {\n                this._nodeEntry = nodeEntry;\n                if (nodeEntry != null && nodeEntry.node !== void 0) {\n                    var ne = nodeEntry;\n                    this._isNodeEntry = true;\n                    var node = ne.node;\n                    this._hasContent = node != null && forms$1.isContainerNode(node);\n                }\n                else {\n                    this._isNodeEntry = false;\n                    this._hasContent = false;\n                }\n            },\n            enumerable: false,\n            configurable: true\n        });\n        Object.defineProperty(AjfFbNodeEntry.prototype, \"level\", {\n            get: function () {\n                return this._level;\n            },\n            set: function (value) {\n                this._level = value;\n            },\n            enumerable: false,\n            configurable: true\n        });\n        Object.defineProperty(AjfFbNodeEntry.prototype, \"isDraggable\", {\n            get: function () {\n                return this._isDraggable;\n            },\n            set: function (draggable) {\n                this._isDraggable = draggable;\n            },\n            enumerable: false,\n            configurable: true\n        });\n        Object.defineProperty(AjfFbNodeEntry.prototype, \"realNodeEntry\", {\n            get: function () {\n                return this._nodeEntry;\n            },\n            enumerable: false,\n            configurable: true\n        });\n        Object.defineProperty(AjfFbNodeEntry.prototype, \"branchColors\", {\n            get: function () {\n                return this._branchColors;\n            },\n            enumerable: false,\n            configurable: true\n        });\n        Object.defineProperty(AjfFbNodeEntry.prototype, \"dropZones\", {\n            get: function () {\n                return this._dropZones;\n            },\n            enumerable: false,\n            configurable: true\n        });\n        Object.defineProperty(AjfFbNodeEntry.prototype, \"slideDropZones\", {\n            get: function () {\n                return this._slideDropZones;\n            },\n            enumerable: false,\n            configurable: true\n        });\n        Object.defineProperty(AjfFbNodeEntry.prototype, \"originOffset\", {\n            get: function () {\n                return this._originOffset;\n            },\n            set: function (originOffset) {\n                this._originOffset = originOffset;\n                this._originLeftMargin = this._originOffset * 4 + \"px\";\n            },\n            enumerable: false,\n            configurable: true\n        });\n        Object.defineProperty(AjfFbNodeEntry.prototype, \"originLeftMargin\", {\n            get: function () {\n                return this._originLeftMargin;\n            },\n            enumerable: false,\n            configurable: true\n        });\n        Object.defineProperty(AjfFbNodeEntry.prototype, \"firstBranchColor\", {\n            get: function () {\n                return this._firstBranchColor;\n            },\n            set: function (firstBranchColor) {\n                var idx = branchColors.indexOf(firstBranchColor);\n                if (idx > 0) {\n                    this._firstBranchColor = firstBranchColor;\n                    this._branchColors = branchColors.slice(idx).concat(branchColors.slice(0, idx));\n                }\n                else {\n                    this._firstBranchColor = branchColors[0];\n                    this._branchColors = branchColors.slice(0);\n                }\n            },\n            enumerable: false,\n            configurable: true\n        });\n        Object.defineProperty(AjfFbNodeEntry.prototype, \"currentEditedNode\", {\n            get: function () {\n                return this._currentEditedNode;\n            },\n            enumerable: false,\n            configurable: true\n        });\n        AjfFbNodeEntry.prototype.onResize = function () { };\n        AjfFbNodeEntry.prototype.edit = function (evt) {\n            evt.stopPropagation();\n            if (this.nodeEntry == null || !this.isNodeEntry) {\n                return;\n            }\n            this._service.editNodeEntry(this.nodeEntry);\n        };\n        AjfFbNodeEntry.prototype.delete = function (evt) {\n            evt.stopPropagation();\n            if (this.nodeEntry == null || !this.isNodeEntry) {\n                return;\n            }\n            this._service.deleteNodeEntry(this.nodeEntry);\n        };\n        AjfFbNodeEntry.prototype.isLastNode = function () {\n            if (!this.realNodeEntry || !this.realNodeEntry.children) {\n                return false;\n            }\n            return !this.realNodeEntry.children[0].children;\n        };\n        AjfFbNodeEntry.prototype.isSlide = function (node) {\n            return forms$1.isSlidesNode(node);\n        };\n        AjfFbNodeEntry.prototype.ngAfterViewInit = function () {\n            var _this = this;\n            setTimeout(function () { return _this._updateBranchHeights(); });\n            this._childEntriesSubscription = this.childEntries.changes.subscribe(function () {\n                _this._updateBranchHeights();\n            });\n        };\n        AjfFbNodeEntry.prototype.ngOnDestroy = function () {\n            this._branchLinesSubscription.unsubscribe();\n            this._childEntriesSubscription.unsubscribe();\n        };\n        /**\n         * Triggers when a field or slide node is moved or inserted by drag&dropping in the formbuilder.\n         * @param event The drop event.\n         * @param content True if the current nodeEntry contains other nodeEntries.\n         */\n        AjfFbNodeEntry.prototype.onDrop = function (event, content) {\n            if (content === void 0) { content = false; }\n            onDropProcess(event, this._service, this._nodeEntry, content);\n        };\n        /**\n         * Assigns a progressive id to the dropList, to connect it to the FormBuilder source list.\n         * @param empty True if the list is marked as empty.\n         */\n        AjfFbNodeEntry.prototype.assignId = function (empty) {\n            if (empty === void 0) { empty = false; }\n            return this._service.assignListId(this.realNodeEntry.node, empty);\n        };\n        AjfFbNodeEntry.prototype.disableSlideDrop = function (item) {\n            return disableSlideDropPredicate(item);\n        };\n        AjfFbNodeEntry.prototype.disableFieldDrop = function (item) {\n            return disableFieldDropPredicate(item);\n        };\n        AjfFbNodeEntry.prototype.emptyAreaDropPredicate = function () {\n            var _this = this;\n            return function (item, _drop) {\n                if (_this._level > 0) {\n                    return !item.data.isSlide;\n                }\n                return item.data.isSlide || false;\n            };\n        };\n        AjfFbNodeEntry.prototype._updateBranchHeights = function () {\n            if (this.nodeEntry == null || !this.isNodeEntry || this.branchLines == null ||\n                this.childEntries == null) {\n                return;\n            }\n            var nodeEntry = this.nodeEntry;\n            var branchLines = this.branchLines.toArray();\n            var sliceIdx = nodeEntry.content != null ? nodeEntry.content.length : 0;\n            var childEntries = this.childEntries.toArray().slice(sliceIdx);\n            if (branchLines.length != childEntries.length) {\n                return;\n            }\n            branchLines.forEach(function (bl, idx) {\n                var ce = childEntries[idx];\n                bl.height = ce.nativeElement.offsetTop;\n            });\n        };\n        return AjfFbNodeEntry;\n    }());\n    AjfFbNodeEntry.decorators = [\n        { type: core.Component, args: [{\n                    selector: 'ajf-fb-node-entry',\n                    template: \"<ng-container *ngIf=\\\"nodeEntry != null ; else rootEmpty\\\">\\n  <ng-template [ngIf]=\\\"isNodeEntry && !isLastNode()\\\">\\n    <ajf-fb-branch-line\\n      *ngFor=\\\"let childNodeEntry of realNodeEntry.children; let idx = index\\\"\\n      [offset]=\\\"idx\\\"\\n      [color]=\\\"branchColors[idx]\\\"\\n    ></ajf-fb-branch-line>\\n  </ng-template>\\n\\n  <div\\n    class=\\\"mat-card-container\\\"\\n    [class.ajf-highlight]=\\\"(currentEditedNode|async) == nodeEntry\\\"\\n  >\\n    <div\\n      *ngIf=\\\"!isFirst\\\"\\n      class=\\\"ajf-origin-line\\\"\\n      [style.margin-left]=\\\"originLeftMargin\\\"\\n      [style.border-color]=\\\"firstBranchColor\\\"\\n    ></div>\\n    <ng-template [ngIf]=\\\"isNodeEntry\\\">\\n      <ng-container *ngIf=\\\"!isDraggable; else draggable\\\">\\n        <mat-card>\\n          <ng-container *ngTemplateOutlet=\\\"cardTitle\\\"></ng-container>\\n          <ng-container *ngTemplateOutlet=\\\"cardContent\\\"></ng-container>\\n        </mat-card>\\n      </ng-container>\\n\\n      <ng-template #draggable>\\n        <mat-card cdkDrag [cdkDragData]=\\\"realNodeEntry\\\" class=\\\"ajf-draggable-box\\\">\\n          <ng-container\\n            *ngIf=\\\"isSlide(realNodeEntry.node); else fieldPanel\\\"\\n          >\\n            <ng-container *ngTemplateOutlet=\\\"slidePanel\\\"></ng-container>\\n          </ng-container>\\n        </mat-card>\\n      </ng-template>\\n\\n      <ng-template #slidePanel>\\n        <mat-expansion-panel\\n          [expanded]=\\\"isExpanded\\\"\\n          (opened)=\\\"isExpanded = true\\\"\\n          (closed)=\\\"isExpanded = false\\\"\\n          class=\\\"mat-elevation-z\\\"\\n        >\\n          <mat-expansion-panel-header>\\n            <ng-container *ngTemplateOutlet=\\\"cardTitle\\\"></ng-container>\\n          </mat-expansion-panel-header>\\n          <ng-container *ngTemplateOutlet=\\\"cardContent\\\"></ng-container>\\n        </mat-expansion-panel>\\n      </ng-template>\\n\\n      <ng-template #fieldPanel>\\n        <ng-container *ngTemplateOutlet=\\\"cardTitle\\\"></ng-container>\\n        <ng-container *ngTemplateOutlet=\\\"cardContent\\\"></ng-container>\\n      </ng-template>\\n\\n      <ng-template #cardTitle>\\n        <div class=\\\"ajf-title-row\\\">\\n          <ajf-node-icon [node]=\\\"realNodeEntry.node\\\"></ajf-node-icon>\\n          <span\\n            class=\\\"ajf-title\\\"\\n            [innerHTML]=\\\"(realNodeEntry.node.label || realNodeEntry.node.name)  | translate\\\"\\n          ></span>\\n          <span\\n            *ngIf=\\\"realNodeEntry.node.visibility && realNodeEntry.node.visibility?.condition !== 'true'\\\"\\n            class=\\\"ajf-visibility-condition\\\"\\n            [innerHTML]=\\\"'Condition: (' + realNodeEntry.node.visibility?.condition + ')'\\\"\\n          >\\n          </span>\\n          <span class=\\\"ajf-actions\\\">\\n            <button\\n              [disabled]=\\\"(currentEditedNode|async) == nodeEntry\\\"\\n              (click)=\\\"edit($event)\\\"\\n              mat-icon-button\\n            >\\n              <mat-icon>edit</mat-icon>\\n            </button>\\n            <button\\n              [disabled]=\\\"(currentEditedNode|async) == null\\\"\\n              (click)=\\\"delete($event)\\\"\\n              mat-icon-button\\n            >\\n              <mat-icon>delete</mat-icon>\\n            </button>\\n          </span>\\n        </div>\\n      </ng-template>\\n\\n      <ng-template #cardContent>\\n        <div *ngIf=\\\"hasContent\\\">\\n          <ajf-fb-node-entry\\n            cdkDropList\\n            class=\\\"ajf-fields-list\\\"\\n            *ngFor=\\\"let contentEntry of realNodeEntry.content; let isFirstChild = first; let idx = index\\\"\\n            [id]=\\\"assignId()\\\"\\n            [level]=\\\"level + 1\\\"\\n            [isFirst]=\\\"isFirstChild\\\"\\n            [firstBranchColor]=\\\"branchColors[idx]\\\"\\n            [nodeEntry]=\\\"contentEntry\\\"\\n            [cdkDropListEnterPredicate]=\\\"disableSlideDrop\\\"\\n            (cdkDropListDropped)=\\\"onDrop($event, true)\\\"\\n            [isExpanded]=\\\"isExpanded\\\"\\n          ></ajf-fb-node-entry>\\n          <mat-card\\n            class=\\\"ajf-empty\\\"\\n            *ngIf=\\\"realNodeEntry.content.length === 0\\\"\\n            cdkDropList\\n            [id]=\\\"assignId(true)\\\"\\n            [cdkDropListEnterPredicate]=\\\"disableSlideDrop\\\"\\n            (cdkDropListDropped)=\\\"onDrop($event, true)\\\"\\n            ><mat-card-title>Drop your fields here</mat-card-title></mat-card\\n          >\\n        </div>\\n      </ng-template>\\n    </ng-template>\\n  </div>\\n\\n  <ng-template [ngIf]=\\\"isNodeEntry\\\">\\n    <ng-container\\n      *ngFor=\\\"let childNodeEntry of realNodeEntry.children; let idx = index\\\"\\n    >\\n      <ajf-fb-node-entry\\n        *ngIf=\\\"!isLastNode()\\\"\\n        [level]=\\\"level\\\"\\n        [originOffset]=\\\"idx\\\"\\n        [firstBranchColor]=\\\"branchColors[idx]\\\"\\n        [nodeEntry]=\\\"childNodeEntry\\\"\\n        [isExpanded]=\\\"isExpanded\\\"\\n      ></ajf-fb-node-entry>\\n    </ng-container>\\n  </ng-template>\\n</ng-container>\\n\\n<ng-template #rootEmpty>\\n  <div class=\\\"mat-card-container\\\">\\n    <mat-card\\n      class=\\\"ajf-empty\\\"\\n      cdkDropList\\n      [cdkDropListEnterPredicate]=\\\"emptyAreaDropPredicate()\\\"\\n      (cdkDropListDropped)=\\\"onDrop($event)\\\"\\n      ><mat-card-title>Drop your slides here</mat-card-title>\\n    </mat-card>\\n  </div>\\n</ng-template>\\n\",\n                    host: { '(window.resize)': 'onResize()' },\n                    encapsulation: core.ViewEncapsulation.None,\n                    changeDetection: core.ChangeDetectionStrategy.OnPush,\n                    styles: [\"ajf-fb-node-entry{display:block;position:relative}ajf-fb-node-entry .mat-card-container{position:relative}ajf-fb-node-entry .mat-card-container .ajf-origin-line{position:absolute;top:0;left:25px;width:25px;height:25px;border-bottom:2px solid;border-left:2px solid;border-bottom-left-radius:.5em}ajf-fb-node-entry .mat-card-container mat-card{margin-left:50px;padding:.5em 1em;margin-top:.2em;margin-bottom:.2em;background-color:#fff}ajf-fb-node-entry .mat-card-container mat-card .ajf-title-row{display:flex;flex:1 1 auto;flex-direction:row;align-items:center}ajf-fb-node-entry .mat-card-container mat-card .ajf-title-row>.ajf-title{flex:1 1 auto}ajf-fb-node-entry .mat-card-container mat-card .ajf-title-row>.ajf-visibility-condition{flex:1 1 auto;font-size:10px;color:#999}ajf-fb-node-entry .mat-card-container mat-card .ajf-title-row>.ajf-actions{flex:0 0 auto;white-space:nowrap}ajf-fb-node-entry .mat-card-container mat-card.ajf-empty{line-height:36px;border:2px dashed;box-shadow:none;box-sizing:border-box;text-align:center;color:#ccc}ajf-fb-node-entry .mat-card-container mat-card.ajf-draggable-box{padding:20px 10px;border-bottom:solid 1px #ccc;border-right:solid 1px #ccc;color:rgba(0,0,0,.87);box-sizing:border-box;cursor:move;background:#fff;font-size:14px}ajf-fb-node-entry .mat-card-container.ajf-highlight>mat-card{background-color:#fff9c4}ajf-fb-node-entry.ajf-fields-list{max-width:80%;min-height:60px;display:block;background:#fff;border-radius:4px;overflow:hidden}ajf-fb-node-entry .cdk-drag-placeholder{opacity:0;min-height:60px}ajf-fb-node-entry .ajf-fields-list.cdk-drop-list-dragging .ajf-draggable-box:not(.cdk-drag-placeholder),ajf-fb-node-entry .cdk-drag-animating{transition:transform 250ms cubic-bezier(0, 0, 0.2, 1)}\\n\"]\n                },] }\n    ];\n    AjfFbNodeEntry.ctorParameters = function () { return [\n        { type: AjfFormBuilderService }\n    ]; };\n    AjfFbNodeEntry.propDecorators = {\n        branchLines: [{ type: core.ViewChildren, args: [AjfFbBranchLine,] }],\n        childEntries: [{ type: core.ViewChildren, args: [AjfFbNodeEntry, { read: core.ElementRef },] }],\n        isFirst: [{ type: core.Input }],\n        isExpanded: [{ type: core.Input }],\n        nodeEntry: [{ type: core.Input }],\n        level: [{ type: core.Input }],\n        isDraggable: [{ type: core.Input }],\n        originOffset: [{ type: core.Input }],\n        firstBranchColor: [{ type: core.Input }]\n    };\n\n    /**\n     * @license\n     * Copyright (C) Gnucoop soc. coop.\n     *\n     * This file is part of the Advanced JSON forms (ajf).\n     *\n     * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n     * modify it under the terms of the GNU Affero General Public License as\n     * published by the Free Software Foundation, either version 3 of the License,\n     * or (at your option) any later version.\n     *\n     * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n     * but WITHOUT ANY WARRANTY; without even the implied warranty of\n     * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n     * General Public License for more details.\n     *\n     * You should have received a copy of the GNU Affero General Public License\n     * along with Advanced JSON forms (ajf).\n     * If not, see http://www.gnu.org/licenses/.\n     *\n     */\n    var AjfFbValidationConditionEditorDialog = /** @class */ (function () {\n        function AjfFbValidationConditionEditorDialog(service, dialogRef) {\n            this.dialogRef = dialogRef;\n            this._fields = service.flatFields.pipe(operators.map(function (fields) { return fields.sort(function (f1, f2) { return f1.name.localeCompare(f2.name); }); }));\n        }\n        Object.defineProperty(AjfFbValidationConditionEditorDialog.prototype, \"fields\", {\n            get: function () {\n                return this._fields;\n            },\n            enumerable: false,\n            configurable: true\n        });\n        AjfFbValidationConditionEditorDialog.prototype.saveCondition = function () {\n            if (this.editor == null) {\n                return;\n            }\n            var newValue = this.editor.editedValue;\n            this.dialogRef.close({ condition: newValue, errorMessage: this.errorMessage });\n        };\n        return AjfFbValidationConditionEditorDialog;\n    }());\n    AjfFbValidationConditionEditorDialog.decorators = [\n        { type: core.Component, args: [{\n                    selector: 'ajf-fb-validation-condition-editor-dialog',\n                    template: \"<h3 matDialogTitle translate>Edit condition</h3>\\n<mat-dialog-content>\\n  <mat-form-field>\\n    <input matInput [(ngModel)]=\\\"errorMessage\\\" [placeholder]=\\\"'Error message' | translate\\\">\\n  </mat-form-field>\\n  <ajf-condition-editor\\n      *ngIf=\\\"fields|async as curFields\\\"\\n      [fields]=\\\"curFields!\\\"\\n      [condition]=\\\"condition\\\"></ajf-condition-editor>\\n</mat-dialog-content>\\n<mat-dialog-actions>\\n  <button mat-button translate (click)=\\\"saveCondition()\\\">Save</button>\\n  <button mat-button translate matDialogClose>Close</button>\\n</mat-dialog-actions>\\n\",\n                    encapsulation: core.ViewEncapsulation.None,\n                    changeDetection: core.ChangeDetectionStrategy.OnPush,\n                    styles: [\"ajf-fb-validation-condition-editor-dialog mat-dialog-content{overflow:visible}\\n\"]\n                },] }\n    ];\n    AjfFbValidationConditionEditorDialog.ctorParameters = function () { return [\n        { type: AjfFormBuilderService },\n        { type: dialog.MatDialogRef }\n    ]; };\n    AjfFbValidationConditionEditorDialog.propDecorators = {\n        editor: [{ type: core.ViewChild, args: [AjfFbConditionEditor, { static: false },] }]\n    };\n\n    /**\n     * @license\n     * Copyright (C) Gnucoop soc. coop.\n     *\n     * This file is part of the Advanced JSON forms (ajf).\n     *\n     * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n     * modify it under the terms of the GNU Affero General Public License as\n     * published by the Free Software Foundation, either version 3 of the License,\n     * or (at your option) any later version.\n     *\n     * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n     * but WITHOUT ANY WARRANTY; without even the implied warranty of\n     * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n     * General Public License for more details.\n     *\n     * You should have received a copy of the GNU Affero General Public License\n     * along with Advanced JSON forms (ajf).\n     * If not, see http://www.gnu.org/licenses/.\n     *\n     */\n    var AjfFbWarningConditionEditorDialog = /** @class */ (function () {\n        function AjfFbWarningConditionEditorDialog(service, dialogRef) {\n            this.dialogRef = dialogRef;\n            this._fields = service.flatFields.pipe(operators.map(function (fields) { return fields.sort(function (f1, f2) { return f1.name.localeCompare(f2.name); }); }));\n        }\n        Object.defineProperty(AjfFbWarningConditionEditorDialog.prototype, \"fields\", {\n            get: function () {\n                return this._fields;\n            },\n            enumerable: false,\n            configurable: true\n        });\n        AjfFbWarningConditionEditorDialog.prototype.saveCondition = function () {\n            if (this.editor == null) {\n                return;\n            }\n            var newValue = this.editor.editedValue;\n            this.dialogRef.close({ condition: newValue, warningMessage: this.warningMessage });\n        };\n        return AjfFbWarningConditionEditorDialog;\n    }());\n    AjfFbWarningConditionEditorDialog.decorators = [\n        { type: core.Component, args: [{\n                    selector: 'ajf-fb-warning-condition-editor-dialog',\n                    template: \"<h3 matDialogTitle translate>Edit condition</h3>\\n<mat-dialog-content>\\n  <mat-form-field>\\n    <input matInput [(ngModel)]=\\\"warningMessage\\\"\\n      [placeholder]=\\\"'Warning message' | translate\\\">\\n  </mat-form-field>\\n  <ajf-condition-editor\\n      *ngIf=\\\"fields|async as curFields\\\"\\n      [fields]=\\\"curFields!\\\"\\n      [condition]=\\\"condition\\\"></ajf-condition-editor>\\n</mat-dialog-content>\\n<mat-dialog-actions>\\n  <button mat-button translate (click)=\\\"saveCondition()\\\">Save</button>\\n  <button mat-button translate matDialogClose>Close</button>\\n</mat-dialog-actions>\\n\",\n                    encapsulation: core.ViewEncapsulation.None,\n                    changeDetection: core.ChangeDetectionStrategy.OnPush,\n                    styles: [\"ajf-fb-warning-condition-editor-dialog mat-dialog-content{overflow:visible}\\n\"]\n                },] }\n    ];\n    AjfFbWarningConditionEditorDialog.ctorParameters = function () { return [\n        { type: AjfFormBuilderService },\n        { type: dialog.MatDialogRef }\n    ]; };\n    AjfFbWarningConditionEditorDialog.propDecorators = {\n        editor: [{ type: core.ViewChild, args: [AjfFbConditionEditor, { static: false },] }]\n    };\n\n    function checkRepsValidity(c) {\n        var minReps = c.value.minReps;\n        var maxReps = c.value.maxReps;\n        if (minReps != null && maxReps != null && minReps > maxReps) {\n            return { reps: 'Min repetions cannot be greater than max repetitions' };\n        }\n        return null;\n    }\n    function checkValueLimitsValidity(c) {\n        var minValue = c.value.minValue;\n        var maxValue = c.value.maxValue;\n        if (minValue != null && maxValue != null && minValue > maxValue) {\n            return { valueLimit: 'Min value cannot be greater than max value' };\n        }\n        return null;\n    }\n    function checkDigitsValidity(c) {\n        var minDigits = c.value.minDigits;\n        var maxDigits = c.value.maxDigits;\n        if (minDigits != null && maxDigits != null && minDigits > maxDigits) {\n            return { digits: 'Min digits cannot be greater than max digits' };\n        }\n        return null;\n    }\n    var AjfFbNodeProperties = /** @class */ (function () {\n        function AjfFbNodeProperties(_cdr, _service, _dialog, _fb) {\n            var _this = this;\n            this._cdr = _cdr;\n            this._service = _service;\n            this._dialog = _dialog;\n            this._fb = _fb;\n            this._fieldSizes = [\n                { label: 'Normal', value: 'normal' }, { label: 'Small', value: 'small' },\n                { label: 'Smaller', value: 'smaller' }, { label: 'Tiny', value: 'tiny' },\n                { label: 'Mini', value: 'mini' }\n            ];\n            this._choicesOrigins = [];\n            this._conditionalBranches = [];\n            this._validationConditions = [];\n            this._warningConditions = [];\n            this.isRepeatingContainerNode = function (nodeEntry) {\n                return nodeEntry != null && forms$1.isRepeatingContainerNode(nodeEntry.node);\n            };\n            this._visibilityOptSub = rxjs.Subscription.EMPTY;\n            this._visibilitySub = rxjs.Subscription.EMPTY;\n            this._conditionalBranchesSub = rxjs.Subscription.EMPTY;\n            this._formulaRepsSub = rxjs.Subscription.EMPTY;\n            this._choicesFilterSub = rxjs.Subscription.EMPTY;\n            this._formulaSub = rxjs.Subscription.EMPTY;\n            this._forceValueSub = rxjs.Subscription.EMPTY;\n            this._validationConditionsSub = rxjs.Subscription.EMPTY;\n            this._warningConditionsSub = rxjs.Subscription.EMPTY;\n            this._nextSlideConditionSub = rxjs.Subscription.EMPTY;\n            this._choicesOriginsSub = rxjs.Subscription.EMPTY;\n            this._triggerConditionsSub = rxjs.Subscription.EMPTY;\n            this._editConditionDialogSub = rxjs.Subscription.EMPTY;\n            this._editValidationConditionDialogSub = rxjs.Subscription.EMPTY;\n            this._editWarningConditionDialogSub = rxjs.Subscription.EMPTY;\n            this._editVisibilityEvt = new core.EventEmitter();\n            this._editVisibilitySub = rxjs.Subscription.EMPTY;\n            this._editConditionalBranchEvt = new core.EventEmitter();\n            this._editConditionalBranchSub = rxjs.Subscription.EMPTY;\n            this._editFormulaRepsEvt = new core.EventEmitter();\n            this._editFormulaRepsSub = rxjs.Subscription.EMPTY;\n            this._editChoicesFilterEvt = new core.EventEmitter();\n            this._editChoicesFilterSub = rxjs.Subscription.EMPTY;\n            this._editFormulaEvt = new core.EventEmitter();\n            this._editFormulaSub = rxjs.Subscription.EMPTY;\n            this._editForceValueEvt = new core.EventEmitter();\n            this._editForceValueSub = rxjs.Subscription.EMPTY;\n            this._editValidationConditionEvt = new core.EventEmitter();\n            this._editValidationConditionSub = rxjs.Subscription.EMPTY;\n            this._addValidationConditionEvt = new core.EventEmitter();\n            this._addValidationConditionSub = rxjs.Subscription.EMPTY;\n            this._removeValidationConditionEvt = new core.EventEmitter();\n            this._removeValidationConditionSub = rxjs.Subscription.EMPTY;\n            this._editWarningConditionEvt = new core.EventEmitter();\n            this._editWarningConditionSub = rxjs.Subscription.EMPTY;\n            this._addWarningConditionEvt = new core.EventEmitter();\n            this._addWarningConditionSub = rxjs.Subscription.EMPTY;\n            this._removeWarningConditionEvt = new core.EventEmitter();\n            this._removeWarningConditionSub = rxjs.Subscription.EMPTY;\n            this._editNextSlideConditionEvt = new core.EventEmitter();\n            this._editNextSlideConditionSub = rxjs.Subscription.EMPTY;\n            this._editTriggerConditionEvt = new core.EventEmitter();\n            this._editTriggerConditionSub = rxjs.Subscription.EMPTY;\n            this._addTriggerConditionEvt = new core.EventEmitter();\n            this._addTriggerConditionSub = rxjs.Subscription.EMPTY;\n            this._removeTriggerConditionEvt = new core.EventEmitter();\n            this._removeTriggerConditionSub = rxjs.Subscription.EMPTY;\n            this._saveEvt = new core.EventEmitter();\n            this._saveSub = rxjs.Subscription.EMPTY;\n            this._nodeEntry = _service.editedNodeEntry;\n            this._choicesOriginsSub =\n                _service.choicesOrigins.subscribe(function (c) { return _this._choicesOrigins = c || []; });\n            this._enabled = this._nodeEntry.pipe(operators.map(function (n) { return n != null; }));\n            this._initForm();\n            this._initVisibilityEdit();\n            this._initConditionalBranchEdit();\n            this._initFormulaRepsEdit();\n            this._initChoicesFilterEdit();\n            this._initFormulaEdit();\n            this._initForceValueEdit();\n            this._initValidationConditionEdit();\n            this._initAddValidationCondition();\n            this._initRemoveValidationCondition();\n            this._initWarningConditionEdit();\n            this._initAddWarningCondition();\n            this._initRemoveWarningCondition();\n            this._initNextSlideConditionEdit();\n            this._initTriggerConditionEdit();\n            this._initAddTriggerCondition();\n            this._initRemoveTriggerCondition();\n            this._initSave();\n        }\n        Object.defineProperty(AjfFbNodeProperties.prototype, \"fieldSizes\", {\n            get: function () {\n                return this._fieldSizes;\n            },\n            enumerable: false,\n            configurable: true\n        });\n        Object.defineProperty(AjfFbNodeProperties.prototype, \"nodeEntry\", {\n            get: function () {\n                return this._nodeEntry;\n            },\n            enumerable: false,\n            configurable: true\n        });\n        Object.defineProperty(AjfFbNodeProperties.prototype, \"choicesOrigins\", {\n            get: function () {\n                return this._choicesOrigins;\n            },\n            enumerable: false,\n            configurable: true\n        });\n        Object.defineProperty(AjfFbNodeProperties.prototype, \"enabled\", {\n            get: function () {\n                return this._enabled;\n            },\n            enumerable: false,\n            configurable: true\n        });\n        Object.defineProperty(AjfFbNodeProperties.prototype, \"propertiesForm\", {\n            get: function () {\n                return this._propertiesForm;\n            },\n            enumerable: false,\n            configurable: true\n        });\n        Object.defineProperty(AjfFbNodeProperties.prototype, \"hasChoices\", {\n            get: function () {\n                return this._hasChoices;\n            },\n            enumerable: false,\n            configurable: true\n        });\n        Object.defineProperty(AjfFbNodeProperties.prototype, \"curVisibility\", {\n            get: function () {\n                return this._curVisibility;\n            },\n            enumerable: false,\n            configurable: true\n        });\n        Object.defineProperty(AjfFbNodeProperties.prototype, \"curFormulaReps\", {\n            get: function () {\n                return this._curFormulaReps;\n            },\n            enumerable: false,\n            configurable: true\n        });\n        Object.defineProperty(AjfFbNodeProperties.prototype, \"curChoicesFilter\", {\n            get: function () {\n                return this._curChoicesFilter;\n            },\n            enumerable: false,\n            configurable: true\n        });\n        Object.defineProperty(AjfFbNodeProperties.prototype, \"curForceValue\", {\n            get: function () {\n                return this._curForceValue;\n            },\n            enumerable: false,\n            configurable: true\n        });\n        Object.defineProperty(AjfFbNodeProperties.prototype, \"curFormula\", {\n            get: function () {\n                return this._curFormula;\n            },\n            enumerable: false,\n            configurable: true\n        });\n        Object.defineProperty(AjfFbNodeProperties.prototype, \"conditionalBranches\", {\n            get: function () {\n                return this._conditionalBranches;\n            },\n            enumerable: false,\n            configurable: true\n        });\n        Object.defineProperty(AjfFbNodeProperties.prototype, \"validationConditions\", {\n            get: function () {\n                return this._validationConditions;\n            },\n            enumerable: false,\n            configurable: true\n        });\n        Object.defineProperty(AjfFbNodeProperties.prototype, \"warningConditions\", {\n            get: function () {\n                return this._warningConditions;\n            },\n            enumerable: false,\n            configurable: true\n        });\n        Object.defineProperty(AjfFbNodeProperties.prototype, \"nextSlideCondition\", {\n            get: function () {\n                return this._nextSlideCondition;\n            },\n            enumerable: false,\n            configurable: true\n        });\n        Object.defineProperty(AjfFbNodeProperties.prototype, \"triggerConditions\", {\n            get: function () {\n                return this._triggerConditions;\n            },\n            enumerable: false,\n            configurable: true\n        });\n        AjfFbNodeProperties.prototype.editVisibility = function () {\n            this._editVisibilityEvt.emit();\n        };\n        AjfFbNodeProperties.prototype.editConditionalBranch = function (idx) {\n            if (idx < 0 || idx >= this._conditionalBranches.length) {\n                return;\n            }\n            this._editConditionalBranchEvt.emit(idx);\n        };\n        AjfFbNodeProperties.prototype.editFormulaReps = function () {\n            this._editFormulaRepsEvt.emit();\n        };\n        AjfFbNodeProperties.prototype.editChoicesFilter = function () {\n            this._editChoicesFilterEvt.emit();\n        };\n        AjfFbNodeProperties.prototype.editFormula = function () {\n            this._editFormulaEvt.emit();\n        };\n        AjfFbNodeProperties.prototype.editForceValue = function () {\n            this._editForceValueEvt.emit();\n        };\n        AjfFbNodeProperties.prototype.editValidationCondition = function (idx) {\n            if (idx < 0 || idx >= this._validationConditions.length) {\n                return;\n            }\n            this._editValidationConditionEvt.emit(idx);\n        };\n        AjfFbNodeProperties.prototype.addValidationCondition = function () {\n            this._addValidationConditionEvt.emit();\n        };\n        AjfFbNodeProperties.prototype.removeValidationCondition = function (idx) {\n            if (idx < 0 || idx >= this._validationConditions.length) {\n                return;\n            }\n            this._removeValidationConditionEvt.emit(idx);\n        };\n        AjfFbNodeProperties.prototype.editWarningCondition = function (idx) {\n            if (idx < 0 || idx >= this._warningConditions.length) {\n                return;\n            }\n            this._editWarningConditionEvt.emit(idx);\n        };\n        AjfFbNodeProperties.prototype.addWarningCondition = function () {\n            this._addWarningConditionEvt.emit();\n        };\n        AjfFbNodeProperties.prototype.removeWarningCondition = function (idx) {\n            if (idx < 0 || idx >= this._warningConditions.length) {\n                return;\n            }\n            this._removeWarningConditionEvt.emit(idx);\n        };\n        AjfFbNodeProperties.prototype.editNextSlideCondition = function () {\n            this._editNextSlideConditionEvt.emit();\n        };\n        AjfFbNodeProperties.prototype.editTriggerCondition = function (idx) {\n            if (idx < 0 || idx >= this._triggerConditions.length) {\n                return;\n            }\n            this._editTriggerConditionEvt.emit(idx);\n        };\n        AjfFbNodeProperties.prototype.addTriggerCondition = function () {\n            this._addTriggerConditionEvt.emit();\n        };\n        AjfFbNodeProperties.prototype.removeTriggerCondition = function (idx) {\n            if (idx < 0 || idx >= this._triggerConditions.length) {\n                return;\n            }\n            this._removeTriggerConditionEvt.emit(idx);\n        };\n        AjfFbNodeProperties.prototype.isField = function (nodeEntry) {\n            return nodeEntry != null && forms$1.isField(nodeEntry.node);\n        };\n        AjfFbNodeProperties.prototype.isNumericField = function (node) {\n            return forms$1.isField(node) && forms$1.isNumberField(node);\n        };\n        AjfFbNodeProperties.prototype.isFieldWithChoices = function (node) {\n            return forms$1.isField(node) && forms$1.isFieldWithChoices(node);\n        };\n        AjfFbNodeProperties.prototype.save = function () {\n            this._saveEvt.emit();\n        };\n        AjfFbNodeProperties.prototype.cancel = function () {\n            this._service.cancelNodeEntryEdit();\n        };\n        AjfFbNodeProperties.prototype.ngOnDestroy = function () {\n            this._choicesOriginsSub.unsubscribe();\n            this._visibilityOptSub.unsubscribe();\n            this._visibilitySub.unsubscribe();\n            this._formulaRepsSub.unsubscribe();\n            this._choicesFilterSub.unsubscribe();\n            this._formulaSub.unsubscribe();\n            this._forceValueSub.unsubscribe();\n            this._validationConditionsSub.unsubscribe();\n            this._warningConditionsSub.unsubscribe();\n            this._triggerConditionsSub.unsubscribe();\n            this._editConditionDialogSub.unsubscribe();\n            this._editValidationConditionDialogSub.unsubscribe();\n            this._editWarningConditionDialogSub.unsubscribe();\n            this._editChoicesFilterSub.unsubscribe();\n            this._editConditionalBranchSub.unsubscribe();\n            this._editVisibilitySub.unsubscribe();\n            this._editFormulaRepsSub.unsubscribe();\n            this._editFormulaSub.unsubscribe();\n            this._editForceValueSub.unsubscribe();\n            this._editValidationConditionSub.unsubscribe();\n            this._editWarningConditionSub.unsubscribe();\n            this._nextSlideConditionSub.unsubscribe();\n            this._addTriggerConditionSub.unsubscribe();\n            this._addValidationConditionSub.unsubscribe();\n            this._addWarningConditionSub.unsubscribe();\n            this._editNextSlideConditionSub.unsubscribe();\n            this._editTriggerConditionSub.unsubscribe();\n            this._removeTriggerConditionSub.unsubscribe();\n            this._removeValidationConditionSub.unsubscribe();\n            this._removeWarningConditionSub.unsubscribe();\n            this._saveSub.unsubscribe();\n        };\n        AjfFbNodeProperties.prototype._initSave = function () {\n            var _this = this;\n            this._saveSub = this._saveEvt\n                .pipe(operators.withLatestFrom(this.propertiesForm))\n                .subscribe(function (_a) {\n                var _b = __read(_a, 2), _ = _b[0], formGroup = _b[1];\n                var fg = formGroup;\n                var val = Object.assign(Object.assign({}, fg.value), { conditionalBranches: _this._conditionalBranches });\n                _this._service.saveNodeEntry(val);\n            });\n        };\n        AjfFbNodeProperties.prototype._initForm = function () {\n            var _this = this;\n            this._propertiesForm = this._nodeEntry.pipe(operators.filter(function (n) { return n != null; }), operators.map(function (n) {\n                if (_this._visibilityOptSub != null) {\n                    _this._visibilityOptSub.unsubscribe();\n                }\n                if (_this._visibilitySub != null) {\n                    _this._visibilitySub.unsubscribe();\n                }\n                if (_this._conditionalBranchesSub != null) {\n                    _this._conditionalBranchesSub.unsubscribe();\n                }\n                n = n;\n                var visibility = n.node.visibility != null ? n.node.visibility.condition : null;\n                var visibilityOpt = n.node.visibility != null ? _this._guessVisibilityOpt(n.node.visibility) : null;\n                var controls = {\n                    name: [n.node.name, forms.Validators.required],\n                    label: n.node.label,\n                    visibilityOpt: [visibilityOpt, forms.Validators.required],\n                    visibility: [visibility, forms.Validators.required],\n                    conditionalBranchesNum: n.node.conditionalBranches.length\n                };\n                var validators = [];\n                if (forms$1.isRepeatingContainerNode(n.node)) {\n                    var rn = n.node;\n                    var formulaReps = rn.formulaReps != null ? rn.formulaReps.formula : null;\n                    controls.formulaReps = [formulaReps, forms.Validators.required];\n                    controls.minReps = rn.minReps;\n                    controls.maxReps = rn.maxReps;\n                    _this._curFormulaReps = formulaReps;\n                    validators.push(checkRepsValidity);\n                }\n                if (_this.isField(n)) {\n                    var field = n.node;\n                    var forceValue = null;\n                    var notEmpty = false;\n                    var validationConditions = [];\n                    if (field.validation != null) {\n                        if (field.validation.forceValue != null) {\n                            forceValue = field.validation.forceValue.condition;\n                        }\n                        notEmpty = field.validation.notEmpty != null;\n                        validationConditions = (field.validation.conditions || []).map(function (c) {\n                            return { condition: c.condition, errorMessage: c.errorMessage };\n                        });\n                    }\n                    var notEmptyW = false;\n                    var warningConditions = [];\n                    if (field.warning != null) {\n                        notEmptyW = field.warning.notEmpty != null;\n                        warningConditions = (field.warning.conditions || []).map(function (w) {\n                            return { condition: w.condition, warningMessage: w.warningMessage };\n                        });\n                    }\n                    var formula = field.formula != null ? field.formula.formula : null;\n                    controls.description = field.description;\n                    controls.defaultValue = field.defaultValue;\n                    controls.hint = field.hint;\n                    controls.size = field.size;\n                    controls.formula = formula;\n                    controls.forceValue = forceValue;\n                    controls.notEmpty = notEmpty;\n                    controls.validationConditions = [validationConditions, []];\n                    controls.notEmptyWarning = notEmptyW;\n                    controls.warningConditions = [warningConditions, []];\n                    controls.nextSlideCondition = [field.nextSlideCondition];\n                    _this._curForceValue = forceValue;\n                    _this._curFormula = formula;\n                    _this._validationConditions = validationConditions;\n                    _this._warningConditions = warningConditions;\n                }\n                if (_this.isNumericField(n.node)) {\n                    var numField = n.node;\n                    var minValue = void 0;\n                    var maxValue = void 0;\n                    var minDigits = void 0;\n                    var maxDigits = void 0;\n                    if (numField.validation != null) {\n                        if (numField.validation.minValue != null) {\n                            minValue = (numField.validation.minValue.condition || '').replace('$value >= ', '');\n                        }\n                        if (numField.validation.maxValue != null) {\n                            maxValue = (numField.validation.maxValue.condition || '').replace('$value <= ', '');\n                        }\n                        if (numField.validation.minDigits != null) {\n                            minDigits = (numField.validation.minDigits.condition ||\n                                '').replace('$value.toString().length >= ', '');\n                        }\n                        if (numField.validation.maxDigits != null) {\n                            maxDigits = (numField.validation.maxDigits.condition ||\n                                '').replace('$value.toString().length <= ', '');\n                        }\n                    }\n                    controls.minValue = minValue;\n                    controls.maxValue = maxValue;\n                    controls.minDigits = minDigits;\n                    controls.maxDigits = maxDigits;\n                    validators.push(checkValueLimitsValidity);\n                    validators.push(checkDigitsValidity);\n                }\n                if (_this.isFieldWithChoices(n.node)) {\n                    var fieldWithChoices = n.node;\n                    var triggerConditions = (fieldWithChoices.triggerConditions || []).map(function (c) { return c.condition; });\n                    controls.choicesOriginRef = fieldWithChoices.choicesOriginRef;\n                    controls.choicesFilter = fieldWithChoices.choicesFilter != null ?\n                        fieldWithChoices.choicesFilter.formula :\n                        null;\n                    controls.forceExpanded = fieldWithChoices.forceExpanded;\n                    controls.forceNarrow = fieldWithChoices.forceNarrow;\n                    controls.triggerConditions = triggerConditions;\n                    _this._triggerConditions = triggerConditions;\n                }\n                var fg = _this._fb.group(controls);\n                fg.setValidators(validators);\n                _this._conditionalBranches = n.node.conditionalBranches.map(function (c) { return c.condition; });\n                _this._curVisibility = n.node.visibility != null ? n.node.visibility.condition : null;\n                _this._handleConditionalBranchesChange(fg);\n                _this._handleVisibilityChange(fg);\n                _this._handleFormulaRepsChange(fg);\n                _this._handleChoicesFilterChange(fg);\n                _this._handleFormulaChange(fg);\n                _this._handleForceValueChange(fg);\n                _this._handleValidationCondtionsChange(fg);\n                _this._handleWarningCondtionsChange(fg);\n                _this._handleNextSlideConditionChange(fg);\n                _this._handleTriggerCondtionsChange(fg);\n                return fg;\n            }), operators.publishReplay(1), operators.refCount());\n        };\n        AjfFbNodeProperties.prototype._destroyConditionDialog = function () {\n            if (this._editConditionDialogSub != null) {\n                this._editConditionDialogSub.unsubscribe();\n                this._editConditionDialogSub = rxjs.Subscription.EMPTY;\n            }\n            if (this._editConditionDialog != null) {\n                this._editConditionDialog.close();\n                this._editConditionDialog = null;\n            }\n        };\n        AjfFbNodeProperties.prototype._destroyValidationConditionDialog = function () {\n            if (this._editValidationConditionDialogSub != null) {\n                this._editValidationConditionDialogSub.unsubscribe();\n                this._editValidationConditionDialogSub = rxjs.Subscription.EMPTY;\n            }\n            if (this._editValidationConditionDialog != null) {\n                this._editValidationConditionDialog.close();\n                this._editValidationConditionDialog = null;\n            }\n        };\n        AjfFbNodeProperties.prototype._destroyWarningConditionDialog = function () {\n            if (this._editWarningConditionDialogSub != null) {\n                this._editWarningConditionDialogSub.unsubscribe();\n                this._editWarningConditionDialogSub = rxjs.Subscription.EMPTY;\n            }\n            if (this._editWarningConditionDialog != null) {\n                this._editWarningConditionDialog.close();\n                this._editWarningConditionDialog = null;\n            }\n        };\n        AjfFbNodeProperties.prototype._initRemoveTriggerCondition = function () {\n            this._removeTriggerConditionSub = this._removeTriggerConditionEvt\n                .pipe(operators.withLatestFrom(this._propertiesForm))\n                .subscribe(function (_a) {\n                var _b = __read(_a, 2), vcIdx = _b[0], formGroup = _b[1];\n                if (formGroup == null) {\n                    return;\n                }\n                var fg = formGroup;\n                var ctrl = fg.controls['triggerConditions'];\n                var vcs = (ctrl.value || []).slice(0);\n                if (vcIdx < 0 || vcIdx >= vcs.length) {\n                    return;\n                }\n                vcs.splice(vcIdx, 1);\n                ctrl.setValue(vcs);\n            });\n        };\n        AjfFbNodeProperties.prototype._initAddTriggerCondition = function () {\n            this._addTriggerConditionSub = this._addTriggerConditionEvt\n                .pipe(operators.withLatestFrom(this._propertiesForm))\n                .subscribe(function (_a) {\n                var _b = __read(_a, 2), _ = _b[0], formGroup = _b[1];\n                if (formGroup == null) {\n                    return;\n                }\n                var fg = formGroup;\n                var ctrl = fg.controls['triggerConditions'];\n                var vcs = (ctrl.value || []).slice(0);\n                vcs.push('');\n                ctrl.setValue(vcs);\n            });\n        };\n        AjfFbNodeProperties.prototype._initTriggerConditionEdit = function () {\n            var _this = this;\n            this._editConditionDialogSub = rxjs.Subscription.EMPTY;\n            this._cdr.markForCheck();\n            this._editTriggerConditionSub =\n                this._editTriggerConditionEvt\n                    .pipe(operators.withLatestFrom(this._propertiesForm))\n                    .subscribe(function (_a) {\n                    var _b = __read(_a, 2), vcIdx = _b[0], fg = _b[1];\n                    _this._destroyConditionDialog();\n                    if (vcIdx < 0 || vcIdx >= _this._triggerConditions.length || fg == null) {\n                        return;\n                    }\n                    _this._editConditionDialog = _this._dialog.open(AjfFbConditionEditorDialog);\n                    var cmp = _this._editConditionDialog.componentInstance;\n                    cmp.condition = _this._triggerConditions[vcIdx];\n                    _this._editConditionDialogSub =\n                        _this._editConditionDialog.afterClosed().subscribe(function (cond) {\n                            if (cond !== void 0) {\n                                _this._triggerConditions[vcIdx] = cond;\n                            }\n                            _this._editConditionDialogSub.unsubscribe();\n                            _this._editConditionDialogSub = rxjs.Subscription.EMPTY;\n                            _this._cdr.markForCheck();\n                        });\n                });\n        };\n        AjfFbNodeProperties.prototype._initRemoveWarningCondition = function () {\n            this._removeWarningConditionSub = this._removeWarningConditionEvt\n                .pipe(operators.withLatestFrom(this._propertiesForm))\n                .subscribe(function (_a) {\n                var _b = __read(_a, 2), vcIdx = _b[0], formGroup = _b[1];\n                if (formGroup == null) {\n                    return;\n                }\n                var fg = formGroup;\n                var ctrl = fg.controls['warningConditions'];\n                var vcs = (ctrl.value || []).slice(0);\n                if (vcIdx < 0 || vcIdx >= vcs.length) {\n                    return;\n                }\n                vcs.splice(vcIdx, 1);\n                ctrl.setValue(vcs);\n            });\n        };\n        AjfFbNodeProperties.prototype._initAddWarningCondition = function () {\n            this._addWarningConditionSub = this._addWarningConditionEvt\n                .pipe(operators.withLatestFrom(this._propertiesForm))\n                .subscribe(function (_a) {\n                var _b = __read(_a, 2), _ = _b[0], formGroup = _b[1];\n                if (formGroup == null) {\n                    return;\n                }\n                var fg = formGroup;\n                var ctrl = fg.controls['warningConditions'];\n                var vcs = (ctrl.value || []).slice(0);\n                vcs.push({ condition: '', errorMessage: '' });\n                ctrl.setValue(vcs);\n            });\n        };\n        AjfFbNodeProperties.prototype._initWarningConditionEdit = function () {\n            var _this = this;\n            this._editWarningConditionSub =\n                this._editWarningConditionEvt\n                    .pipe(operators.withLatestFrom(this._propertiesForm))\n                    .subscribe(function (_a) {\n                    var _b = __read(_a, 2), vcIdx = _b[0], fg = _b[1];\n                    _this._destroyWarningConditionDialog();\n                    if (vcIdx < 0 || vcIdx >= _this._warningConditions.length || fg == null) {\n                        return;\n                    }\n                    _this._editWarningConditionDialog =\n                        _this._dialog.open(AjfFbWarningConditionEditorDialog);\n                    var cmp = _this._editWarningConditionDialog.componentInstance;\n                    var w = _this._warningConditions[vcIdx];\n                    cmp.condition = w.condition;\n                    cmp.warningMessage = w.warningMessage;\n                    _this._editWarningConditionDialogSub =\n                        _this._editWarningConditionDialog.afterClosed().subscribe(function (cond) {\n                            if (cond !== void 0) {\n                                _this._warningConditions[vcIdx] = cond;\n                            }\n                            _this._editWarningConditionDialogSub.unsubscribe();\n                            _this._editWarningConditionDialogSub = rxjs.Subscription.EMPTY;\n                            _this._cdr.markForCheck();\n                        });\n                });\n        };\n        AjfFbNodeProperties.prototype._initRemoveValidationCondition = function () {\n            this._removeValidationConditionSub = this._removeValidationConditionEvt\n                .pipe(operators.withLatestFrom(this._propertiesForm))\n                .subscribe(function (_a) {\n                var _b = __read(_a, 2), vcIdx = _b[0], formGroup = _b[1];\n                if (formGroup == null) {\n                    return;\n                }\n                var fg = formGroup;\n                var ctrl = fg.controls['validationConditions'];\n                var vcs = (ctrl.value || []).slice(0);\n                if (vcIdx < 0 || vcIdx >= vcs.length) {\n                    return;\n                }\n                vcs.splice(vcIdx, 1);\n                ctrl.setValue(vcs);\n            });\n        };\n        AjfFbNodeProperties.prototype._initAddValidationCondition = function () {\n            this._addValidationConditionSub = this._addValidationConditionEvt\n                .pipe(operators.withLatestFrom(this._propertiesForm))\n                .subscribe(function (_a) {\n                var _b = __read(_a, 2), _ = _b[0], formGroup = _b[1];\n                if (formGroup == null) {\n                    return;\n                }\n                var fg = formGroup;\n                var ctrl = fg.controls['validationConditions'];\n                var vcs = (ctrl.value || []).slice(0);\n                vcs.push({ condition: '', errorMessage: '' });\n                ctrl.setValue(vcs);\n            });\n        };\n        AjfFbNodeProperties.prototype._initValidationConditionEdit = function () {\n            var _this = this;\n            this._editValidationConditionSub =\n                this._editValidationConditionEvt\n                    .pipe(operators.withLatestFrom(this._propertiesForm))\n                    .subscribe(function (_a) {\n                    var _b = __read(_a, 2), vcIdx = _b[0], fg = _b[1];\n                    _this._destroyValidationConditionDialog();\n                    if (vcIdx < 0 || vcIdx >= _this._validationConditions.length || fg == null) {\n                        return;\n                    }\n                    _this._editValidationConditionDialog =\n                        _this._dialog.open(AjfFbValidationConditionEditorDialog);\n                    var cmp = _this._editValidationConditionDialog.componentInstance;\n                    var v = _this._validationConditions[vcIdx];\n                    cmp.condition = v.condition;\n                    cmp.errorMessage = v.errorMessage;\n                    _this._editValidationConditionDialogSub =\n                        _this._editValidationConditionDialog.afterClosed().subscribe(function (cond) {\n                            if (cond !== void 0) {\n                                _this._validationConditions[vcIdx] = cond;\n                            }\n                            _this._editValidationConditionDialogSub.unsubscribe();\n                            _this._editValidationConditionDialogSub = rxjs.Subscription.EMPTY;\n                            _this._cdr.markForCheck();\n                        });\n                });\n        };\n        AjfFbNodeProperties.prototype._initForceValueEdit = function () {\n            var _this = this;\n            this._editForceValueSub =\n                this._editForceValueEvt\n                    .pipe(operators.withLatestFrom(this._propertiesForm))\n                    .subscribe(function (_a) {\n                    var _b = __read(_a, 2), _ = _b[0], formGroup = _b[1];\n                    _this._destroyConditionDialog();\n                    if (formGroup == null) {\n                        return;\n                    }\n                    var fg = formGroup;\n                    var ctrl = fg.controls['forceValue'];\n                    _this._editConditionDialog = _this._dialog.open(AjfFbConditionEditorDialog);\n                    _this._editConditionDialog.componentInstance.condition = ctrl.value;\n                    _this._editConditionDialogSub =\n                        _this._editConditionDialog.afterClosed().subscribe(function (cond) {\n                            if (cond !== void 0) {\n                                ctrl.setValue(cond);\n                            }\n                            _this._editConditionDialogSub.unsubscribe();\n                            _this._editConditionDialogSub = rxjs.Subscription.EMPTY;\n                            _this._cdr.markForCheck();\n                        });\n                });\n        };\n        AjfFbNodeProperties.prototype._initNextSlideConditionEdit = function () {\n            var _this = this;\n            this._editNextSlideConditionSub =\n                this._editNextSlideConditionEvt\n                    .pipe(operators.withLatestFrom(this._propertiesForm))\n                    .subscribe(function (_a) {\n                    var _b = __read(_a, 2), _ = _b[0], formGroup = _b[1];\n                    _this._destroyConditionDialog();\n                    if (formGroup == null) {\n                        return;\n                    }\n                    var fg = formGroup;\n                    var ctrl = fg.controls['nextSlideCondition'];\n                    _this._editConditionDialog = _this._dialog.open(AjfFbConditionEditorDialog);\n                    _this._editConditionDialog.componentInstance.condition = ctrl.value;\n                    _this._editConditionDialogSub =\n                        _this._editConditionDialog.afterClosed().subscribe(function (cond) {\n                            if (cond !== void 0) {\n                                ctrl.setValue(cond);\n                            }\n                            _this._editConditionDialogSub.unsubscribe();\n                            _this._editConditionDialogSub = rxjs.Subscription.EMPTY;\n                            _this._cdr.markForCheck();\n                        });\n                });\n        };\n        AjfFbNodeProperties.prototype._initFormulaEdit = function () {\n            var _this = this;\n            this._editConditionDialogSub = rxjs.Subscription.EMPTY;\n            this._cdr.markForCheck();\n            this._editFormulaSub =\n                this._editFormulaEvt\n                    .pipe(operators.withLatestFrom(this._propertiesForm))\n                    .subscribe(function (_a) {\n                    var _b = __read(_a, 2), _ = _b[0], formGroup = _b[1];\n                    _this._destroyConditionDialog();\n                    if (formGroup == null) {\n                        return;\n                    }\n                    var fg = formGroup;\n                    var ctrl = fg.controls['formula'];\n                    _this._editConditionDialog = _this._dialog.open(AjfFbConditionEditorDialog);\n                    _this._editConditionDialog.componentInstance.condition = ctrl.value;\n                    _this._editConditionDialogSub =\n                        _this._editConditionDialog.afterClosed().subscribe(function (cond) {\n                            if (cond !== void 0) {\n                                ctrl.setValue(cond);\n                            }\n                            _this._editConditionDialogSub.unsubscribe();\n                            _this._editConditionDialogSub = rxjs.Subscription.EMPTY;\n                            _this._cdr.markForCheck();\n                        });\n                });\n        };\n        AjfFbNodeProperties.prototype._initFormulaRepsEdit = function () {\n            var _this = this;\n            this._editFormulaRepsSub =\n                this._editFormulaRepsEvt\n                    .pipe(operators.withLatestFrom(this._propertiesForm))\n                    .subscribe(function (_a) {\n                    var _b = __read(_a, 2), _ = _b[0], formGroup = _b[1];\n                    _this._destroyConditionDialog();\n                    if (formGroup == null) {\n                        return;\n                    }\n                    var fg = formGroup;\n                    var ctrl = fg.controls['formulaReps'];\n                    _this._editConditionDialog = _this._dialog.open(AjfFbConditionEditorDialog);\n                    _this._editConditionDialog.componentInstance.condition = ctrl.value;\n                    _this._editConditionDialogSub =\n                        _this._editConditionDialog.afterClosed().subscribe(function (cond) {\n                            if (cond !== void 0) {\n                                ctrl.setValue(cond);\n                            }\n                            _this._editConditionDialogSub.unsubscribe();\n                            _this._editConditionDialogSub = rxjs.Subscription.EMPTY;\n                            _this._cdr.markForCheck();\n                        });\n                });\n        };\n        AjfFbNodeProperties.prototype._initChoicesFilterEdit = function () {\n            var _this = this;\n            this._editChoicesFilterSub =\n                this._editChoicesFilterEvt\n                    .pipe(operators.withLatestFrom(this._propertiesForm))\n                    .subscribe(function (_a) {\n                    var _b = __read(_a, 2), _ = _b[0], formGroup = _b[1];\n                    _this._destroyConditionDialog();\n                    if (formGroup == null) {\n                        return;\n                    }\n                    var fg = formGroup;\n                    var ctrl = fg.controls['choicesFilter'];\n                    _this._editConditionDialog = _this._dialog.open(AjfFbConditionEditorDialog);\n                    _this._editConditionDialog.componentInstance.condition = ctrl.value;\n                    _this._editConditionDialogSub =\n                        _this._editConditionDialog.afterClosed().subscribe(function (cond) {\n                            if (cond !== void 0) {\n                                ctrl.setValue(cond);\n                            }\n                            _this._editConditionDialogSub.unsubscribe();\n                            _this._editConditionDialogSub = rxjs.Subscription.EMPTY;\n                            _this._cdr.markForCheck();\n                        });\n                });\n        };\n        AjfFbNodeProperties.prototype._initConditionalBranchEdit = function () {\n            var _this = this;\n            this._editConditionalBranchSub =\n                this._editConditionalBranchEvt\n                    .pipe(operators.withLatestFrom(this._propertiesForm))\n                    .subscribe(function (_a) {\n                    var _b = __read(_a, 2), cbIdx = _b[0], fg = _b[1];\n                    _this._destroyConditionDialog();\n                    if (cbIdx < 0 || cbIdx >= _this._conditionalBranches.length || fg == null) {\n                        return;\n                    }\n                    _this._editConditionDialog = _this._dialog.open(AjfFbConditionEditorDialog);\n                    _this._editConditionDialog.componentInstance.condition =\n                        _this._conditionalBranches[cbIdx];\n                    _this._editConditionDialogSub =\n                        _this._editConditionDialog.afterClosed().subscribe(function (cond) {\n                            if (cond !== void 0) {\n                                _this._conditionalBranches[cbIdx] = cond;\n                            }\n                            _this._editConditionDialogSub.unsubscribe();\n                            _this._editConditionDialogSub = rxjs.Subscription.EMPTY;\n                            _this._cdr.markForCheck();\n                        });\n                });\n        };\n        AjfFbNodeProperties.prototype._initVisibilityEdit = function () {\n            var _this = this;\n            this._editVisibilitySub =\n                this._editVisibilityEvt\n                    .pipe(operators.withLatestFrom(this._propertiesForm))\n                    .subscribe(function (_a) {\n                    var _b = __read(_a, 2), _ = _b[0], formGroup = _b[1];\n                    _this._destroyConditionDialog();\n                    if (formGroup == null) {\n                        return;\n                    }\n                    var fg = formGroup;\n                    var ctrl = fg.controls['visibility'];\n                    var condition = ctrl.value;\n                    _this._editConditionDialog = _this._dialog.open(AjfFbConditionEditorDialog);\n                    _this._editConditionDialog.componentInstance.condition = condition;\n                    _this._editConditionDialogSub =\n                        _this._editConditionDialog.afterClosed().subscribe(function (cond) {\n                            if (cond !== void 0) {\n                                ctrl.setValue(cond);\n                            }\n                            _this._editConditionDialogSub.unsubscribe();\n                            _this._editConditionDialogSub = rxjs.Subscription.EMPTY;\n                            _this._cdr.markForCheck();\n                        });\n                });\n        };\n        AjfFbNodeProperties.prototype._handleTriggerCondtionsChange = function (fg) {\n            var _this = this;\n            this._triggerConditionsSub = fg.valueChanges\n                .pipe(operators.distinctUntilChanged(function (v1, v2) { return JSON.stringify(v1.triggerConditions) ===\n                JSON.stringify(v2.triggerConditions); }))\n                .subscribe(function (v) {\n                _this._triggerConditions = v.triggerConditions;\n                _this._cdr.markForCheck();\n            });\n        };\n        AjfFbNodeProperties.prototype._handleWarningCondtionsChange = function (fg) {\n            var _this = this;\n            this._warningConditionsSub = fg.valueChanges\n                .pipe(operators.distinctUntilChanged(function (v1, v2) { return JSON.stringify(v1.warningConditions) ===\n                JSON.stringify(v2.warningConditions); }))\n                .subscribe(function (v) {\n                _this._warningConditions = v.warningConditions;\n                _this._cdr.markForCheck();\n            });\n        };\n        AjfFbNodeProperties.prototype._handleValidationCondtionsChange = function (fg) {\n            var _this = this;\n            this._validationConditionsSub =\n                fg.valueChanges\n                    .pipe(operators.distinctUntilChanged(function (v1, v2) { return JSON.stringify(v1.validationConditions) ===\n                    JSON.stringify(v2.validationConditions); }))\n                    .subscribe(function (v) {\n                    _this._validationConditions = v.validationConditions;\n                    _this._cdr.markForCheck();\n                });\n        };\n        AjfFbNodeProperties.prototype._handleForceValueChange = function (fg) {\n            var _this = this;\n            this._forceValueSub =\n                fg.valueChanges.pipe(operators.distinctUntilChanged(function (v1, v2) { return v1.forceValue === v2.forceValue; }))\n                    .subscribe(function (v) {\n                    _this._curForceValue = v.forceValue;\n                    _this._cdr.markForCheck();\n                });\n        };\n        AjfFbNodeProperties.prototype._handleNextSlideConditionChange = function (fg) {\n            var _this = this;\n            this._formulaSub =\n                fg.valueChanges\n                    .pipe(operators.distinctUntilChanged(function (v1, v2) { return v1.nextSlideCondition === v2.nextSlideCondition; }))\n                    .subscribe(function (v) {\n                    _this._nextSlideCondition = v.nextSlideCondition;\n                    _this._cdr.markForCheck();\n                });\n            this._formulaSub =\n                fg.valueChanges\n                    .pipe(operators.distinctUntilChanged(function (v1, v2) { return v1.nextSlideCondition === v2.nextSlideCondition; }))\n                    .subscribe(function (v) {\n                    _this._nextSlideCondition = v.nextSlideCondition;\n                    _this._cdr.markForCheck();\n                });\n        };\n        AjfFbNodeProperties.prototype._handleFormulaChange = function (fg) {\n            var _this = this;\n            this._formulaSub =\n                fg.valueChanges.pipe(operators.distinctUntilChanged(function (v1, v2) { return v1.formula === v2.formula; }))\n                    .subscribe(function (v) {\n                    _this._curFormula = v.formula;\n                    _this._cdr.markForCheck();\n                });\n        };\n        AjfFbNodeProperties.prototype._handleFormulaRepsChange = function (fg) {\n            var _this = this;\n            this._formulaRepsSub =\n                fg.valueChanges.pipe(operators.distinctUntilChanged(function (v1, v2) { return v1.formulaReps === v2.formulaReps; }))\n                    .subscribe(function (v) {\n                    _this._curFormulaReps = v.formulaReps;\n                    _this._cdr.markForCheck();\n                });\n        };\n        AjfFbNodeProperties.prototype._handleChoicesFilterChange = function (fg) {\n            var _this = this;\n            this._choicesFilterSub =\n                fg.valueChanges\n                    .pipe(operators.distinctUntilChanged(function (v1, v2) { return v1.choicesFilter === v2.choicesFilter; }))\n                    .subscribe(function (v) {\n                    _this._curChoicesFilter = v.choicesFilter;\n                    _this._cdr.markForCheck();\n                });\n        };\n        AjfFbNodeProperties.prototype._handleConditionalBranchesChange = function (fg) {\n            var _this = this;\n            this._conditionalBranchesSub =\n                fg.valueChanges\n                    .pipe(operators.distinctUntilChanged(function (v1, v2) { return v1.conditionalBranchesNum === v2.conditionalBranchesNum; }))\n                    .subscribe(function (v) {\n                    var cbNum = v.conditionalBranchesNum;\n                    var curCbNum = _this._conditionalBranches.length;\n                    if (curCbNum < cbNum) {\n                        var newCbs = [];\n                        for (var i = curCbNum; i < cbNum; i++) {\n                            newCbs.push(models.alwaysCondition().condition);\n                        }\n                        _this._conditionalBranches = _this._conditionalBranches.concat(newCbs);\n                    }\n                    else if (curCbNum > cbNum) {\n                        _this._conditionalBranches.splice(0, curCbNum - cbNum);\n                    }\n                    _this._cdr.markForCheck();\n                });\n        };\n        AjfFbNodeProperties.prototype._handleVisibilityChange = function (fg) {\n            var _this = this;\n            this._visibilitySub =\n                fg.valueChanges\n                    .pipe(operators.distinctUntilChanged(function (v1, v2) { return v1.visibilityOpt === v2.visibilityOpt; }))\n                    .subscribe(function (v) {\n                    var visibilityOpt = v.visibilityOpt;\n                    var newCondition;\n                    switch (visibilityOpt) {\n                        case 'always':\n                            newCondition = models.alwaysCondition().condition;\n                            break;\n                        case 'never':\n                            newCondition = models.neverCondition().condition;\n                            break;\n                        default:\n                            newCondition = null;\n                    }\n                    _this._curVisibility = newCondition;\n                    fg.controls['visibility'].setValue(newCondition);\n                });\n            this._visibilitySub = fg.valueChanges\n                .pipe(operators.filter(function (v) { return v.visibilityOpt === 'condition'; }), operators.distinctUntilChanged(function (v1, v2) { return v1.visibility === v2.visibility; }))\n                .subscribe(function (v) {\n                _this._curVisibility = v.visibility;\n                _this._cdr.markForCheck();\n            });\n        };\n        AjfFbNodeProperties.prototype._guessVisibilityOpt = function (condition) {\n            if (condition.condition.localeCompare(models.alwaysCondition().condition) === 0) {\n                return 'always';\n            }\n            if (condition.condition.localeCompare(models.neverCondition().condition) === 0) {\n                return 'never';\n            }\n            return 'condition';\n        };\n        return AjfFbNodeProperties;\n    }());\n    AjfFbNodeProperties.decorators = [\n        { type: core.Component, args: [{\n                    selector: 'ajf-fb-node-properties',\n                    template: \"<div [style.display]=\\\"(enabled|async) ? 'none' : 'block'\\\" class=\\\"ajf-disabled-overlay\\\"></div>\\n<div class=\\\"ajf-header\\\">\\n  <h3 translate>Properties</h3>\\n  <mat-icon (click)=\\\"save()\\\">save</mat-icon>\\n  <mat-icon (click)=\\\"cancel()\\\">cancel</mat-icon>\\n</div>\\n<ng-container *ngIf=\\\"nodeEntry|async as ne\\\">\\n  <ng-container *ngIf=\\\"propertiesForm|async as pf\\\">\\n    <form [formGroup]=\\\"pf!\\\" novalidate>\\n      <div class=\\\"ajf-prop\\\">\\n        <mat-form-field>\\n          <input matInput formControlName=\\\"name\\\" [placeholder]=\\\"'Name' | translate\\\">\\n        </mat-form-field>\\n      </div>\\n      <div class=\\\"ajf-prop\\\">\\n        <mat-form-field>\\n          <input matInput formControlName=\\\"label\\\" [placeholder]=\\\"'Label' | translate\\\">\\n        </mat-form-field>\\n      </div>\\n      <div class=\\\"ajf-prop\\\">\\n        <mat-form-field>\\n          <mat-label translate>Visibility</mat-label>\\n          <mat-select\\n              formControlName=\\\"visibilityOpt\\\" [placeholder]=\\\"'Visible' | translate\\\">\\n            <mat-option value=\\\"always\\\" translate>Always</mat-option>\\n            <mat-option value=\\\"never\\\" translate>Never</mat-option>\\n            <mat-option value=\\\"condition\\\" translate>Condition...</mat-option>\\n          </mat-select>\\n        </mat-form-field>\\n        <button (click)=\\\"editVisibility()\\\"\\n            [disabled]=\\\"pf!.value.visibilityOpt != 'condition'\\\"\\n            mat-raised-button [matTooltip]=\\\"curVisibility || ''\\\">\\n          <div class=\\\"ajf-icon-cont\\\">\\n            <mat-icon>edit</mat-icon>\\n            <span>{{ curVisibility }}</span>\\n          </div>\\n        </button>\\n      </div>\\n      <div class=\\\"ajf-prop\\\">\\n        <div><label translate>Branches</label></div>\\n        <div>\\n          <mat-slider formControlName=\\\"conditionalBranchesNum\\\"\\n              thumbLabel tickInterval=\\\"auto\\\" min=\\\"1\\\" max=\\\"5\\\" step=\\\"1\\\"></mat-slider>\\n        </div>\\n        <div *ngFor=\\\"let branch of conditionalBranches; let idx = index\\\">\\n          <button (click)=\\\"editConditionalBranch(idx)\\\" mat-raised-button [matTooltip]=\\\"branch\\\">\\n            <div class=\\\"ajf-icon-cont\\\">\\n              <mat-icon>edit</mat-icon>\\n              <span>{{ branch }}</span>\\n            </div>\\n          </button>\\n        </div>\\n      </div>\\n      <ng-template [ngIf]=\\\"isRepeatingContainerNode(ne)\\\">\\n        <div class=\\\"ajf-prop\\\">\\n          <div><label translate>Repetitions</label></div>\\n          <div>\\n            <button (click)=\\\"editFormulaReps()\\\" mat-raised-button [matTooltip]=\\\"curFormulaReps || ''\\\">\\n              <div class=\\\"ajf-icon-cont\\\">\\n                <mat-icon>edit</mat-icon>\\n                <span>{{ curFormulaReps }}</span>\\n              </div>\\n            </button>\\n          </div>\\n          <div><label translate>Min repetitions</label></div>\\n          <div>\\n            <mat-slider formControlName=\\\"minReps\\\"\\n                thumbLabel tickInterval=\\\"auto\\\" min=\\\"1\\\" max=\\\"5\\\" step=\\\"1\\\"></mat-slider>\\n          </div>\\n          <div><label translate>Max repetitions</label></div>\\n          <div>\\n            <mat-slider formControlName=\\\"maxReps\\\"\\n                thumbLabel tickInterval=\\\"auto\\\" min=\\\"1\\\" max=\\\"5\\\" step=\\\"1\\\"></mat-slider>\\n          </div>\\n        </div>\\n      </ng-template>\\n      <ng-template [ngIf]=\\\"isField(ne)\\\">\\n        <div class=\\\"ajf-prop\\\">\\n          <mat-form-field>\\n            <mat-label translate>Field size</mat-label>\\n            <mat-select formControlName=\\\"size\\\"\\n                [placeholder]=\\\"'Size' | translate\\\">\\n              <mat-option *ngFor=\\\"let fieldSize of fieldSizes\\\"\\n                [value]=\\\"fieldSize.value\\\">\\n                {{ fieldSize.label }}\\n              </mat-option>\\n            </mat-select>\\n          </mat-form-field>\\n        </div>\\n        <div class=\\\"ajf-prop\\\">\\n          <mat-form-field>\\n            <input matInput formControlName=\\\"hint\\\" [placeholder]=\\\"'Hint' | translate\\\">\\n          </mat-form-field>\\n        </div>\\n        <div class=\\\"ajf-prop\\\">\\n          <mat-form-field>\\n            <textarea matInput formControlName=\\\"description\\\"\\n                [placeholder]=\\\"'Description' | translate\\\"></textarea>\\n          </mat-form-field>\\n        </div>\\n        <div class=\\\"ajf-prop\\\">\\n          <mat-form-field>\\n            <input matInput formControlName=\\\"defaultValue\\\"\\n              [placeholder]=\\\"'Default value' | translate\\\">\\n          </mat-form-field>\\n        </div>\\n        <div class=\\\"ajf-prop\\\">\\n          <div><label translate>Formula</label></div>\\n          <div>\\n            <button (click)=\\\"editFormula()\\\" mat-raised-button [matTooltip]=\\\"curFormula || ''\\\">\\n              <div class=\\\"ajf-icon-cont\\\">\\n                <mat-icon>edit</mat-icon>\\n                <span>{{ curFormula }}</span>\\n              </div>\\n            </button>\\n          </div>\\n        </div>\\n        <!-- <div class=\\\"ajf-prop\\\">\\n          <div><label translate>Force value</label></div>\\n          <div>\\n            <button (click)=\\\"editForceValue()\\\" mat-raised-button [matTooltip]=\\\"curForceValue\\\">\\n              <div class=\\\"ajf-icon-cont\\\">\\n                <mat-icon>edit</mat-icon>\\n                <span>{{ curForceValue }}</span>\\n              </div>\\n            </button>\\n          </div>\\n        </div> -->\\n        <div class=\\\"ajf-prop\\\">\\n          <mat-checkbox formControlName=\\\"notEmpty\\\" translate>Not empty</mat-checkbox>\\n        </div>\\n        <ng-template [ngIf]=\\\"isNumericField(ne!.node)\\\">\\n          <div class=\\\"ajf-prop\\\">\\n            <mat-form-field>\\n              <input matInput formControlName=\\\"minValue\\\"\\n                [placeholder]=\\\"'Min value' | translate\\\">\\n            </mat-form-field>\\n          </div>\\n          <div class=\\\"ajf-prop\\\">\\n            <mat-form-field>\\n              <input matInput formControlName=\\\"maxValue\\\"\\n                [placeholder]=\\\"'Max value' | translate\\\">\\n            </mat-form-field>\\n          </div>\\n          <div class=\\\"ajf-prop\\\">\\n            <mat-form-field>\\n              <input matInput formControlName=\\\"minDigits\\\"\\n                [placeholder]=\\\"'Min digits' | translate\\\">\\n            </mat-form-field>\\n          </div>\\n          <div class=\\\"ajf-prop\\\">\\n            <mat-form-field>\\n              <input matInput formControlName=\\\"maxDigits\\\"\\n                [placeholder]=\\\"'Max digits' | translate\\\">\\n            </mat-form-field>\\n          </div>\\n        </ng-template>\\n        <div class=\\\"ajf-prop\\\">\\n          <div class=\\\"ajf-header\\\">\\n            <label>{{ 'Validation' | translate }}</label>\\n            <mat-icon class=\\\"ajf-pointer\\\" (click)=\\\"addValidationCondition()\\\">add_circle_outline</mat-icon>\\n          </div>\\n          <div *ngIf=\\\"validationConditions == null || validationConditions.length == 0\\\"\\n              class=\\\"ajf-validation-row ajf-emph\\\" translate>No conditions</div>\\n          <div class=\\\"ajf-validation-row\\\" *ngFor=\\\"let validationCondition of validationConditions; let idx = index\\\">\\n            <button (click)=\\\"editValidationCondition(idx)\\\"\\n                mat-raised-button [matTooltip]=\\\"validationCondition.condition\\\">\\n              <div class=\\\"ajf-icon-cont\\\">\\n                <mat-icon>edit</mat-icon>\\n                <span>{{ validationCondition.condition }}</span>\\n              </div>\\n            </button>\\n            <mat-icon class=\\\"ajf-pointer\\\" (click)=\\\"removeValidationCondition(idx)\\\">remove_circle_outline</mat-icon>\\n          </div>\\n        </div>\\n        <div class=\\\"ajf-prop\\\">\\n          <mat-checkbox formControlName=\\\"notEmptyWarning\\\" translate>Not empty warning</mat-checkbox>\\n        </div>\\n        <div class=\\\"ajf-prop\\\">\\n          <div class=\\\"ajf-header\\\">\\n            <label translate>Warnings</label>\\n            <mat-icon class=\\\"ajf-pointer\\\" (click)=\\\"addWarningCondition()\\\">add_circle_outline</mat-icon>\\n          </div>\\n          <div  *ngIf=\\\"warningConditions == null || warningConditions.length == 0\\\"\\n              class=\\\"ajf-validation-row ajf-emph\\\" translate>No warnings</div>\\n          <div class=\\\"ajf-validation-row\\\" *ngFor=\\\"let warningCondition of warningConditions; let idx = index\\\">\\n            <button (click)=\\\"editWarningCondition(idx)\\\"\\n                mat-raised-button [matTooltip]=\\\"warningCondition.condition\\\">\\n              <div class=\\\"ajf-icon-cont\\\">\\n                <mat-icon>edit</mat-icon>\\n                <span>{{ warningCondition.condition }}</span>\\n              </div>\\n            </button>\\n            <mat-icon class=\\\"ajf-pointer\\\" (click)=\\\"removeWarningCondition(idx)\\\">remove_circle_outline</mat-icon>\\n          </div>\\n        </div>\\n        <div class=\\\"ajf-prop\\\">\\n          <div><label translate>Go to next slide condition</label></div>\\n          <div>\\n            <button (click)=\\\"editNextSlideCondition()\\\" mat-raised-button [matTooltip]=\\\"nextSlideCondition\\\">\\n              <div class=\\\"ajf-icon-cont\\\">\\n                <mat-icon>edit</mat-icon>\\n                <span>{{ nextSlideCondition }}</span>\\n              </div>\\n            </button>\\n          </div>\\n        </div>\\n        <ng-template [ngIf]=\\\"isFieldWithChoices(ne!.node)\\\">\\n          <div class=\\\"ajf-prop\\\">\\n            <mat-form-field>\\n              <mat-label translate>Choices origins</mat-label>\\n              <mat-select formControlName=\\\"choicesOriginRef\\\" [placeholder]=\\\"'Choices' | translate\\\">\\n                <mat-option *ngFor=\\\"let choicesOrigin of choicesOrigins\\\" [value]=\\\"choicesOrigin.name\\\">\\n                  {{ choicesOrigin.label || choicesOrigin.name }}\\n                </mat-option>\\n              </mat-select>\\n            </mat-form-field>\\n          </div>\\n          <div class=\\\"ajf-prop\\\">\\n            <div><label translate>Choices filter</label></div>\\n            <div>\\n              <button (click)=\\\"editChoicesFilter()\\\" mat-raised-button [matTooltip]=\\\"curChoicesFilter\\\">\\n                <div class=\\\"ajf-icon-cont\\\">\\n                  <mat-icon>edit</mat-icon>\\n                  <span>{{ curChoicesFilter }}</span>\\n                </div>\\n              </button>\\n            </div>\\n          </div>\\n          <div class=\\\"ajf-prop\\\">\\n            <mat-checkbox formControlName=\\\"forceExpanded\\\" translate>Force expanded selection</mat-checkbox>\\n          </div>\\n          <div class=\\\"ajf-prop\\\">\\n            <mat-checkbox formControlName=\\\"forceNarrow\\\" translate>Force narrow selection</mat-checkbox>\\n          </div>\\n          <div class=\\\"ajf-prop\\\">\\n            <div class=\\\"ajf-header\\\">\\n              <label translate>Trigger selection</label>\\n              <mat-icon class=\\\"ajf-pointer\\\" (click)=\\\"addTriggerCondition()\\\">add_circle_outline</mat-icon>\\n            </div>\\n            <div *ngIf=\\\"triggerConditions == null || triggerConditions.length == 0\\\"\\n                class=\\\"ajf-validation-row ajf-emph\\\" translate>No trigger condition </div>\\n            <div class=\\\"ajf-validation-row\\\" *ngFor=\\\"let triggerCondition of triggerConditions; let idx = index\\\">\\n              <button (click)=\\\"editTriggerCondition(idx)\\\"\\n                  mat-raised-button [matTooltip]=\\\"triggerCondition\\\">\\n                <div class=\\\"ajf-icon-cont\\\">\\n                  <mat-icon>edit</mat-icon>\\n                  <span>{{ triggerCondition }}</span>\\n                </div>\\n              </button>\\n              <mat-icon class=\\\"pointer\\\" (click)=\\\"removeTriggerCondition(idx)\\\">remove_circle_outline</mat-icon>\\n            </div>\\n          </div>\\n        </ng-template>\\n      </ng-template>\\n    </form>\\n  </ng-container>\\n</ng-container>\\n\",\n                    encapsulation: core.ViewEncapsulation.None,\n                    changeDetection: core.ChangeDetectionStrategy.OnPush,\n                    styles: [\"ajf-fb-node-properties{display:block;padding:1em;position:relative}ajf-fb-node-properties mat-icon{cursor:pointer}ajf-fb-node-properties .ajf-header{display:flex;flex-direction:row;align-items:center;flex-wrap:nowrap}ajf-fb-node-properties .ajf-header>h3,ajf-fb-node-properties .ajf-header>label{flex:1 0 auto;margin-right:.5em}ajf-fb-node-properties .ajf-header>mat-icon{flex:0 0 auto;margin-left:.5em}ajf-fb-node-properties .ajf-disabled-overlay{position:absolute;top:0;right:0;bottom:0;left:0;opacity:.4;background-color:#fff}ajf-fb-node-properties .ajf-emph{font-style:italic}ajf-fb-node-properties [mat-raised-button]{margin:.5em 0}ajf-fb-node-properties [mat-raised-button].ajf-pointer{cursor:pointer}ajf-fb-node-properties [mat-raised-button] .ajf-icon-cont{display:flex;flex-direction:row;align-items:center}ajf-fb-node-properties [mat-raised-button] .ajf-icon-cont span{flex:1 1 auto;overflow:hidden;text-overflow:ellipsis;display:block;min-height:36px}ajf-fb-node-properties .ajf-validation-row{margin:.5em 0;display:flex;flex-direction:row;align-items:center}ajf-fb-node-properties .ajf-validation-row button{flex:1 1 auto}ajf-fb-node-properties .ajf-validation-row mat-icon{flex:0 0 auto}ajf-fb-node-properties .ajf-prop{margin:.5em 0}ajf-fb-node-properties mat-form-field,ajf-fb-node-properties mat-slider,ajf-fb-node-properties [mat-raised-button]{width:100%}\\n\"]\n                },] }\n    ];\n    AjfFbNodeProperties.ctorParameters = function () { return [\n        { type: core.ChangeDetectorRef },\n        { type: AjfFormBuilderService },\n        { type: dialog.MatDialog },\n        { type: forms.FormBuilder }\n    ]; };\n\n    /**\n     * @license\n     * Copyright (C) Gnucoop soc. coop.\n     *\n     * This file is part of the Advanced JSON forms (ajf).\n     *\n     * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n     * modify it under the terms of the GNU Affero General Public License as\n     * published by the Free Software Foundation, either version 3 of the License,\n     * or (at your option) any later version.\n     *\n     * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n     * but WITHOUT ANY WARRANTY; without even the implied warranty of\n     * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n     * General Public License for more details.\n     *\n     * You should have received a copy of the GNU Affero General Public License\n     * along with Advanced JSON forms (ajf).\n     * If not, see http://www.gnu.org/licenses/.\n     *\n     */\n    var AjfFbNodeTypeEntry = /** @class */ (function () {\n        function AjfFbNodeTypeEntry(_cdr) {\n            this._cdr = _cdr;\n        }\n        Object.defineProperty(AjfFbNodeTypeEntry.prototype, \"nodeType\", {\n            get: function () {\n                return this._nodeType;\n            },\n            set: function (nodeType) {\n                this._nodeType = nodeType;\n                this._cdr.markForCheck();\n            },\n            enumerable: false,\n            configurable: true\n        });\n        return AjfFbNodeTypeEntry;\n    }());\n    AjfFbNodeTypeEntry.decorators = [\n        { type: core.Component, args: [{\n                    selector: 'ajf-fb-node-type-entry',\n                    template: \"<ng-container *ngIf=\\\"nodeType\\\">\\n  <mat-icon\\n    [fontSet]=\\\"nodeType.icon.fontSet\\\" [fontIcon]=\\\"nodeType.icon.fontIcon\\\"></mat-icon>\\n  {{ nodeType.label }}\\n</ng-container>\\n\",\n                    encapsulation: core.ViewEncapsulation.None,\n                    changeDetection: core.ChangeDetectionStrategy.OnPush,\n                    styles: [\"ajf-fb-node-type-entry{display:block;padding:1em 1.5em}ajf-fb-node-type-entry mat-icon{vertical-align:middle}\\n\"]\n                },] }\n    ];\n    AjfFbNodeTypeEntry.ctorParameters = function () { return [\n        { type: core.ChangeDetectorRef }\n    ]; };\n    AjfFbNodeTypeEntry.propDecorators = {\n        nodeType: [{ type: core.Input }]\n    };\n\n    /**\n     * @license\n     * Copyright (C) Gnucoop soc. coop.\n     *\n     * This file is part of the Advanced JSON forms (ajf).\n     *\n     * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n     * modify it under the terms of the GNU Affero General Public License as\n     * published by the Free Software Foundation, either version 3 of the License,\n     * or (at your option) any later version.\n     *\n     * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n     * but WITHOUT ANY WARRANTY; without even the implied warranty of\n     * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n     * General Public License for more details.\n     *\n     * You should have received a copy of the GNU Affero General Public License\n     * along with Advanced JSON forms (ajf).\n     * If not, see http://www.gnu.org/licenses/.\n     *\n     */\n    var AjfFormBuilderModule = /** @class */ (function () {\n        function AjfFormBuilderModule() {\n        }\n        return AjfFormBuilderModule;\n    }());\n    AjfFormBuilderModule.decorators = [\n        { type: core.NgModule, args: [{\n                    imports: [\n                        monacoEditor.AjfMonacoEditorModule, nodeIcon.AjfNodeIconModule, common.CommonModule, dragDrop.DragDropModule,\n                        forms.FormsModule, autocomplete.MatAutocompleteModule, button.MatButtonModule, card.MatCardModule,\n                        checkbox.MatCheckboxModule, chips.MatChipsModule, dialog.MatDialogModule, formField.MatFormFieldModule,\n                        icon.MatIconModule, input.MatInputModule, list.MatListModule, menu.MatMenuModule,\n                        select.MatSelectModule, sidenav.MatSidenavModule, slider.MatSliderModule, table.MatTableModule,\n                        toolbar.MatToolbarModule, tooltip.MatTooltipModule, forms.ReactiveFormsModule, core$1.TranslateModule,\n                        expansion.MatExpansionModule, slideToggle.MatSlideToggleModule,\n                    ],\n                    declarations: [\n                        AjfFbBranchLine,\n                        AjfFbChoicesOriginEditor,\n                        AjfFbChoicesOriginEditorDialog,\n                        AjfFbConditionEditor,\n                        AjfFbConditionEditorDialog,\n                        AjfFbNodeEntry,\n                        AjfFbNodeProperties,\n                        AjfFbNodeTypeEntry,\n                        AjfFbStringIdentifierDialogComponent,\n                        AjfFbValidationConditionEditorDialog,\n                        AjfFbWarningConditionEditorDialog,\n                        AjfFormBuilder,\n                    ],\n                    exports: [\n                        AjfFormBuilder,\n                    ],\n                    providers: [\n                        AjfFormBuilderService,\n                    ],\n                },] }\n    ];\n\n    /**\n     * @license\n     * Copyright (C) Gnucoop soc. coop.\n     *\n     * This file is part of the Advanced JSON forms (ajf).\n     *\n     * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n     * modify it under the terms of the GNU Affero General Public License as\n     * published by the Free Software Foundation, either version 3 of the License,\n     * or (at your option) any later version.\n     *\n     * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n     * but WITHOUT ANY WARRANTY; without even the implied warranty of\n     * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n     * General Public License for more details.\n     *\n     * You should have received a copy of the GNU Affero General Public License\n     * along with Advanced JSON forms (ajf).\n     * If not, see http://www.gnu.org/licenses/.\n     *\n     */\n\n    /**\n     * Generated bundle index. Do not edit.\n     */\n\n    exports.AjfFormBuilder = AjfFormBuilder;\n    exports.AjfFormBuilderModule = AjfFormBuilderModule;\n    exports.AjfFormBuilderService = AjfFormBuilderService;\n    exports.disableFieldDropPredicate = disableFieldDropPredicate;\n    exports.disableSlideDropPredicate = disableSlideDropPredicate;\n    exports.flattenNodes = flattenNodes;\n    exports.onDropProcess = onDropProcess;\n    exports.ɵgc_ajf_src_material_form_builder_form_builder_a = AjfFbBranchLine;\n    exports.ɵgc_ajf_src_material_form_builder_form_builder_b = AjfFbChoicesOriginEditor;\n    exports.ɵgc_ajf_src_material_form_builder_form_builder_c = AjfFbChoicesOriginEditorDialog;\n    exports.ɵgc_ajf_src_material_form_builder_form_builder_d = AjfFbConditionEditor;\n    exports.ɵgc_ajf_src_material_form_builder_form_builder_e = AjfFbConditionEditorDialog;\n    exports.ɵgc_ajf_src_material_form_builder_form_builder_f = AjfFbNodeEntry;\n    exports.ɵgc_ajf_src_material_form_builder_form_builder_g = AjfFbNodeProperties;\n    exports.ɵgc_ajf_src_material_form_builder_form_builder_h = AjfFbNodeTypeEntry;\n    exports.ɵgc_ajf_src_material_form_builder_form_builder_i = AjfFbStringIdentifierDialogComponent;\n    exports.ɵgc_ajf_src_material_form_builder_form_builder_j = AjfFbValidationConditionEditorDialog;\n    exports.ɵgc_ajf_src_material_form_builder_form_builder_k = AjfFbWarningConditionEditorDialog;\n\n    Object.defineProperty(exports, '__esModule', { value: true });\n\n})));\n//# sourceMappingURL=material-form-builder.umd.js.map\n"]}